var ki=Object.defineProperty;var Ti=(A,t,e)=>t in A?ki(A,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):A[t]=e;var c=(A,t,e)=>(Ti(A,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();class yi{constructor(){c(this,"entries",{});c(this,"size",0)}add(t){let e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){let e=this.size;for(var i=0,s=t.length;i<s;i++)this.add(t[i]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const Yt=class Yt{constructor(t=0,e=0,i=0,s=0){c(this,"r");c(this,"g");c(this,"b");c(this,"a");this.r=t,this.g=e,this.b=i,this.a=s}set(t,e,i,s){return this.r=t,this.g=e,this.b=i,this.a=s,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t=t.charAt(0)=="#"?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=t.length!=8?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,i,s){return this.r+=t,this.g+=e,this.b+=i,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((e&4278190080)>>>24)/255,t.g=((e&16711680)>>>16)/255,t.b=((e&65280)>>>8)/255,t.a=(e&255)/255}static rgb888ToColor(t,e){t.r=((e&16711680)>>>16)/255,t.g=((e&65280)>>>8)/255,t.b=(e&255)/255}static fromString(t){return new Yt().setFromString(t)}};c(Yt,"WHITE",new Yt(1,1,1,1)),c(Yt,"RED",new Yt(1,0,0,1)),c(Yt,"GREEN",new Yt(0,1,0,1)),c(Yt,"BLUE",new Yt(0,0,1,1)),c(Yt,"MAGENTA",new Yt(1,0,1,1));let st=Yt;const xt=class xt{static clamp(t,e,i){return t<e?e:t>i?i:t}static cosDeg(t){return Math.cos(t*xt.degRad)}static sinDeg(t){return Math.sin(t*xt.degRad)}static atan2Deg(t,e){return Math.atan2(t,e)*xt.degRad}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),.3333333333333333);return t<0?-e:e}static randomTriangular(t,e){return xt.randomTriangularWith(t,e,(t+e)*.5)}static randomTriangularWith(t,e,i){let s=Math.random(),a=e-t;return s<=(i-t)/a?t+Math.sqrt(s*a*(i-t)):e-Math.sqrt((1-s)*a*(e-i))}static isPowerOfTwo(t){return t&&(t&t-1)===0}};c(xt,"PI",3.1415927),c(xt,"PI2",xt.PI*2),c(xt,"invPI2",1/xt.PI2),c(xt,"radiansToDegrees",180/xt.PI),c(xt,"radDeg",xt.radiansToDegrees),c(xt,"degreesToRadians",xt.PI/180),c(xt,"degRad",xt.degreesToRadians);let P=xt;const Ut=class Ut{static arrayCopy(t,e,i,s,a){for(let l=e,n=s;l<e+a;l++,n++)i[n]=t[l]}static arrayFill(t,e,i,s){for(let a=e;a<i;a++)t[a]=s}static setArraySize(t,e,i=0){let s=t.length;if(s==e)return t;if(t.length=e,s<e)for(let a=s;a<e;a++)t[a]=i;return t}static ensureArrayCapacity(t,e,i=0){return t.length>=e?t:Ut.setArraySize(t,e,i)}static newArray(t,e){let i=new Array(t);for(let s=0;s<t;s++)i[s]=e;return i}static newFloatArray(t){if(Ut.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let i=0;i<e.length;i++)e[i]=0;return e}}static newShortArray(t){if(Ut.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let i=0;i<e.length;i++)e[i]=0;return e}}static toFloatArray(t){return Ut.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return Ut.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,i=!0){for(var s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};c(Ut,"SUPPORTS_TYPED_ARRAYS",typeof Float32Array<"u");let O=Ut;class Ee{constructor(t){c(this,"items",new Array);c(this,"instantiator");this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class oe{constructor(t=0,e=0){c(this,"x");c(this,"y");this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class Yi{constructor(){c(this,"maxDelta",.064);c(this,"framesPerSecond",0);c(this,"delta",0);c(this,"totalTime",0);c(this,"lastTime",Date.now()/1e3);c(this,"frameCount",0);c(this,"frameTime",0)}update(){let t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}class Ai{constructor(t){c(this,"name");if(!t)throw new Error("name cannot be null.");this.name=t}}const Ye=class Ye extends Ai{constructor(e){super(e);c(this,"id",Ye.nextID++);c(this,"bones",null);c(this,"vertices",[]);c(this,"worldVerticesLength",0);c(this,"timelineAttachment",this)}computeWorldVertices(e,i,s,a,l,n){s=l+(s>>1)*n;let h=e.bone.skeleton,r=e.deform,o=this.vertices,d=this.bones;if(!d){r.length>0&&(o=r);let g=e.bone,x=g.worldX,p=g.worldY,y=g.a,w=g.b,b=g.c,C=g.d;for(let v=i,E=l;E<s;v+=2,E+=n){let M=o[v],T=o[v+1];a[E]=M*y+T*w+x,a[E+1]=M*b+T*C+p}return}let u=0,f=0;for(let g=0;g<i;g+=2){let x=d[u];u+=x+1,f+=x}let m=h.bones;if(r.length==0)for(let g=l,x=f*3;g<s;g+=n){let p=0,y=0,w=d[u++];for(w+=u;u<w;u++,x+=3){let b=m[d[u]],C=o[x],v=o[x+1],E=o[x+2];p+=(C*b.a+v*b.b+b.worldX)*E,y+=(C*b.c+v*b.d+b.worldY)*E}a[g]=p,a[g+1]=y}else{let g=r;for(let x=l,p=f*3,y=f<<1;x<s;x+=n){let w=0,b=0,C=d[u++];for(C+=u;u<C;u++,p+=3,y+=2){let v=m[d[u]],E=o[p]+g[y],M=o[p+1]+g[y+1],T=o[p+2];w+=(E*v.a+M*v.b+v.worldX)*T,b+=(E*v.c+M*v.d+v.worldY)*T}a[x]=w,a[x+1]=b}}}copyTo(e){this.bones?(e.bones=new Array(this.bones.length),O.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=O.newFloatArray(this.vertices.length),O.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment}};c(Ye,"nextID",0);let Ot=Ye;const se=class se{constructor(t){c(this,"id",se.nextID());c(this,"regions");c(this,"start",0);c(this,"digits",0);c(this,"setupIndex",0);this.regions=new Array(t)}copy(){let t=new se(this.regions.length);return O.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let i=t.sequenceIndex;i==-1&&(i=this.setupIndex),i>=this.regions.length&&(i=this.regions.length-1);let s=this.regions[i];e.region!=s&&(e.region=s,e.updateRegion())}getPath(t,e){let i=t,s=(this.start+e).toString();for(let a=this.digits-s.length;a>0;a--)i+="0";return i+=s,i}static nextID(){return se._nextID++}};c(se,"_nextID",0);let ze=se;var wt;(function(A){A[A.hold=0]="hold",A[A.once=1]="once",A[A.loop=2]="loop",A[A.pingpong=3]="pingpong",A[A.onceReverse=4]="onceReverse",A[A.loopReverse=5]="loopReverse",A[A.pingpongReverse=6]="pingpongReverse"})(wt||(wt={}));const Ii=[wt.hold,wt.once,wt.loop,wt.pingpong,wt.onceReverse,wt.loopReverse,wt.pingpongReverse];class Ci{constructor(t,e,i){c(this,"name");c(this,"timelines",[]);c(this,"timelineIds",new yi);c(this,"duration");if(!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=i}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,i,s,a,l,n,h){if(!t)throw new Error("skeleton cannot be null.");s&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));let r=this.timelines;for(let o=0,d=r.length;o<d;o++)r[o].apply(t,e,i,a,l,n,h)}}var L;(function(A){A[A.setup=0]="setup",A[A.first=1]="first",A[A.replace=2]="replace",A[A.add=3]="add"})(L||(L={}));var Tt;(function(A){A[A.mixIn=0]="mixIn",A[A.mixOut=1]="mixOut"})(Tt||(Tt={}));const nt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class gt{constructor(t,e){c(this,"propertyIds");c(this,"frames");this.propertyIds=e,this.frames=O.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let i=t.length;for(let s=1;s<i;s++)if(t[s]>e)return s-1;return i-1}static search(t,e,i){let s=t.length;for(let a=i;a<s;a+=i)if(t[a]>e)return a-i;return s-i}}class Nt extends gt{constructor(e,i,s){super(e,s);c(this,"curves");this.curves=O.newFloatArray(e+i*18),this.curves[e-1]=1}setLinear(e){this.curves[e]=0}setStepped(e){this.curves[e]=1}shrink(e){let i=this.getFrameCount()+e*18;if(this.curves.length>i){let s=O.newFloatArray(i);O.arrayCopy(this.curves,0,s,0,i),this.curves=s}}setBezier(e,i,s,a,l,n,h,r,o,d,u){let f=this.curves,m=this.getFrameCount()+e*18;s==0&&(f[i]=2+m);let g=(a-n*2+r)*.03,x=(l-h*2+o)*.03,p=((n-r)*3-a+d)*.006,y=((h-o)*3-l+u)*.006,w=g*2+p,b=x*2+y,C=(n-a)*.3+g+p*.16666667,v=(h-l)*.3+x+y*.16666667,E=a+C,M=l+v;for(let T=m+18;m<T;m+=2)f[m]=E,f[m+1]=M,C+=w,v+=b,w+=p,b+=y,E+=C,M+=v}getBezierValue(e,i,s,a){let l=this.curves;if(l[a]>e){let o=this.frames[i],d=this.frames[i+s];return d+(e-o)/(l[a]-o)*(l[a+1]-d)}let n=a+18;for(a+=2;a<n;a+=2)if(l[a]>=e){let o=l[a-2],d=l[a-1];return d+(e-o)/(l[a]-o)*(l[a+1]-d)}i+=this.getFrameEntries();let h=l[n-2],r=l[n-1];return r+(e-h)/(this.frames[i]-h)*(this.frames[i+s]-r)}}class Bt extends Nt{constructor(t,e,i){super(t,e,[i])}getFrameEntries(){return 2}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+1]=i}getCurveValue(t){let e=this.frames,i=e.length-2;for(let a=2;a<=i;a+=2)if(e[a]>t){i=a-2;break}let s=this.curves[i>>1];switch(s){case 0:let a=e[i],l=e[i+1];return l+(t-a)/(e[i+2]-a)*(e[i+2+1]-l);case 1:return e[i+1]}return this.getBezierValue(t,i,1,s-2)}getRelativeValue(t,e,i,s,a){if(t<this.frames[0]){switch(i){case L.setup:return a;case L.first:return s+(a-s)*e}return s}let l=this.getCurveValue(t);switch(i){case L.setup:return a+l*e;case L.first:case L.replace:l+=a-s}return s+l*e}getAbsoluteValue(t,e,i,s,a){if(t<this.frames[0]){switch(i){case L.setup:return a;case L.first:return s+(a-s)*e}return s}let l=this.getCurveValue(t);return i==L.setup?a+(l-a)*e:s+(l-s)*e}getAbsoluteValue2(t,e,i,s,a,l){if(t<this.frames[0]){switch(i){case L.setup:return a;case L.first:return s+(a-s)*e}return s}return i==L.setup?a+(l-a)*e:s+(l-s)*e}getScaleValue(t,e,i,s,a,l){const n=this.frames;if(t<n[0]){switch(i){case L.setup:return l;case L.first:return a+(l-a)*e}return a}let h=this.getCurveValue(t)*l;if(e==1)return i==L.add?a+h-l:h;if(s==Tt.mixOut)switch(i){case L.setup:return l+(Math.abs(h)*P.signum(l)-l)*e;case L.first:case L.replace:return a+(Math.abs(h)*P.signum(a)-a)*e}else{let r=0;switch(i){case L.setup:return r=Math.abs(l)*P.signum(h),r+(h-r)*e;case L.first:case L.replace:return r=Math.abs(a)*P.signum(h),r+(h-r)*e}}return a+(h-l)*e}}class ei extends Nt{constructor(t,e,i,s){super(t,e,[i,s])}getFrameEntries(){return 3}setFrame(t,e,i,s){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s}}class qe extends Bt{constructor(e,i,s){super(e,i,nt.rotate+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.rotation=this.getRelativeValue(s,l,n,r.rotation,r.data.rotation))}}class Li extends ei{constructor(e,i,s){super(e,i,nt.x+"|"+s,nt.y+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){switch(n){case L.setup:r.x=r.data.x,r.y=r.data.y;return;case L.first:r.x+=(r.data.x-r.x)*l,r.y+=(r.data.y-r.y)*l}return}let d=0,u=0,f=gt.search(o,s,3),m=this.curves[f/3];switch(m){case 0:let g=o[f];d=o[f+1],u=o[f+2];let x=(s-g)/(o[f+3]-g);d+=(o[f+3+1]-d)*x,u+=(o[f+3+2]-u)*x;break;case 1:d=o[f+1],u=o[f+2];break;default:d=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}switch(n){case L.setup:r.x=r.data.x+d*l,r.y=r.data.y+u*l;break;case L.first:case L.replace:r.x+=(r.data.x+d-r.x)*l,r.y+=(r.data.y+u-r.y)*l;break;case L.add:r.x+=d*l,r.y+=u*l}}}class Ri extends Bt{constructor(e,i,s){super(e,i,nt.x+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.x=this.getRelativeValue(s,l,n,r.x,r.data.x))}}class Xi extends Bt{constructor(e,i,s){super(e,i,nt.y+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.y=this.getRelativeValue(s,l,n,r.y,r.data.y))}}class Pi extends ei{constructor(e,i,s){super(e,i,nt.scaleX+"|"+s,nt.scaleY+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){switch(n){case L.setup:r.scaleX=r.data.scaleX,r.scaleY=r.data.scaleY;return;case L.first:r.scaleX+=(r.data.scaleX-r.scaleX)*l,r.scaleY+=(r.data.scaleY-r.scaleY)*l}return}let d,u,f=gt.search(o,s,3),m=this.curves[f/3];switch(m){case 0:let g=o[f];d=o[f+1],u=o[f+2];let x=(s-g)/(o[f+3]-g);d+=(o[f+3+1]-d)*x,u+=(o[f+3+2]-u)*x;break;case 1:d=o[f+1],u=o[f+2];break;default:d=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}if(d*=r.data.scaleX,u*=r.data.scaleY,l==1)n==L.add?(r.scaleX+=d-r.data.scaleX,r.scaleY+=u-r.data.scaleY):(r.scaleX=d,r.scaleY=u);else{let g=0,x=0;if(h==Tt.mixOut)switch(n){case L.setup:g=r.data.scaleX,x=r.data.scaleY,r.scaleX=g+(Math.abs(d)*P.signum(g)-g)*l,r.scaleY=x+(Math.abs(u)*P.signum(x)-x)*l;break;case L.first:case L.replace:g=r.scaleX,x=r.scaleY,r.scaleX=g+(Math.abs(d)*P.signum(g)-g)*l,r.scaleY=x+(Math.abs(u)*P.signum(x)-x)*l;break;case L.add:r.scaleX+=(d-r.data.scaleX)*l,r.scaleY+=(u-r.data.scaleY)*l}else switch(n){case L.setup:g=Math.abs(r.data.scaleX)*P.signum(d),x=Math.abs(r.data.scaleY)*P.signum(u),r.scaleX=g+(d-g)*l,r.scaleY=x+(u-x)*l;break;case L.first:case L.replace:g=Math.abs(r.scaleX)*P.signum(d),x=Math.abs(r.scaleY)*P.signum(u),r.scaleX=g+(d-g)*l,r.scaleY=x+(u-x)*l;break;case L.add:r.scaleX+=(d-r.data.scaleX)*l,r.scaleY+=(u-r.data.scaleY)*l}}}}class Fi extends Bt{constructor(e,i,s){super(e,i,nt.scaleX+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.scaleX=this.getScaleValue(s,l,n,h,r.scaleX,r.data.scaleX))}}class Vi extends Bt{constructor(e,i,s){super(e,i,nt.scaleY+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.scaleY=this.getScaleValue(s,l,n,h,r.scaleY,r.data.scaleY))}}class Di extends ei{constructor(e,i,s){super(e,i,nt.shearX+"|"+s,nt.shearY+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){switch(n){case L.setup:r.shearX=r.data.shearX,r.shearY=r.data.shearY;return;case L.first:r.shearX+=(r.data.shearX-r.shearX)*l,r.shearY+=(r.data.shearY-r.shearY)*l}return}let d=0,u=0,f=gt.search(o,s,3),m=this.curves[f/3];switch(m){case 0:let g=o[f];d=o[f+1],u=o[f+2];let x=(s-g)/(o[f+3]-g);d+=(o[f+3+1]-d)*x,u+=(o[f+3+2]-u)*x;break;case 1:d=o[f+1],u=o[f+2];break;default:d=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}switch(n){case L.setup:r.shearX=r.data.shearX+d*l,r.shearY=r.data.shearY+u*l;break;case L.first:case L.replace:r.shearX+=(r.data.shearX+d-r.shearX)*l,r.shearY+=(r.data.shearY+u-r.shearY)*l;break;case L.add:r.shearX+=d*l,r.shearY+=u*l}}}class Oi extends Bt{constructor(e,i,s){super(e,i,nt.shearX+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.shearX=this.getRelativeValue(s,l,n,r.shearX,r.data.shearX))}}class Bi extends Bt{constructor(e,i,s){super(e,i,nt.shearY+"|"+s);c(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];r.active&&(r.shearY=this.getRelativeValue(s,l,n,r.shearY,r.data.shearY))}}class _i extends gt{constructor(e,i){super(e,[nt.inherit+"|"+i]);c(this,"boneIndex",0);this.boneIndex=i}getFrameEntries(){return 2}setFrame(e,i,s){e*=2,this.frames[e]=i,this.frames[e+1]=s}apply(e,i,s,a,l,n,h){let r=e.bones[this.boneIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){(n==L.setup||n==L.first)&&(r.inherit=r.data.inherit);return}r.inherit=this.frames[gt.search(o,s,2)+1]}}class $i extends Nt{constructor(e,i,s){super(e,i,[nt.rgb+"|"+s,nt.alpha+"|"+s]);c(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 5}setFrame(e,i,s,a,l,n){e*=5,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=a,this.frames[e+3]=l,this.frames[e+4]=n}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=this.frames,d=r.color;if(s<o[0]){let y=r.data.color;switch(n){case L.setup:d.setFromColor(y);return;case L.first:d.add((y.r-d.r)*l,(y.g-d.g)*l,(y.b-d.b)*l,(y.a-d.a)*l)}return}let u=0,f=0,m=0,g=0,x=gt.search(o,s,5),p=this.curves[x/5];switch(p){case 0:let y=o[x];u=o[x+1],f=o[x+2],m=o[x+3],g=o[x+4];let w=(s-y)/(o[x+5]-y);u+=(o[x+5+1]-u)*w,f+=(o[x+5+2]-f)*w,m+=(o[x+5+3]-m)*w,g+=(o[x+5+4]-g)*w;break;case 1:u=o[x+1],f=o[x+2],m=o[x+3],g=o[x+4];break;default:u=this.getBezierValue(s,x,1,p-2),f=this.getBezierValue(s,x,2,p+18-2),m=this.getBezierValue(s,x,3,p+18*2-2),g=this.getBezierValue(s,x,4,p+18*3-2)}l==1?d.set(u,f,m,g):(n==L.setup&&d.setFromColor(r.data.color),d.add((u-d.r)*l,(f-d.g)*l,(m-d.b)*l,(g-d.a)*l))}}class Ni extends Nt{constructor(e,i,s){super(e,i,[nt.rgb+"|"+s]);c(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 4}setFrame(e,i,s,a,l){e<<=2,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=a,this.frames[e+3]=l}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=this.frames,d=r.color;if(s<o[0]){let p=r.data.color;switch(n){case L.setup:d.r=p.r,d.g=p.g,d.b=p.b;return;case L.first:d.r+=(p.r-d.r)*l,d.g+=(p.g-d.g)*l,d.b+=(p.b-d.b)*l}return}let u=0,f=0,m=0,g=gt.search(o,s,4),x=this.curves[g>>2];switch(x){case 0:let p=o[g];u=o[g+1],f=o[g+2],m=o[g+3];let y=(s-p)/(o[g+4]-p);u+=(o[g+4+1]-u)*y,f+=(o[g+4+2]-f)*y,m+=(o[g+4+3]-m)*y;break;case 1:u=o[g+1],f=o[g+2],m=o[g+3];break;default:u=this.getBezierValue(s,g,1,x-2),f=this.getBezierValue(s,g,2,x+18-2),m=this.getBezierValue(s,g,3,x+18*2-2)}if(l==1)d.r=u,d.g=f,d.b=m;else{if(n==L.setup){let p=r.data.color;d.r=p.r,d.g=p.g,d.b=p.b}d.r+=(u-d.r)*l,d.g+=(f-d.g)*l,d.b+=(m-d.b)*l}}}class Wi extends Bt{constructor(e,i,s){super(e,i,nt.alpha+"|"+s);c(this,"slotIndex",0);this.slotIndex=s}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=r.color;if(s<this.frames[0]){let u=r.data.color;switch(n){case L.setup:o.a=u.a;return;case L.first:o.a+=(u.a-o.a)*l}return}let d=this.getCurveValue(s);l==1?o.a=d:(n==L.setup&&(o.a=r.data.color.a),o.a+=(d-o.a)*l)}}class zi extends Nt{constructor(e,i,s){super(e,i,[nt.rgb+"|"+s,nt.alpha+"|"+s,nt.rgb2+"|"+s]);c(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 8}setFrame(e,i,s,a,l,n,h,r,o){e<<=3,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=a,this.frames[e+3]=l,this.frames[e+4]=n,this.frames[e+5]=h,this.frames[e+6]=r,this.frames[e+7]=o}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=this.frames,d=r.color,u=r.darkColor;if(s<o[0]){let v=r.data.color,E=r.data.darkColor;switch(n){case L.setup:d.setFromColor(v),u.r=E.r,u.g=E.g,u.b=E.b;return;case L.first:d.add((v.r-d.r)*l,(v.g-d.g)*l,(v.b-d.b)*l,(v.a-d.a)*l),u.r+=(E.r-u.r)*l,u.g+=(E.g-u.g)*l,u.b+=(E.b-u.b)*l}return}let f=0,m=0,g=0,x=0,p=0,y=0,w=0,b=gt.search(o,s,8),C=this.curves[b>>3];switch(C){case 0:let v=o[b];f=o[b+1],m=o[b+2],g=o[b+3],x=o[b+4],p=o[b+5],y=o[b+6],w=o[b+7];let E=(s-v)/(o[b+8]-v);f+=(o[b+8+1]-f)*E,m+=(o[b+8+2]-m)*E,g+=(o[b+8+3]-g)*E,x+=(o[b+8+4]-x)*E,p+=(o[b+8+5]-p)*E,y+=(o[b+8+6]-y)*E,w+=(o[b+8+7]-w)*E;break;case 1:f=o[b+1],m=o[b+2],g=o[b+3],x=o[b+4],p=o[b+5],y=o[b+6],w=o[b+7];break;default:f=this.getBezierValue(s,b,1,C-2),m=this.getBezierValue(s,b,2,C+18-2),g=this.getBezierValue(s,b,3,C+18*2-2),x=this.getBezierValue(s,b,4,C+18*3-2),p=this.getBezierValue(s,b,5,C+18*4-2),y=this.getBezierValue(s,b,6,C+18*5-2),w=this.getBezierValue(s,b,7,C+18*6-2)}if(l==1)d.set(f,m,g,x),u.r=p,u.g=y,u.b=w;else{if(n==L.setup){d.setFromColor(r.data.color);let v=r.data.darkColor;u.r=v.r,u.g=v.g,u.b=v.b}d.add((f-d.r)*l,(m-d.g)*l,(g-d.b)*l,(x-d.a)*l),u.r+=(p-u.r)*l,u.g+=(y-u.g)*l,u.b+=(w-u.b)*l}}}class qi extends Nt{constructor(e,i,s){super(e,i,[nt.rgb+"|"+s,nt.rgb2+"|"+s]);c(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 7}setFrame(e,i,s,a,l,n,h,r){e*=7,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=a,this.frames[e+3]=l,this.frames[e+4]=n,this.frames[e+5]=h,this.frames[e+6]=r}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=this.frames,d=r.color,u=r.darkColor;if(s<o[0]){let C=r.data.color,v=r.data.darkColor;switch(n){case L.setup:d.r=C.r,d.g=C.g,d.b=C.b,u.r=v.r,u.g=v.g,u.b=v.b;return;case L.first:d.r+=(C.r-d.r)*l,d.g+=(C.g-d.g)*l,d.b+=(C.b-d.b)*l,u.r+=(v.r-u.r)*l,u.g+=(v.g-u.g)*l,u.b+=(v.b-u.b)*l}return}let f=0,m=0,g=0,x=0,p=0,y=0,w=gt.search(o,s,7),b=this.curves[w/7];switch(b){case 0:let C=o[w];f=o[w+1],m=o[w+2],g=o[w+3],x=o[w+4],p=o[w+5],y=o[w+6];let v=(s-C)/(o[w+7]-C);f+=(o[w+7+1]-f)*v,m+=(o[w+7+2]-m)*v,g+=(o[w+7+3]-g)*v,x+=(o[w+7+4]-x)*v,p+=(o[w+7+5]-p)*v,y+=(o[w+7+6]-y)*v;break;case 1:f=o[w+1],m=o[w+2],g=o[w+3],x=o[w+4],p=o[w+5],y=o[w+6];break;default:f=this.getBezierValue(s,w,1,b-2),m=this.getBezierValue(s,w,2,b+18-2),g=this.getBezierValue(s,w,3,b+18*2-2),x=this.getBezierValue(s,w,4,b+18*3-2),p=this.getBezierValue(s,w,5,b+18*4-2),y=this.getBezierValue(s,w,6,b+18*5-2)}if(l==1)d.r=f,d.g=m,d.b=g,u.r=x,u.g=p,u.b=y;else{if(n==L.setup){let C=r.data.color,v=r.data.darkColor;d.r=C.r,d.g=C.g,d.b=C.b,u.r=v.r,u.g=v.g,u.b=v.b}d.r+=(f-d.r)*l,d.g+=(m-d.g)*l,d.b+=(g-d.b)*l,u.r+=(x-u.r)*l,u.g+=(p-u.g)*l,u.b+=(y-u.b)*l}}}class fe extends gt{constructor(e,i){super(e,[nt.attachment+"|"+i]);c(this,"slotIndex",0);c(this,"attachmentNames");this.slotIndex=i,this.attachmentNames=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.attachmentNames[e]=s}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(r.bone.active){if(h==Tt.mixOut){n==L.setup&&this.setAttachment(e,r,r.data.attachmentName);return}if(s<this.frames[0]){(n==L.setup||n==L.first)&&this.setAttachment(e,r,r.data.attachmentName);return}this.setAttachment(e,r,this.attachmentNames[gt.search1(this.frames,s)])}}setAttachment(e,i,s){i.setAttachment(s?e.getAttachment(this.slotIndex,s):null)}}class Ui extends Nt{constructor(e,i,s,a){super(e,i,[nt.deform+"|"+s+"|"+a.id]);c(this,"slotIndex",0);c(this,"attachment");c(this,"vertices");this.slotIndex=s,this.attachment=a,this.vertices=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.vertices[e]=s}setBezier(e,i,s,a,l,n,h,r,o,d,u){let f=this.curves,m=this.getFrameCount()+e*18;s==0&&(f[i]=2+m);let g=(a-n*2+r)*.03,x=o*.03-h*.06,p=((n-r)*3-a+d)*.006,y=(h-o+.33333333)*.018,w=g*2+p,b=x*2+y,C=(n-a)*.3+g+p*.16666667,v=h*.3+x+y*.16666667,E=a+C,M=v;for(let T=m+18;m<T;m+=2)f[m]=E,f[m+1]=M,C+=w,v+=b,w+=p,b+=y,E+=C,M+=v}getCurvePercent(e,i){let s=this.curves,a=s[i];switch(a){case 0:let r=this.frames[i];return(e-r)/(this.frames[i+this.getFrameEntries()]-r);case 1:return 0}if(a-=2,s[a]>e){let r=this.frames[i];return s[a+1]*(e-r)/(s[a]-r)}let l=a+18;for(a+=2;a<l;a+=2)if(s[a]>=e){let r=s[a-2],o=s[a-1];return o+(e-r)/(s[a]-r)*(s[a+1]-o)}let n=s[l-2],h=s[l-1];return h+(1-h)*(e-n)/(this.frames[i+this.getFrameEntries()]-n)}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=r.getAttachment();if(!o||!(o instanceof Ot)||o.timelineAttachment!=this.attachment)return;let d=r.deform;d.length==0&&(n=L.setup);let u=this.vertices,f=u[0].length,m=this.frames;if(s<m[0]){switch(n){case L.setup:d.length=0;return;case L.first:if(l==1){d.length=0;return}d.length=f;let b=o;if(b.bones){l=1-l;for(var g=0;g<f;g++)d[g]*=l}else{let C=b.vertices;for(var g=0;g<f;g++)d[g]+=(C[g]-d[g])*l}}return}if(d.length=f,s>=m[m.length-1]){let b=u[m.length-1];if(l==1)if(n==L.add){let C=o;if(C.bones)for(let v=0;v<f;v++)d[v]+=b[v];else{let v=C.vertices;for(let E=0;E<f;E++)d[E]+=b[E]-v[E]}}else O.arrayCopy(b,0,d,0,f);else switch(n){case L.setup:{let v=o;if(v.bones)for(let E=0;E<f;E++)d[E]=b[E]*l;else{let E=v.vertices;for(let M=0;M<f;M++){let T=E[M];d[M]=T+(b[M]-T)*l}}break}case L.first:case L.replace:for(let v=0;v<f;v++)d[v]+=(b[v]-d[v])*l;break;case L.add:let C=o;if(C.bones)for(let v=0;v<f;v++)d[v]+=b[v]*l;else{let v=C.vertices;for(let E=0;E<f;E++)d[E]+=(b[E]-v[E])*l}}return}let x=gt.search1(m,s),p=this.getCurvePercent(s,x),y=u[x],w=u[x+1];if(l==1)if(n==L.add){let b=o;if(b.bones)for(let C=0;C<f;C++){let v=y[C];d[C]+=v+(w[C]-v)*p}else{let C=b.vertices;for(let v=0;v<f;v++){let E=y[v];d[v]+=E+(w[v]-E)*p-C[v]}}}else for(let b=0;b<f;b++){let C=y[b];d[b]=C+(w[b]-C)*p}else switch(n){case L.setup:{let C=o;if(C.bones)for(let v=0;v<f;v++){let E=y[v];d[v]=(E+(w[v]-E)*p)*l}else{let v=C.vertices;for(let E=0;E<f;E++){let M=y[E],T=v[E];d[E]=T+(M+(w[E]-M)*p-T)*l}}break}case L.first:case L.replace:for(let C=0;C<f;C++){let v=y[C];d[C]+=(v+(w[C]-v)*p-d[C])*l}break;case L.add:let b=o;if(b.bones)for(let C=0;C<f;C++){let v=y[C];d[C]+=(v+(w[C]-v)*p)*l}else{let C=b.vertices;for(let v=0;v<f;v++){let E=y[v];d[v]+=(E+(w[v]-E)*p-C[v])*l}}}}}const Ie=class Ie extends gt{constructor(e){super(e,Ie.propertyIds);c(this,"events");this.events=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i){this.frames[e]=i.time,this.events[e]=i}apply(e,i,s,a,l,n,h){if(!a)return;let r=this.frames,o=this.frames.length;if(i>s)this.apply(e,i,Number.MAX_VALUE,a,l,n,h),i=-1;else if(i>=r[o-1])return;if(s<r[0])return;let d=0;if(i<r[0])d=0;else{d=gt.search1(r,i)+1;let u=r[d];for(;d>0&&r[d-1]==u;)d--}for(;d<o&&s>=r[d];d++)a.push(this.events[d])}};c(Ie,"propertyIds",[""+nt.event]);let Se=Ie;const Le=class Le extends gt{constructor(e){super(e,Le.propertyIds);c(this,"drawOrders");this.drawOrders=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.drawOrders[e]=s}apply(e,i,s,a,l,n,h){if(h==Tt.mixOut){n==L.setup&&O.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}if(s<this.frames[0]){(n==L.setup||n==L.first)&&O.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}let r=gt.search1(this.frames,s),o=this.drawOrders[r];if(!o)O.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{let d=e.drawOrder,u=e.slots;for(let f=0,m=o.length;f<m;f++)d[f]=u[o[f]]}}};c(Le,"propertyIds",[""+nt.drawOrder]);let ae=Le;class Gi extends Nt{constructor(e,i,s){super(e,i,[nt.ikConstraint+"|"+s]);c(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 6}setFrame(e,i,s,a,l,n,h){e*=6,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=a,this.frames[e+3]=l,this.frames[e+4]=n?1:0,this.frames[e+5]=h?1:0}apply(e,i,s,a,l,n,h){let r=e.ikConstraints[this.constraintIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){switch(n){case L.setup:r.mix=r.data.mix,r.softness=r.data.softness,r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch;return;case L.first:r.mix+=(r.data.mix-r.mix)*l,r.softness+=(r.data.softness-r.softness)*l,r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch}return}let d=0,u=0,f=gt.search(o,s,6),m=this.curves[f/6];switch(m){case 0:let g=o[f];d=o[f+1],u=o[f+2];let x=(s-g)/(o[f+6]-g);d+=(o[f+6+1]-d)*x,u+=(o[f+6+2]-u)*x;break;case 1:d=o[f+1],u=o[f+2];break;default:d=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}n==L.setup?(r.mix=r.data.mix+(d-r.data.mix)*l,r.softness=r.data.softness+(u-r.data.softness)*l,h==Tt.mixOut?(r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch):(r.bendDirection=o[f+3],r.compress=o[f+4]!=0,r.stretch=o[f+5]!=0)):(r.mix+=(d-r.mix)*l,r.softness+=(u-r.softness)*l,h==Tt.mixIn&&(r.bendDirection=o[f+3],r.compress=o[f+4]!=0,r.stretch=o[f+5]!=0))}}class Hi extends Nt{constructor(e,i,s){super(e,i,[nt.transformConstraint+"|"+s]);c(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 7}setFrame(e,i,s,a,l,n,h,r){let o=this.frames;e*=7,o[e]=i,o[e+1]=s,o[e+2]=a,o[e+3]=l,o[e+4]=n,o[e+5]=h,o[e+6]=r}apply(e,i,s,a,l,n,h){let r=e.transformConstraints[this.constraintIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){let w=r.data;switch(n){case L.setup:r.mixRotate=w.mixRotate,r.mixX=w.mixX,r.mixY=w.mixY,r.mixScaleX=w.mixScaleX,r.mixScaleY=w.mixScaleY,r.mixShearY=w.mixShearY;return;case L.first:r.mixRotate+=(w.mixRotate-r.mixRotate)*l,r.mixX+=(w.mixX-r.mixX)*l,r.mixY+=(w.mixY-r.mixY)*l,r.mixScaleX+=(w.mixScaleX-r.mixScaleX)*l,r.mixScaleY+=(w.mixScaleY-r.mixScaleY)*l,r.mixShearY+=(w.mixShearY-r.mixShearY)*l}return}let d,u,f,m,g,x,p=gt.search(o,s,7),y=this.curves[p/7];switch(y){case 0:let w=o[p];d=o[p+1],u=o[p+2],f=o[p+3],m=o[p+4],g=o[p+5],x=o[p+6];let b=(s-w)/(o[p+7]-w);d+=(o[p+7+1]-d)*b,u+=(o[p+7+2]-u)*b,f+=(o[p+7+3]-f)*b,m+=(o[p+7+4]-m)*b,g+=(o[p+7+5]-g)*b,x+=(o[p+7+6]-x)*b;break;case 1:d=o[p+1],u=o[p+2],f=o[p+3],m=o[p+4],g=o[p+5],x=o[p+6];break;default:d=this.getBezierValue(s,p,1,y-2),u=this.getBezierValue(s,p,2,y+18-2),f=this.getBezierValue(s,p,3,y+18*2-2),m=this.getBezierValue(s,p,4,y+18*3-2),g=this.getBezierValue(s,p,5,y+18*4-2),x=this.getBezierValue(s,p,6,y+18*5-2)}if(n==L.setup){let w=r.data;r.mixRotate=w.mixRotate+(d-w.mixRotate)*l,r.mixX=w.mixX+(u-w.mixX)*l,r.mixY=w.mixY+(f-w.mixY)*l,r.mixScaleX=w.mixScaleX+(m-w.mixScaleX)*l,r.mixScaleY=w.mixScaleY+(g-w.mixScaleY)*l,r.mixShearY=w.mixShearY+(x-w.mixShearY)*l}else r.mixRotate+=(d-r.mixRotate)*l,r.mixX+=(u-r.mixX)*l,r.mixY+=(f-r.mixY)*l,r.mixScaleX+=(m-r.mixScaleX)*l,r.mixScaleY+=(g-r.mixScaleY)*l,r.mixShearY+=(x-r.mixShearY)*l}}class ji extends Bt{constructor(e,i,s){super(e,i,nt.pathConstraintPosition+"|"+s);c(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,a,l,n,h){let r=e.pathConstraints[this.constraintIndex];r.active&&(r.position=this.getAbsoluteValue(s,l,n,r.position,r.data.position))}}class Ji extends Bt{constructor(e,i,s){super(e,i,nt.pathConstraintSpacing+"|"+s);c(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,a,l,n,h){let r=e.pathConstraints[this.constraintIndex];r.active&&(r.spacing=this.getAbsoluteValue(s,l,n,r.spacing,r.data.spacing))}}class Ki extends Nt{constructor(e,i,s){super(e,i,[nt.pathConstraintMix+"|"+s]);c(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 4}setFrame(e,i,s,a,l){let n=this.frames;e<<=2,n[e]=i,n[e+1]=s,n[e+2]=a,n[e+3]=l}apply(e,i,s,a,l,n,h){let r=e.pathConstraints[this.constraintIndex];if(!r.active)return;let o=this.frames;if(s<o[0]){switch(n){case L.setup:r.mixRotate=r.data.mixRotate,r.mixX=r.data.mixX,r.mixY=r.data.mixY;return;case L.first:r.mixRotate+=(r.data.mixRotate-r.mixRotate)*l,r.mixX+=(r.data.mixX-r.mixX)*l,r.mixY+=(r.data.mixY-r.mixY)*l}return}let d,u,f,m=gt.search(o,s,4),g=this.curves[m>>2];switch(g){case 0:let x=o[m];d=o[m+1],u=o[m+2],f=o[m+3];let p=(s-x)/(o[m+4]-x);d+=(o[m+4+1]-d)*p,u+=(o[m+4+2]-u)*p,f+=(o[m+4+3]-f)*p;break;case 1:d=o[m+1],u=o[m+2],f=o[m+3];break;default:d=this.getBezierValue(s,m,1,g-2),u=this.getBezierValue(s,m,2,g+18-2),f=this.getBezierValue(s,m,3,g+18*2-2)}if(n==L.setup){let x=r.data;r.mixRotate=x.mixRotate+(d-x.mixRotate)*l,r.mixX=x.mixX+(u-x.mixX)*l,r.mixY=x.mixY+(f-x.mixY)*l}else r.mixRotate+=(d-r.mixRotate)*l,r.mixX+=(u-r.mixX)*l,r.mixY+=(f-r.mixY)*l}}class Kt extends Bt{constructor(e,i,s,a){super(e,i,a+"|"+s);c(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,a,l,n,h){let r;if(this.constraintIndex==-1){const o=s>=this.frames[0]?this.getCurveValue(s):0;for(const d of e.physicsConstraints)d.active&&this.global(d.data)&&this.set(d,this.getAbsoluteValue2(s,l,n,this.get(d),this.setup(d),o))}else r=e.physicsConstraints[this.constraintIndex],r.active&&this.set(r,this.getAbsoluteValue(s,l,n,this.get(r),this.setup(r)))}}class Qi extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintInertia)}setup(t){return t.data.inertia}get(t){return t.inertia}set(t,e){t.inertia=e}global(t){return t.inertiaGlobal}}class Zi extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintStrength)}setup(t){return t.data.strength}get(t){return t.strength}set(t,e){t.strength=e}global(t){return t.strengthGlobal}}class ts extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintDamping)}setup(t){return t.data.damping}get(t){return t.damping}set(t,e){t.damping=e}global(t){return t.dampingGlobal}}class es extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintMass)}setup(t){return 1/t.data.massInverse}get(t){return 1/t.massInverse}set(t,e){t.massInverse=1/e}global(t){return t.massGlobal}}class is extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintWind)}setup(t){return t.data.wind}get(t){return t.wind}set(t,e){t.wind=e}global(t){return t.windGlobal}}class ss extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintGravity)}setup(t){return t.data.gravity}get(t){return t.gravity}set(t,e){t.gravity=e}global(t){return t.gravityGlobal}}class ns extends Kt{constructor(t,e,i){super(t,e,i,nt.physicsConstraintMix)}setup(t){return t.data.mix}get(t){return t.mix}set(t,e){t.mix=e}global(t){return t.mixGlobal}}const Re=class Re extends gt{constructor(e,i){super(e,Re.propertyIds);c(this,"constraintIndex");this.constraintIndex=i}getFrameCount(){return this.frames.length}setFrame(e,i){this.frames[e]=i}apply(e,i,s,a,l,n,h){let r;if(this.constraintIndex!=-1&&(r=e.physicsConstraints[this.constraintIndex],!r.active))return;const o=this.frames;if(i>s)this.apply(e,i,Number.MAX_VALUE,[],l,n,h),i=-1;else if(i>=o[o.length-1])return;if(!(s<o[0])&&(i<o[0]||s>=o[gt.search1(o,i)+1]))if(r!=null)r.reset();else for(const d of e.physicsConstraints)d.active&&d.reset()}};c(Re,"propertyIds",[nt.physicsConstraintReset.toString()]);let Ue=Re;const Xt=class Xt extends gt{constructor(e,i,s){super(e,[nt.sequence+"|"+i+"|"+s.sequence.id]);c(this,"slotIndex");c(this,"attachment");this.slotIndex=i,this.attachment=s}getFrameEntries(){return Xt.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(e,i,s,a,l){let n=this.frames;e*=Xt.ENTRIES,n[e]=i,n[e+Xt.MODE]=s|a<<4,n[e+Xt.DELAY]=l}apply(e,i,s,a,l,n,h){let r=e.slots[this.slotIndex];if(!r.bone.active)return;let o=r.attachment,d=this.attachment;if(o!=d&&(!(o instanceof Ot)||o.timelineAttachment!=d))return;let u=this.frames;if(s<u[0]){(n==L.setup||n==L.first)&&(r.sequenceIndex=-1);return}let f=gt.search(u,s,Xt.ENTRIES),m=u[f],g=u[f+Xt.MODE],x=u[f+Xt.DELAY];if(!this.attachment.sequence)return;let p=g>>4,y=this.attachment.sequence.regions.length,w=Ii[g&15];if(w!=wt.hold)switch(p+=(s-m)/x+1e-5|0,w){case wt.once:p=Math.min(y-1,p);break;case wt.loop:p%=y;break;case wt.pingpong:{let b=(y<<1)-2;p=b==0?0:p%b,p>=y&&(p=b-p);break}case wt.onceReverse:p=Math.max(y-1-p,0);break;case wt.loopReverse:p=y-1-p%y;break;case wt.pingpongReverse:{let b=(y<<1)-2;p=b==0?0:(p+y-1)%b,p>=y&&(p=b-p)}}r.sequenceIndex=p}};c(Xt,"ENTRIES",3),c(Xt,"MODE",1),c(Xt,"DELAY",2);let Ge=Xt;const ne=class ne{constructor(t){c(this,"data");c(this,"tracks",new Array);c(this,"timeScale",1);c(this,"unkeyedState",0);c(this,"events",new Array);c(this,"listeners",new Array);c(this,"queue",new as(this));c(this,"propertyIDs",new yi);c(this,"animationsChanged",!1);c(this,"trackEntryPool",new Ee(()=>new rs));this.data=t}static emptyAnimation(){return ne._emptyAnimation}update(t){t*=this.timeScale;let e=this.tracks;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(!a)continue;a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;let l=t*a.timeScale;if(a.delay>0){if(a.delay-=l,a.delay>0)continue;l=-a.delay,a.delay=0}let n=a.next;if(n){let h=a.trackLast-n.delay;if(h>=0){for(n.delay=0,n.trackTime+=a.timeScale==0?0:(h/a.timeScale+t)*n.timeScale,a.trackTime+=l,this.setCurrent(i,n,!0);n.mixingFrom;)n.mixTime+=t,n=n.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&!a.mixingFrom){e[i]=null,this.queue.end(a),this.clearNext(a);continue}if(a.mixingFrom&&this.updateMixingFrom(a,t)){let h=a.mixingFrom;for(a.mixingFrom=null,h&&(h.mixingTo=null);h;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=l}this.queue.drain()}updateMixingFrom(t,e){let i=t.mixingFrom;if(!i)return!0;let s=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((i.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=i.mixingFrom,i.mixingFrom&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),s):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,i=this.tracks,s=!1;for(let u=0,f=i.length;u<f;u++){let m=i[u];if(!m||m.delay>0)continue;s=!0;let g=u==0?L.first:m.mixBlend,x=m.alpha;m.mixingFrom?x*=this.applyMixingFrom(m,t,g):m.trackTime>=m.trackEnd&&!m.next&&(x=0);let p=x>=m.alphaAttachmentThreshold,y=m.animationLast,w=m.getAnimationTime(),b=w,C=e;m.reverse&&(b=m.animation.duration-b,C=null);let v=m.animation.timelines,E=v.length;if(u==0&&x==1||g==L.add){u==0&&(p=!0);for(let M=0;M<E;M++){var a=v[M];a instanceof fe?this.applyAttachmentTimeline(a,t,b,g,p):a.apply(t,y,b,C,x,g,Tt.mixIn)}}else{let M=m.timelineMode,T=m.shortestRotation,R=!T&&m.timelinesRotation.length!=E<<1;R&&(m.timelinesRotation.length=E<<1);for(let X=0;X<E;X++){let V=v[X],D=M[X]==_e?g:L.setup;!T&&V instanceof qe?this.applyRotateTimeline(V,t,b,x,D,m.timelinesRotation,X<<1,R):V instanceof fe?this.applyAttachmentTimeline(V,t,b,g,p):V.apply(t,y,b,C,x,D,Tt.mixIn)}}this.queueEvents(m,w),e.length=0,m.nextAnimationLast=w,m.nextTrackLast=m.trackTime}for(var l=this.unkeyedState+di,n=t.slots,h=0,r=t.slots.length;h<r;h++){var o=n[h];if(o.attachmentState==l){var d=o.data.attachmentName;o.setAttachment(d?t.getAttachment(o.data.index,d):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,i){let s=t.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,e,i);let a=0;t.mixDuration==0?(a=1,i==L.first&&(i=L.setup)):(a=t.mixTime/t.mixDuration,a>1&&(a=1),i!=L.first&&(i=s.mixBlend));let l=a<s.mixAttachmentThreshold,n=a<s.mixDrawOrderThreshold,h=s.animation.timelines,r=h.length,o=s.alpha*t.interruptAlpha,d=o*(1-a),u=s.animationLast,f=s.getAnimationTime(),m=f,g=null;if(s.reverse?m=s.animation.duration-m:a<s.eventThreshold&&(g=this.events),i==L.add)for(let x=0;x<r;x++)h[x].apply(e,u,m,g,d,i,Tt.mixOut);else{let x=s.timelineMode,p=s.timelineHoldMix,y=s.shortestRotation,w=!y&&s.timelinesRotation.length!=r<<1;w&&(s.timelinesRotation.length=r<<1),s.totalAlpha=0;for(let b=0;b<r;b++){let C=h[b],v=Tt.mixOut,E,M=0;switch(x[b]){case _e:if(!n&&C instanceof ae)continue;E=i,M=d;break;case hi:E=L.setup,M=d;break;case ci:E=i,M=o;break;case $e:E=L.setup,M=o;break;default:E=L.setup;let T=p[b];M=o*Math.max(0,1-T.mixTime/T.mixDuration);break}s.totalAlpha+=M,!y&&C instanceof qe?this.applyRotateTimeline(C,e,m,M,E,s.timelinesRotation,b<<1,w):C instanceof fe?this.applyAttachmentTimeline(C,e,m,E,l&&M>=s.alphaAttachmentThreshold):(n&&C instanceof ae&&E==L.setup&&(v=Tt.mixIn),C.apply(e,u,m,g,M,E,v))}}return t.mixDuration>0&&this.queueEvents(s,f),this.events.length=0,s.nextAnimationLast=f,s.nextTrackLast=s.trackTime,a}applyAttachmentTimeline(t,e,i,s,a){var l=e.slots[t.slotIndex];l.bone.active&&(i<t.frames[0]?(s==L.setup||s==L.first)&&this.setAttachment(e,l,l.data.attachmentName,a):this.setAttachment(e,l,t.attachmentNames[gt.search1(t.frames,i)],a),l.attachmentState<=this.unkeyedState&&(l.attachmentState=this.unkeyedState+di))}setAttachment(t,e,i,s){e.setAttachment(i?t.getAttachment(e.data.index,i):null),s&&(e.attachmentState=this.unkeyedState+os)}applyRotateTimeline(t,e,i,s,a,l,n,h){if(h&&(l[n]=0),s==1){t.apply(e,0,i,null,1,a,Tt.mixIn);return}let r=e.bones[t.boneIndex];if(!r.active)return;let o=t.frames,d=0,u=0;if(i<o[0])switch(a){case L.setup:r.rotation=r.data.rotation;default:return;case L.first:d=r.rotation,u=r.data.rotation}else d=a==L.setup?r.data.rotation:r.rotation,u=r.data.rotation+t.getCurveValue(i);let f=0,m=u-d;if(m-=Math.ceil(m/360-.5)*360,m==0)f=l[n];else{let g=0,x=0;h?(g=0,x=m):(g=l[n],x=l[n+1]);let p=g-g%360;f=m+p;let y=m>=0,w=g>=0;Math.abs(x)<=90&&P.signum(x)!=P.signum(m)&&(Math.abs(g-p)>180?(f+=360*P.signum(g),w=y):p!=0?f-=360*P.signum(g):w=y),w!=y&&(f+=360*P.signum(g)),l[n]=f}l[n+1]=m,r.rotation=d+f*s}queueEvents(t,e){let i=t.animationStart,s=t.animationEnd,a=s-i,l=t.trackLast%a,n=this.events,h=0,r=n.length;for(;h<r;h++){let d=n[h];if(d.time<l)break;d.time>s||this.queue.event(t,d)}let o=!1;if(t.loop)if(a==0)o=!0;else{const d=Math.floor(t.trackTime/a);o=d>0&&d>Math.floor(t.trackTime/a)}else o=e>=s&&t.animationLast<s;for(o&&this.queue.complete(t);h<r;h++){let d=n[h];d.time<i||this.queue.event(t,d)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let i=e;for(;;){let s=i.mixingFrom;if(!s)break;this.queue.end(s),i.mixingFrom=null,i.mixingTo=null,i=s}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){let s=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,s&&(i&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i=!1){let s=this.data.skeletonData.findAnimation(e);if(!s)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,s,i)}setAnimationWith(t,e,i=!1){if(!e)throw new Error("animation cannot be null.");let s=!0,a=this.expandToIndex(t);a&&(a.nextTrackLast==-1?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.clearNext(a),a=a.mixingFrom,s=!1):this.clearNext(a));let l=this.trackEntry(t,e,i,a);return this.setCurrent(t,l,s),this.queue.drain(),l}addAnimation(t,e,i=!1,s=0){let a=this.data.skeletonData.findAnimation(e);if(!a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,i,s)}addAnimationWith(t,e,i=!1,s=0){if(!e)throw new Error("animation cannot be null.");let a=this.expandToIndex(t);if(a)for(;a.next;)a=a.next;let l=this.trackEntry(t,e,i,a);return a?(a.next=l,l.previous=a,s<=0&&(s+=a.getTrackComplete()-l.mixDuration)):(this.setCurrent(t,l,!0),this.queue.drain()),l.delay=s,l}setEmptyAnimation(t,e=0){let i=this.setAnimationWith(t,ne.emptyAnimation(),!1);return i.mixDuration=e,i.trackEnd=e,i}addEmptyAnimation(t,e=0,i=0){let s=this.addAnimationWith(t,ne.emptyAnimation(),!1,i);return i<=0&&(s.delay+=s.mixDuration-e),s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t=0){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,s=this.tracks.length;i<s;i++){let a=this.tracks[i];a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(O.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,s){let a=this.trackEntryPool.obtain();return a.reset(),a.trackIndex=t,a.animation=e,a.loop=i,a.holdPrevious=!1,a.reverse=!1,a.shortestRotation=!1,a.eventThreshold=0,a.alphaAttachmentThreshold=0,a.mixAttachmentThreshold=0,a.mixDrawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.mixTime=0,a.mixDuration=s?this.data.getMix(s.animation,e):0,a.interruptAlpha=1,a.totalAlpha=0,a.mixBlend=L.replace,a}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let s=t[e];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do(!s.mixingTo||s.mixBlend!=L.add)&&this.computeHold(s),s=s.mixingTo;while(s)}}}computeHold(t){let e=t.mixingTo,i=t.animation.timelines,s=t.animation.timelines.length,a=t.timelineMode;a.length=s;let l=t.timelineHoldMix;l.length=0;let n=this.propertyIDs;if(e&&e.holdPrevious){for(let h=0;h<s;h++)a[h]=n.addAll(i[h].getPropertyIds())?$e:ci;return}t:for(let h=0;h<s;h++){let r=i[h],o=r.getPropertyIds();if(!n.addAll(o))a[h]=_e;else if(!e||r instanceof fe||r instanceof ae||r instanceof Se||!e.animation.hasTimeline(o))a[h]=hi;else{for(let d=e.mixingTo;d;d=d.mixingTo)if(!d.animation.hasTimeline(o)){if(t.mixDuration>0){a[h]=ls,l[h]=d;continue t}break}a[h]=$e}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};c(ne,"_emptyAnimation",new Ci("<empty>",[],0));let me=ne;class rs{constructor(){c(this,"animation",null);c(this,"previous",null);c(this,"next",null);c(this,"mixingFrom",null);c(this,"mixingTo",null);c(this,"listener",null);c(this,"trackIndex",0);c(this,"loop",!1);c(this,"holdPrevious",!1);c(this,"reverse",!1);c(this,"shortestRotation",!1);c(this,"eventThreshold",0);c(this,"mixAttachmentThreshold",0);c(this,"alphaAttachmentThreshold",0);c(this,"mixDrawOrderThreshold",0);c(this,"animationStart",0);c(this,"animationEnd",0);c(this,"animationLast",0);c(this,"nextAnimationLast",0);c(this,"delay",0);c(this,"trackTime",0);c(this,"trackLast",0);c(this,"nextTrackLast",0);c(this,"trackEnd",0);c(this,"timeScale",0);c(this,"alpha",0);c(this,"mixTime",0);c(this,"_mixDuration",0);c(this,"interruptAlpha",0);c(this,"totalAlpha",0);c(this,"mixBlend",L.replace);c(this,"timelineMode",new Array);c(this,"timelineHoldMix",new Array);c(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(t){this._mixDuration=t,this.previous!=null&&this.delay<=0&&(this.delay+=this.previous.getTrackComplete()-t),this.delay=this.delay}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(t!=0){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}wasApplied(){return this.nextTrackLast!=-1}}class as{constructor(t){c(this,"objects",[]);c(this,"drainDisabled",!1);c(this,"animState");this.animState=t}start(t){this.objects.push(Mt.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(Mt.interrupt),this.objects.push(t)}end(t){this.objects.push(Mt.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(Mt.dispose),this.objects.push(t)}complete(t){this.objects.push(Mt.complete),this.objects.push(t)}event(t,e){this.objects.push(Mt.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){let s=t[i],a=t[i+1];switch(s){case Mt.start:a.listener&&a.listener.start&&a.listener.start(a);for(let n=0;n<e.length;n++){let h=e[n];h.start&&h.start(a)}break;case Mt.interrupt:a.listener&&a.listener.interrupt&&a.listener.interrupt(a);for(let n=0;n<e.length;n++){let h=e[n];h.interrupt&&h.interrupt(a)}break;case Mt.end:a.listener&&a.listener.end&&a.listener.end(a);for(let n=0;n<e.length;n++){let h=e[n];h.end&&h.end(a)}case Mt.dispose:a.listener&&a.listener.dispose&&a.listener.dispose(a);for(let n=0;n<e.length;n++){let h=e[n];h.dispose&&h.dispose(a)}this.animState.trackEntryPool.free(a);break;case Mt.complete:a.listener&&a.listener.complete&&a.listener.complete(a);for(let n=0;n<e.length;n++){let h=e[n];h.complete&&h.complete(a)}break;case Mt.event:let l=t[i+++2];a.listener&&a.listener.event&&a.listener.event(a,l);for(let n=0;n<e.length;n++){let h=e[n];h.event&&h.event(a,l)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Mt;(function(A){A[A.start=0]="start",A[A.interrupt=1]="interrupt",A[A.end=2]="end",A[A.dispose=3]="dispose",A[A.complete=4]="complete",A[A.event=5]="event"})(Mt||(Mt={}));const _e=0,hi=1,ci=2,$e=3,ls=4,di=1,os=2;class hs{constructor(t){c(this,"skeletonData");c(this,"animationToMixTime",{});c(this,"defaultMix",0);if(!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){let s=this.skeletonData.findAnimation(t);if(!s)throw new Error("Animation not found: "+t);let a=this.skeletonData.findAnimation(e);if(!a)throw new Error("Animation not found: "+e);this.setMixWith(s,a,i)}setMixWith(t,e,i){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let s=t.name+"."+e.name;this.animationToMixTime[s]=i}getMix(t,e){let i=t.name+"."+e.name,s=this.animationToMixTime[i];return s===void 0?this.defaultMix:s}}class Fe extends Ot{constructor(e){super(e);c(this,"color",new st(1,1,1,1))}copy(){let e=new Fe(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}}class be extends Ot{constructor(e){super(e);c(this,"endSlot",null);c(this,"color",new st(.2275,.2275,.8078,1))}copy(){let e=new be(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}}class cs{constructor(t){c(this,"_image");this._image=t}getImage(){return this._image}}var Ct;(function(A){A[A.Nearest=9728]="Nearest",A[A.Linear=9729]="Linear",A[A.MipMap=9987]="MipMap",A[A.MipMapNearestNearest=9984]="MipMapNearestNearest",A[A.MipMapLinearNearest=9985]="MipMapLinearNearest",A[A.MipMapNearestLinear=9986]="MipMapNearestLinear",A[A.MipMapLinearLinear=9987]="MipMapLinearLinear"})(Ct||(Ct={}));var he;(function(A){A[A.MirroredRepeat=33648]="MirroredRepeat",A[A.ClampToEdge=33071]="ClampToEdge",A[A.Repeat=10497]="Repeat"})(he||(he={}));class ds{constructor(){c(this,"texture");c(this,"u",0);c(this,"v",0);c(this,"u2",0);c(this,"v2",0);c(this,"width",0);c(this,"height",0);c(this,"degrees",0);c(this,"offsetX",0);c(this,"offsetY",0);c(this,"originalWidth",0);c(this,"originalHeight",0)}}class us{constructor(t){c(this,"pages",new Array);c(this,"regions",new Array);let e=new fs(t),i=new Array(4),s={};s.size=o=>{o.width=parseInt(i[1]),o.height=parseInt(i[2])},s.format=()=>{},s.filter=o=>{o.minFilter=O.enumValue(Ct,i[1]),o.magFilter=O.enumValue(Ct,i[2])},s.repeat=o=>{i[1].indexOf("x")!=-1&&(o.uWrap=he.Repeat),i[1].indexOf("y")!=-1&&(o.vWrap=he.Repeat)},s.pma=o=>{o.pma=i[1]=="true"};var a={};a.xy=o=>{o.x=parseInt(i[1]),o.y=parseInt(i[2])},a.size=o=>{o.width=parseInt(i[1]),o.height=parseInt(i[2])},a.bounds=o=>{o.x=parseInt(i[1]),o.y=parseInt(i[2]),o.width=parseInt(i[3]),o.height=parseInt(i[4])},a.offset=o=>{o.offsetX=parseInt(i[1]),o.offsetY=parseInt(i[2])},a.orig=o=>{o.originalWidth=parseInt(i[1]),o.originalHeight=parseInt(i[2])},a.offsets=o=>{o.offsetX=parseInt(i[1]),o.offsetY=parseInt(i[2]),o.originalWidth=parseInt(i[3]),o.originalHeight=parseInt(i[4])},a.rotate=o=>{let d=i[1];d=="true"?o.degrees=90:d!="false"&&(o.degrees=parseInt(d))},a.index=o=>{o.index=parseInt(i[1])};let l=e.readLine();for(;l&&l.trim().length==0;)l=e.readLine();for(;!(!l||l.trim().length==0||e.readEntry(i,l)==0);)l=e.readLine();let n=null,h=null,r=null;for(;l!==null;)if(l.trim().length==0)n=null,l=e.readLine();else if(n){let o=new Ei(n,l);for(;;){let d=e.readEntry(i,l=e.readLine());if(d==0)break;let u=a[i[0]];if(u)u(o);else{h||(h=[]),r||(r=[]),h.push(i[0]);let f=[];for(let m=0;m<d;m++)f.push(parseInt(i[m+1]));r.push(f)}}o.originalWidth==0&&o.originalHeight==0&&(o.originalWidth=o.width,o.originalHeight=o.height),h&&h.length>0&&r&&r.length>0&&(o.names=h,o.values=r,h=null,r=null),o.u=o.x/n.width,o.v=o.y/n.height,o.degrees==90?(o.u2=(o.x+o.height)/n.width,o.v2=(o.y+o.width)/n.height):(o.u2=(o.x+o.width)/n.width,o.v2=(o.y+o.height)/n.height),this.regions.push(o)}else{for(n=new ms(l.trim());e.readEntry(i,l=e.readLine())!=0;){let o=s[i[0]];o&&o(n)}this.pages.push(n)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t,e=""){for(let i of this.pages)i.setTexture(t.get(e+i.name))}dispose(){var t;for(let e=0;e<this.pages.length;e++)(t=this.pages[e].texture)==null||t.dispose()}}class fs{constructor(t){c(this,"lines");c(this,"index",0);this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e||(e=e.trim(),e.length==0))return 0;let i=e.indexOf(":");if(i==-1)return 0;t[0]=e.substr(0,i).trim();for(let s=1,a=i+1;;s++){let l=e.indexOf(",",a);if(l==-1)return t[s]=e.substr(a).trim(),s;if(t[s]=e.substr(a,l-a).trim(),a=l+1,s==4)return 4}}}class ms{constructor(t){c(this,"name");c(this,"minFilter",Ct.Nearest);c(this,"magFilter",Ct.Nearest);c(this,"uWrap",he.ClampToEdge);c(this,"vWrap",he.ClampToEdge);c(this,"texture",null);c(this,"width",0);c(this,"height",0);c(this,"pma",!1);c(this,"regions",new Array);this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(let e of this.regions)e.texture=t}}class Ei extends ds{constructor(e,i){super();c(this,"page");c(this,"name");c(this,"x",0);c(this,"y",0);c(this,"offsetX",0);c(this,"offsetY",0);c(this,"originalWidth",0);c(this,"originalHeight",0);c(this,"index",0);c(this,"degrees",0);c(this,"names",null);c(this,"values",null);this.page=e,this.name=i,e.regions.push(this)}}class Ht extends Ot{constructor(e,i){super(e);c(this,"region",null);c(this,"path");c(this,"regionUVs",[]);c(this,"uvs",[]);c(this,"triangles",[]);c(this,"color",new st(1,1,1,1));c(this,"width",0);c(this,"height",0);c(this,"hullLength",0);c(this,"edges",[]);c(this,"parentMesh",null);c(this,"sequence",null);c(this,"tempColor",new st(0,0,0,0));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.regionUVs;(!this.uvs||this.uvs.length!=e.length)&&(this.uvs=O.newFloatArray(e.length));let i=this.uvs,s=this.uvs.length,a=this.region.u,l=this.region.v,n=0,h=0;if(this.region instanceof Ei){let r=this.region,o=r.page,d=o.width,u=o.height;switch(r.degrees){case 90:a-=(r.originalHeight-r.offsetY-r.height)/d,l-=(r.originalWidth-r.offsetX-r.width)/u,n=r.originalHeight/d,h=r.originalWidth/u;for(let f=0;f<s;f+=2)i[f]=a+e[f+1]*n,i[f+1]=l+(1-e[f])*h;return;case 180:a-=(r.originalWidth-r.offsetX-r.width)/d,l-=r.offsetY/u,n=r.originalWidth/d,h=r.originalHeight/u;for(let f=0;f<s;f+=2)i[f]=a+(1-e[f])*n,i[f+1]=l+(1-e[f+1])*h;return;case 270:a-=r.offsetY/d,l-=r.offsetX/u,n=r.originalHeight/d,h=r.originalWidth/u;for(let f=0;f<s;f+=2)i[f]=a+(1-e[f+1])*n,i[f+1]=l+e[f]*h;return}a-=r.offsetX/d,l-=(r.originalHeight-r.offsetY-r.height)/u,n=r.originalWidth/d,h=r.originalHeight/u}else this.region?(n=this.region.u2-a,h=this.region.v2-l):(a=l=0,n=h=1);for(let r=0;r<s;r+=2)i[r]=a+e[r]*n,i[r+1]=l+e[r+1]*h}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let e=new Ht(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),O.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),O.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),O.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),O.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}computeWorldVertices(e,i,s,a,l,n){this.sequence!=null&&this.sequence.apply(e,this),super.computeWorldVertices(e,i,s,a,l,n)}newLinkedMesh(){let e=new Ht(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),e.region!=null&&e.updateRegion(),e}}class Jt extends Ot{constructor(e){super(e);c(this,"lengths",[]);c(this,"closed",!1);c(this,"constantSpeed",!1);c(this,"color",new st(1,1,1,1))}copy(){let e=new Jt(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),O.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}}class ii extends Ot{constructor(e){super(e);c(this,"x",0);c(this,"y",0);c(this,"rotation",0);c(this,"color",new st(.38,.94,0,1))}computeWorldPosition(e,i){return i.x=this.x*e.a+this.y*e.b+e.worldX,i.y=this.x*e.c+this.y*e.d+e.worldY,i}computeWorldRotation(e){const i=this.rotation*P.degRad,s=Math.cos(i),a=Math.sin(i),l=s*e.a+a*e.b,n=s*e.c+a*e.d;return P.atan2Deg(n,l)}copy(){let e=new ii(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}}const ot=class ot extends Ai{constructor(e,i){super(e);c(this,"x",0);c(this,"y",0);c(this,"scaleX",1);c(this,"scaleY",1);c(this,"rotation",0);c(this,"width",0);c(this,"height",0);c(this,"color",new st(1,1,1,1));c(this,"path");c(this,"region",null);c(this,"sequence",null);c(this,"offset",O.newFloatArray(8));c(this,"uvs",O.newFloatArray(8));c(this,"tempColor",new st(1,1,1,1));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.region,i=this.uvs;if(e==null){i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=1,i[5]=1,i[6]=1,i[7]=0;return}let s=this.width/this.region.originalWidth*this.scaleX,a=this.height/this.region.originalHeight*this.scaleY,l=-this.width/2*this.scaleX+this.region.offsetX*s,n=-this.height/2*this.scaleY+this.region.offsetY*a,h=l+this.region.width*s,r=n+this.region.height*a,o=this.rotation*P.degRad,d=Math.cos(o),u=Math.sin(o),f=this.x,m=this.y,g=l*d+f,x=l*u,p=n*d+m,y=n*u,w=h*d+f,b=h*u,C=r*d+m,v=r*u,E=this.offset;E[0]=g-y,E[1]=p+x,E[2]=g-v,E[3]=C+x,E[4]=w-v,E[5]=C+b,E[6]=w-y,E[7]=p+b,e.degrees==90?(i[0]=e.u2,i[1]=e.v2,i[2]=e.u,i[3]=e.v2,i[4]=e.u,i[5]=e.v,i[6]=e.u2,i[7]=e.v):(i[0]=e.u,i[1]=e.v2,i[2]=e.u,i[3]=e.v,i[4]=e.u2,i[5]=e.v,i[6]=e.u2,i[7]=e.v2)}computeWorldVertices(e,i,s,a){this.sequence!=null&&this.sequence.apply(e,this);let l=e.bone,n=this.offset,h=l.worldX,r=l.worldY,o=l.a,d=l.b,u=l.c,f=l.d,m=0,g=0;m=n[0],g=n[1],i[s]=m*o+g*d+h,i[s+1]=m*u+g*f+r,s+=a,m=n[2],g=n[3],i[s]=m*o+g*d+h,i[s+1]=m*u+g*f+r,s+=a,m=n[4],g=n[5],i[s]=m*o+g*d+h,i[s+1]=m*u+g*f+r,s+=a,m=n[6],g=n[7],i[s]=m*o+g*d+h,i[s+1]=m*u+g*f+r}copy(){let e=new ot(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,O.arrayCopy(this.uvs,0,e.uvs,0,8),O.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=this.sequence!=null?this.sequence.copy():null,e}};c(ot,"X1",0),c(ot,"Y1",1),c(ot,"C1R",2),c(ot,"C1G",3),c(ot,"C1B",4),c(ot,"C1A",5),c(ot,"U1",6),c(ot,"V1",7),c(ot,"X2",8),c(ot,"Y2",9),c(ot,"C2R",10),c(ot,"C2G",11),c(ot,"C2B",12),c(ot,"C2A",13),c(ot,"U2",14),c(ot,"V2",15),c(ot,"X3",16),c(ot,"Y3",17),c(ot,"C3R",18),c(ot,"C3G",19),c(ot,"C3B",20),c(ot,"C3A",21),c(ot,"U3",22),c(ot,"V3",23),c(ot,"X4",24),c(ot,"Y4",25),c(ot,"C4R",26),c(ot,"C4G",27),c(ot,"C4B",28),c(ot,"C4A",29),c(ot,"U4",30),c(ot,"V4",31);let ce=ot;class gs{constructor(t){c(this,"atlas");this.atlas=t}loadSequence(t,e,i){let s=i.regions;for(let a=0,l=s.length;a<l;a++){let n=i.getPath(e,a),h=this.atlas.findRegion(n);if(h==null)throw new Error("Region not found in atlas: "+n+" (sequence: "+t+")");s[a]=h}}newRegionAttachment(t,e,i,s){let a=new ce(e,i);if(s!=null)this.loadSequence(e,i,s);else{let l=this.atlas.findRegion(i);if(!l)throw new Error("Region not found in atlas: "+i+" (region attachment: "+e+")");a.region=l}return a}newMeshAttachment(t,e,i,s){let a=new Ht(e,i);if(s!=null)this.loadSequence(e,i,s);else{let l=this.atlas.findRegion(i);if(!l)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");a.region=l}return a}newBoundingBoxAttachment(t,e){return new Fe(e)}newPathAttachment(t,e){return new Jt(e)}newPointAttachment(t,e){return new ii(e)}newClippingAttachment(t,e){return new be(e)}}class ps{constructor(t,e,i){c(this,"index",0);c(this,"name");c(this,"parent",null);c(this,"length",0);c(this,"x",0);c(this,"y",0);c(this,"rotation",0);c(this,"scaleX",1);c(this,"scaleY",1);c(this,"shearX",0);c(this,"shearY",0);c(this,"inherit",pt.Normal);c(this,"skinRequired",!1);c(this,"color",new st);c(this,"icon");c(this,"visible",!1);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}}var pt;(function(A){A[A.Normal=0]="Normal",A[A.OnlyTranslation=1]="OnlyTranslation",A[A.NoRotationOrReflection=2]="NoRotationOrReflection",A[A.NoScale=3]="NoScale",A[A.NoScaleOrReflection=4]="NoScaleOrReflection"})(pt||(pt={}));class ui{constructor(t,e,i){c(this,"data");c(this,"skeleton");c(this,"parent",null);c(this,"children",new Array);c(this,"x",0);c(this,"y",0);c(this,"rotation",0);c(this,"scaleX",0);c(this,"scaleY",0);c(this,"shearX",0);c(this,"shearY",0);c(this,"ax",0);c(this,"ay",0);c(this,"arotation",0);c(this,"ascaleX",0);c(this,"ascaleY",0);c(this,"ashearX",0);c(this,"ashearY",0);c(this,"a",0);c(this,"b",0);c(this,"c",0);c(this,"d",0);c(this,"worldY",0);c(this,"worldX",0);c(this,"inherit",pt.Normal);c(this,"sorted",!1);c(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}isActive(){return this.active}update(t){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,s,a,l,n){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=s,this.ascaleY=a,this.ashearX=l,this.ashearY=n;let h=this.parent;if(!h){let f=this.skeleton;const m=f.scaleX,g=f.scaleY,x=(i+l)*P.degRad,p=(i+90+n)*P.degRad;this.a=Math.cos(x)*s*m,this.b=Math.cos(p)*a*m,this.c=Math.sin(x)*s*g,this.d=Math.sin(p)*a*g,this.worldX=t*m+f.x,this.worldY=e*g+f.y;return}let r=h.a,o=h.b,d=h.c,u=h.d;switch(this.worldX=r*t+o*e+h.worldX,this.worldY=d*t+u*e+h.worldY,this.inherit){case pt.Normal:{const f=(i+l)*P.degRad,m=(i+90+n)*P.degRad,g=Math.cos(f)*s,x=Math.cos(m)*a,p=Math.sin(f)*s,y=Math.sin(m)*a;this.a=r*g+o*p,this.b=r*x+o*y,this.c=d*g+u*p,this.d=d*x+u*y;return}case pt.OnlyTranslation:{const f=(i+l)*P.degRad,m=(i+90+n)*P.degRad;this.a=Math.cos(f)*s,this.b=Math.cos(m)*a,this.c=Math.sin(f)*s,this.d=Math.sin(m)*a;break}case pt.NoRotationOrReflection:{let f=r*r+d*d,m=0;f>1e-4?(f=Math.abs(r*u-o*d)/f,r/=this.skeleton.scaleX,d/=this.skeleton.scaleY,o=d*f,u=r*f,m=Math.atan2(d,r)*P.radDeg):(r=0,d=0,m=90-Math.atan2(u,o)*P.radDeg);const g=(i+l-m)*P.degRad,x=(i+n-m+90)*P.degRad,p=Math.cos(g)*s,y=Math.cos(x)*a,w=Math.sin(g)*s,b=Math.sin(x)*a;this.a=r*p-o*w,this.b=r*y-o*b,this.c=d*p+u*w,this.d=d*y+u*b;break}case pt.NoScale:case pt.NoScaleOrReflection:{i*=P.degRad;const f=Math.cos(i),m=Math.sin(i);let g=(r*f+o*m)/this.skeleton.scaleX,x=(d*f+u*m)/this.skeleton.scaleY,p=Math.sqrt(g*g+x*x);p>1e-5&&(p=1/p),g*=p,x*=p,p=Math.sqrt(g*g+x*x),this.inherit==pt.NoScale&&r*u-o*d<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(p=-p),i=Math.PI/2+Math.atan2(x,g);const y=Math.cos(i)*p,w=Math.sin(i)*p;l*=P.degRad,n=(90+n)*P.degRad;const b=Math.cos(l)*s,C=Math.cos(n)*a,v=Math.sin(l)*s,E=Math.sin(n)*a;this.a=g*b+y*v,this.b=g*C+y*E,this.c=x*b+w*v,this.d=x*C+w*E;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY,this.inherit=t.inherit}updateAppliedTransform(){let t=this.parent;if(!t){this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*P.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*P.radDeg;return}let e=t.a,i=t.b,s=t.c,a=t.d,l=1/(e*a-i*s),n=a*l,h=i*l,r=s*l,o=e*l,d=this.worldX-t.worldX,u=this.worldY-t.worldY;this.ax=d*n-u*h,this.ay=u*o-d*r;let f,m,g,x;if(this.inherit==pt.OnlyTranslation)f=this.a,m=this.b,g=this.c,x=this.d;else{switch(this.inherit){case pt.NoRotationOrReflection:{let C=Math.abs(e*a-i*s)/(e*e+s*s),v=e/this.skeleton.scaleX;i=-(s/this.skeleton.scaleY)*C*this.skeleton.scaleX,a=v*C*this.skeleton.scaleY,l=1/(e*a-i*s),n=a*l,h=i*l;break}case pt.NoScale:case pt.NoScaleOrReflection:let p=P.cosDeg(this.rotation),y=P.sinDeg(this.rotation);e=(e*p+i*y)/this.skeleton.scaleX,s=(s*p+a*y)/this.skeleton.scaleY;let w=Math.sqrt(e*e+s*s);w>1e-5&&(w=1/w),e*=w,s*=w,w=Math.sqrt(e*e+s*s),this.inherit==pt.NoScale&&l<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(w=-w);let b=P.PI/2+Math.atan2(s,e);i=Math.cos(b)*w,a=Math.sin(b)*w,l=1/(e*a-i*s),n=a*l,h=i*l,r=s*l,o=e*l}f=n*this.a-h*this.c,m=n*this.b-h*this.d,g=o*this.c-r*this.a,x=o*this.d-r*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(f*f+g*g),this.ascaleX>1e-4){let p=f*x-m*g;this.ascaleY=p/this.ascaleX,this.ashearY=-Math.atan2(f*m+g*x,p)*P.radDeg,this.arotation=Math.atan2(g,f)*P.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(m*m+x*x),this.ashearY=0,this.arotation=90-Math.atan2(x,m)*P.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*P.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*P.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),i=t.x-this.worldX,s=t.y-this.worldY;return t.x=i*this.d*e-s*this.b*e,t.y=s*this.a*e-i*this.c*e,t}localToWorld(t){let e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t}worldToParent(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.worldToLocal(t)}parentToWorld(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.localToWorld(t)}worldToLocalRotation(t){let e=P.sinDeg(t),i=P.cosDeg(t);return Math.atan2(this.a*e-this.c*i,this.d*i-this.b*e)*P.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=P.sinDeg(t),i=P.cosDeg(t);return Math.atan2(i*this.c+e*this.d,i*this.a+e*this.b)*P.radDeg}rotateWorld(t){t*=P.degRad;const e=Math.sin(t),i=Math.cos(t),s=this.a,a=this.b;this.a=i*s-e*this.c,this.b=i*a-e*this.d,this.c=e*s+i*this.c,this.d=e*a+i*this.d}}class Ve{constructor(t,e,i){c(this,"name");c(this,"order");c(this,"skinRequired");this.name=t,this.order=e,this.skinRequired=i}}class xs{constructor(t,e="",i=new Si){c(this,"pathPrefix","");c(this,"textureLoader");c(this,"downloader");c(this,"assets",{});c(this,"errors",{});c(this,"toLoad",0);c(this,"loaded",0);this.textureLoader=t,this.pathPrefix=e,this.downloader=i}start(t){return this.toLoad++,this.pathPrefix+t}success(t,e,i){this.toLoad--,this.loaded++,this.assets[e]=i,t&&t(e,i)}error(t,e,i){this.toLoad--,this.loaded++,this.errors[e]=i,t&&t(e,i)}loadAll(){return new Promise((e,i)=>{let s=()=>{if(this.isLoadingComplete()){this.hasErrors()?i(this.errors):e(this);return}requestAnimationFrame(s)};requestAnimationFrame(s)})}setRawDataURI(t,e){this.downloader.rawDataUris[this.pathPrefix+t]=e}loadBinary(t,e=()=>{},i=()=>{}){t=this.start(t),this.downloader.downloadBinary(t,s=>{this.success(e,t,s)},(s,a)=>{this.error(i,t,`Couldn't load binary ${t}: status ${s}, ${a}`)})}loadText(t,e=()=>{},i=()=>{}){t=this.start(t),this.downloader.downloadText(t,s=>{this.success(e,t,s)},(s,a)=>{this.error(i,t,`Couldn't load text ${t}: status ${s}, ${a}`)})}loadJson(t,e=()=>{},i=()=>{}){t=this.start(t),this.downloader.downloadJson(t,s=>{this.success(e,t,s)},(s,a)=>{this.error(i,t,`Couldn't load JSON ${t}: status ${s}, ${a}`)})}loadTexture(t,e=()=>{},i=()=>{}){if(t=this.start(t),!!!(typeof window<"u"&&typeof navigator<"u"&&window.document))fetch(t,{mode:"cors"}).then(l=>l.ok?l.blob():(this.error(i,t,`Couldn't load image: ${t}`),null)).then(l=>l?createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null).then(l=>{l&&this.success(e,t,this.textureLoader(l))});else{let l=new Image;l.crossOrigin="anonymous",l.onload=()=>{this.success(e,t,this.textureLoader(l))},l.onerror=()=>{this.error(i,t,`Couldn't load image: ${t}`)},this.downloader.rawDataUris[t]&&(t=this.downloader.rawDataUris[t]),l.src=t}}loadTextureAtlas(t,e=()=>{},i=()=>{},s){let a=t.lastIndexOf("/"),l=a>=0?t.substring(0,a+1):"";t=this.start(t),this.downloader.downloadText(t,n=>{try{let h=new us(n),r=h.pages.length,o=!1;for(let d of h.pages)this.loadTexture(s?s[d.name]:l+d.name,(u,f)=>{o||(d.setTexture(f),--r==0&&this.success(e,t,h))},(u,f)=>{o||this.error(i,t,`Couldn't load texture atlas ${t} page image: ${u}`),o=!0})}catch(h){this.error(i,t,`Couldn't parse texture atlas ${t}: ${h.message}`)}},(n,h)=>{this.error(i,t,`Couldn't load texture atlas ${t}: status ${n}, ${h}`)})}get(t){return this.assets[this.pathPrefix+t]}require(t){t=this.pathPrefix+t;let e=this.assets[t];if(e)return e;let i=this.errors[t];throw Error("Asset not found: "+t+(i?`
`+i:""))}remove(t){t=this.pathPrefix+t;let e=this.assets[t];return e.dispose&&e.dispose(),delete this.assets[t],e}removeAll(){for(let t in this.assets){let e=this.assets[t];e.dispose&&e.dispose()}this.assets={}}isLoadingComplete(){return this.toLoad==0}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}}class Si{constructor(){c(this,"callbacks",{});c(this,"rawDataUris",{})}dataUriToString(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");return e!=-1?(e+=7,atob(t.substr(e))):t.substr(t.indexOf(",")+1)}base64ToUint8Array(t){for(var e=window.atob(t),i=e.length,s=new Uint8Array(i),a=0;a<i;a++)s[a]=e.charCodeAt(a);return s}dataUriToUint8Array(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");if(e==-1)throw new Error("Not a binary data URI.");return e+=7,this.base64ToUint8Array(t.substr(e))}downloadText(t,e,i){if(this.start(t,e,i))return;if(this.rawDataUris[t]){try{let l=this.rawDataUris[t];this.finish(t,200,this.dataUriToString(l))}catch(l){this.finish(t,400,JSON.stringify(l))}return}let s=new XMLHttpRequest;s.overrideMimeType("text/html"),s.open("GET",t,!0);let a=()=>{this.finish(t,s.status,s.responseText)};s.onload=a,s.onerror=a,s.send()}downloadJson(t,e,i){this.downloadText(t,s=>{e(JSON.parse(s))},i)}downloadBinary(t,e,i){if(this.start(t,e,i))return;if(this.rawDataUris[t]){try{let l=this.rawDataUris[t];this.finish(t,200,this.dataUriToUint8Array(l))}catch(l){this.finish(t,400,JSON.stringify(l))}return}let s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer";let a=()=>{this.finish(t,s.status,s.response)};s.onload=()=>{s.status==200||s.status==0?this.finish(t,200,new Uint8Array(s.response)):a()},s.onerror=a,s.send()}start(t,e,i){let s=this.callbacks[t];try{if(s)return!0;this.callbacks[t]=s=[]}finally{s.push(e,i)}}finish(t,e,i){let s=this.callbacks[t];delete this.callbacks[t];let a=e==200||e==0?[i]:[e,i];for(let l=a.length-1,n=s.length;l<n;l+=2)s[l].apply(null,a)}}class bs{constructor(t,e){c(this,"data");c(this,"intValue",0);c(this,"floatValue",0);c(this,"stringValue",null);c(this,"time",0);c(this,"volume",0);c(this,"balance",0);if(!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class ws{constructor(t){c(this,"name");c(this,"intValue",0);c(this,"floatValue",0);c(this,"stringValue",null);c(this,"audioPath",null);c(this,"volume",0);c(this,"balance",0);this.name=t}}class vs{constructor(t,e){c(this,"data");c(this,"bones");c(this,"target");c(this,"bendDirection",0);c(this,"compress",!1);c(this,"stretch",!1);c(this,"mix",1);c(this,"softness",0);c(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let a=e.findBone(t.bones[s].name);if(!a)throw new Error(`Couldn't find bone ${t.bones[s].name}`);this.bones.push(a)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=i}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}update(t){if(this.mix==0)return;let e=this.target,i=this.bones;switch(i.length){case 1:this.apply1(i[0],e.worldX,e.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(i[0],i[1],e.worldX,e.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,i,s,a,l,n){let h=t.parent;if(!h)throw new Error("IK bone must have parent.");let r=h.a,o=h.b,d=h.c,u=h.d,f=-t.ashearX-t.arotation,m=0,g=0;switch(t.inherit){case pt.OnlyTranslation:m=(e-t.worldX)*P.signum(t.skeleton.scaleX),g=(i-t.worldY)*P.signum(t.skeleton.scaleY);break;case pt.NoRotationOrReflection:let y=Math.abs(r*u-o*d)/Math.max(1e-4,r*r+d*d),w=r/t.skeleton.scaleX,b=d/t.skeleton.scaleY;o=-b*y*t.skeleton.scaleX,u=w*y*t.skeleton.scaleY,f+=Math.atan2(b,w)*P.radDeg;default:let C=e-h.worldX,v=i-h.worldY,E=r*u-o*d;Math.abs(E)<=1e-4?(m=0,g=0):(m=(C*u-v*o)/E-t.ax,g=(v*r-C*d)/E-t.ay)}f+=Math.atan2(g,m)*P.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let x=t.ascaleX,p=t.ascaleY;if(s||a){switch(t.inherit){case pt.NoScale:case pt.NoScaleOrReflection:m=e-t.worldX,g=i-t.worldY}const y=t.data.length*x;if(y>1e-4){const w=m*m+g*g;if(s&&w<y*y||a&&w>y*y){const b=(Math.sqrt(w)/y-1)*n+1;x*=b,l&&(p*=b)}}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*n,x,p,t.ashearX,t.ashearY)}apply2(t,e,i,s,a,l,n,h,r){if(t.inherit!=pt.Normal||e.inherit!=pt.Normal)return;let o=t.ax,d=t.ay,u=t.ascaleX,f=t.ascaleY,m=u,g=f,x=e.ascaleX,p=0,y=0,w=0;u<0?(u=-u,p=180,w=-1):(p=0,w=1),f<0&&(f=-f,w=-w),x<0?(x=-x,y=180):y=0;let b=e.ax,C=0,v=0,E=0,M=t.a,T=t.b,R=t.c,X=t.d,V=Math.abs(u-f)<=1e-4;!V||l?(C=0,v=M*b+t.worldX,E=R*b+t.worldY):(C=e.ay,v=M*b+T*C+t.worldX,E=R*b+X*C+t.worldY);let D=t.parent;if(!D)throw new Error("IK parent must itself have a parent.");M=D.a,T=D.b,R=D.c,X=D.d;let F=M*X-T*R,I=v-D.worldX,Y=E-D.worldY;F=Math.abs(F)<=1e-4?0:1/F;let et=(I*X-Y*T)*F-o,lt=(Y*M-I*R)*F-d,at=Math.sqrt(et*et+lt*lt),ft=e.data.length*x,mt,ut;if(at<1e-4){this.apply1(t,i,s,!1,l,!1,r),e.updateWorldTransformWith(b,C,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}I=i-D.worldX,Y=s-D.worldY;let rt=(I*X-Y*T)*F-o,it=(Y*M-I*R)*F-d,dt=rt*rt+it*it;if(h!=0){h*=u*(x+1)*.5;let bt=Math.sqrt(dt),Lt=bt-at-ft*u+h;if(Lt>0){let Rt=Math.min(1,Lt/(h*2))-1;Rt=(Lt-h*(1-Rt*Rt))/bt,rt-=Rt*rt,it-=Rt*it,dt=rt*rt+it*it}}t:if(V){ft*=u;let bt=(dt-at*at-ft*ft)/(2*at*ft);bt<-1?(bt=-1,ut=Math.PI*a):bt>1?(bt=1,ut=0,l&&(M=(Math.sqrt(dt)/(at+ft)-1)*r+1,m*=M,n&&(g*=M))):ut=Math.acos(bt)*a,M=at+ft*bt,T=ft*Math.sin(ut),mt=Math.atan2(it*M-rt*T,rt*M+it*T)}else{M=u*ft,T=f*ft;let bt=M*M,Lt=T*T,Rt=Math.atan2(it,rt);R=Lt*at*at+bt*dt-bt*Lt;let qt=-2*Lt*at,Qt=Lt-bt;if(X=qt*qt-4*Qt*R,X>=0){let Zt=Math.sqrt(X);qt<0&&(Zt=-Zt),Zt=-(qt+Zt)*.5;let li=Zt/Qt,oi=R/Zt,te=Math.abs(li)<Math.abs(oi)?li:oi;if(te*te<=dt){Y=Math.sqrt(dt-te*te)*a,mt=Rt-Math.atan2(Y,te),ut=Math.atan2(Y/f,(te-at)/u);break t}}let ue=P.PI,ve=at-M,Oe=ve*ve,ni=0,ri=0,ye=at+M,Be=ye*ye,ai=0;R=-M*at/(bt-Lt),R>=-1&&R<=1&&(R=Math.acos(R),I=M*Math.cos(R)+at,Y=T*Math.sin(R),X=I*I+Y*Y,X<Oe&&(ue=R,Oe=X,ve=I,ni=Y),X>Be&&(ri=R,Be=X,ye=I,ai=Y)),dt<=(Oe+Be)*.5?(mt=Rt-Math.atan2(ni*a,ve),ut=ue*a):(mt=Rt-Math.atan2(ai*a,ye),ut=ri*a)}let vt=Math.atan2(C,b)*w,Pt=t.arotation;mt=(mt-vt)*P.radDeg+p-Pt,mt>180?mt-=360:mt<-180&&(mt+=360),t.updateWorldTransformWith(o,d,Pt+mt*r,m,g,0,0),Pt=e.arotation,ut=((ut+vt)*P.radDeg-e.ashearX)*w+y-Pt,ut>180?ut-=360:ut<-180&&(ut+=360),e.updateWorldTransformWith(b,C,Pt+ut*r,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class ys extends Ve{constructor(e){super(e,0,!1);c(this,"bones",new Array);c(this,"_target",null);c(this,"bendDirection",0);c(this,"compress",!1);c(this,"stretch",!1);c(this,"uniform",!1);c(this,"mix",0);c(this,"softness",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class As extends Ve{constructor(e){super(e,0,!1);c(this,"bones",new Array);c(this,"_target",null);c(this,"positionMode",Gt.Fixed);c(this,"spacingMode",Et.Fixed);c(this,"rotateMode",jt.Chain);c(this,"offsetRotation",0);c(this,"position",0);c(this,"spacing",0);c(this,"mixRotate",0);c(this,"mixX",0);c(this,"mixY",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Gt;(function(A){A[A.Fixed=0]="Fixed",A[A.Percent=1]="Percent"})(Gt||(Gt={}));var Et;(function(A){A[A.Length=0]="Length",A[A.Fixed=1]="Fixed",A[A.Percent=2]="Percent",A[A.Proportional=3]="Proportional"})(Et||(Et={}));var jt;(function(A){A[A.Tangent=0]="Tangent",A[A.Chain=1]="Chain",A[A.ChainScale=2]="ChainScale"})(jt||(jt={}));const It=class It{constructor(t,e){c(this,"data");c(this,"bones");c(this,"target");c(this,"position",0);c(this,"spacing",0);c(this,"mixRotate",0);c(this,"mixX",0);c(this,"mixY",0);c(this,"spaces",new Array);c(this,"positions",new Array);c(this,"world",new Array);c(this,"curves",new Array);c(this,"lengths",new Array);c(this,"segments",new Array);c(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,a=t.bones.length;s<a;s++){let l=e.findBone(t.bones[s].name);if(!l)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(l)}let i=e.findSlot(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=i,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}update(t){let e=this.target.getAttachment();if(!(e instanceof Jt))return;let i=this.mixRotate,s=this.mixX,a=this.mixY;if(i==0&&s==0&&a==0)return;let l=this.data,n=l.rotateMode==jt.Tangent,h=l.rotateMode==jt.ChainScale,r=this.bones,o=r.length,d=n?o:o+1,u=O.setArraySize(this.spaces,d),f=h?this.lengths=O.setArraySize(this.lengths,o):[],m=this.spacing;switch(l.spacingMode){case Et.Percent:if(h)for(let v=0,E=d-1;v<E;v++){let M=r[v],T=M.data.length,R=T*M.a,X=T*M.c;f[v]=Math.sqrt(R*R+X*X)}O.arrayFill(u,1,d,m);break;case Et.Proportional:let b=0;for(let v=0,E=d-1;v<E;){let M=r[v],T=M.data.length;if(T<It.epsilon)h&&(f[v]=0),u[++v]=m;else{let R=T*M.a,X=T*M.c,V=Math.sqrt(R*R+X*X);h&&(f[v]=V),u[++v]=V,b+=V}}if(b>0){b=d/b*m;for(let v=1;v<d;v++)u[v]*=b}break;default:let C=l.spacingMode==Et.Length;for(let v=0,E=d-1;v<E;){let M=r[v],T=M.data.length;if(T<It.epsilon)h&&(f[v]=0),u[++v]=m;else{let R=T*M.a,X=T*M.c,V=Math.sqrt(R*R+X*X);h&&(f[v]=V),u[++v]=(C?T+m:m)*V/T}}}let g=this.computeWorldPositions(e,d,n),x=g[0],p=g[1],y=l.offsetRotation,w=!1;if(y==0)w=l.rotateMode==jt.Chain;else{w=!1;let b=this.target.bone;y*=b.a*b.d-b.b*b.c>0?P.degRad:-P.degRad}for(let b=0,C=3;b<o;b++,C+=3){let v=r[b];v.worldX+=(x-v.worldX)*s,v.worldY+=(p-v.worldY)*a;let E=g[C],M=g[C+1],T=E-x,R=M-p;if(h){let X=f[b];if(X!=0){let V=(Math.sqrt(T*T+R*R)/X-1)*i+1;v.a*=V,v.c*=V}}if(x=E,p=M,i>0){let X=v.a,V=v.b,D=v.c,F=v.d,I=0,Y=0,et=0;if(n?I=g[C-1]:u[b+1]==0?I=g[C+2]:I=Math.atan2(R,T),I-=Math.atan2(D,X),w){Y=Math.cos(I),et=Math.sin(I);let lt=v.data.length;x+=(lt*(Y*X-et*D)-T)*i,p+=(lt*(et*X+Y*D)-R)*i}else I+=y;I>P.PI?I-=P.PI2:I<-P.PI&&(I+=P.PI2),I*=i,Y=Math.cos(I),et=Math.sin(I),v.a=Y*X-et*D,v.b=Y*V-et*F,v.c=et*X+Y*D,v.d=et*V+Y*F}v.updateAppliedTransform()}}computeWorldPositions(t,e,i){let s=this.target,a=this.position,l=this.spaces,n=O.setArraySize(this.positions,e*3+2),h=this.world,r=t.closed,o=t.worldVerticesLength,d=o/6,u=It.NONE;if(!t.constantSpeed){let lt=t.lengths;d-=r?1:2;let at=lt[d];this.data.positionMode==Gt.Percent&&(a*=at);let ft;switch(this.data.spacingMode){case Et.Percent:ft=at;break;case Et.Proportional:ft=at/e;break;default:ft=1}h=O.setArraySize(this.world,8);for(let mt=0,ut=0,rt=0;mt<e;mt++,ut+=3){let it=l[mt]*ft;a+=it;let dt=a;if(r)dt%=at,dt<0&&(dt+=at),rt=0;else if(dt<0){u!=It.BEFORE&&(u=It.BEFORE,t.computeWorldVertices(s,2,4,h,0,2)),this.addBeforePosition(dt,h,0,n,ut);continue}else if(dt>at){u!=It.AFTER&&(u=It.AFTER,t.computeWorldVertices(s,o-6,4,h,0,2)),this.addAfterPosition(dt-at,h,0,n,ut);continue}for(;;rt++){let vt=lt[rt];if(!(dt>vt)){if(rt==0)dt/=vt;else{let Pt=lt[rt-1];dt=(dt-Pt)/(vt-Pt)}break}}rt!=u&&(u=rt,r&&rt==d?(t.computeWorldVertices(s,o-4,4,h,0,2),t.computeWorldVertices(s,0,4,h,4,2)):t.computeWorldVertices(s,rt*6+2,8,h,0,2)),this.addCurvePosition(dt,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],n,ut,i||mt>0&&it==0)}return n}r?(o+=2,h=O.setArraySize(this.world,o),t.computeWorldVertices(s,2,o-4,h,0,2),t.computeWorldVertices(s,0,2,h,o-4,2),h[o-2]=h[0],h[o-1]=h[1]):(d--,o-=4,h=O.setArraySize(this.world,o),t.computeWorldVertices(s,2,o,h,0,2));let f=O.setArraySize(this.curves,d),m=0,g=h[0],x=h[1],p=0,y=0,w=0,b=0,C=0,v=0,E=0,M=0,T=0,R=0,X=0,V=0,D=0,F=0;for(let lt=0,at=2;lt<d;lt++,at+=6)p=h[at],y=h[at+1],w=h[at+2],b=h[at+3],C=h[at+4],v=h[at+5],E=(g-p*2+w)*.1875,M=(x-y*2+b)*.1875,T=((p-w)*3-g+C)*.09375,R=((y-b)*3-x+v)*.09375,X=E*2+T,V=M*2+R,D=(p-g)*.75+E+T*.16666667,F=(y-x)*.75+M+R*.16666667,m+=Math.sqrt(D*D+F*F),D+=X,F+=V,X+=T,V+=R,m+=Math.sqrt(D*D+F*F),D+=X,F+=V,m+=Math.sqrt(D*D+F*F),D+=X+T,F+=V+R,m+=Math.sqrt(D*D+F*F),f[lt]=m,g=C,x=v;this.data.positionMode==Gt.Percent&&(a*=m);let I;switch(this.data.spacingMode){case Et.Percent:I=m;break;case Et.Proportional:I=m/e;break;default:I=1}let Y=this.segments,et=0;for(let lt=0,at=0,ft=0,mt=0;lt<e;lt++,at+=3){let ut=l[lt]*I;a+=ut;let rt=a;if(r)rt%=m,rt<0&&(rt+=m),ft=0;else if(rt<0){this.addBeforePosition(rt,h,0,n,at);continue}else if(rt>m){this.addAfterPosition(rt-m,h,o-4,n,at);continue}for(;;ft++){let it=f[ft];if(!(rt>it)){if(ft==0)rt/=it;else{let dt=f[ft-1];rt=(rt-dt)/(it-dt)}break}}if(ft!=u){u=ft;let it=ft*6;for(g=h[it],x=h[it+1],p=h[it+2],y=h[it+3],w=h[it+4],b=h[it+5],C=h[it+6],v=h[it+7],E=(g-p*2+w)*.03,M=(x-y*2+b)*.03,T=((p-w)*3-g+C)*.006,R=((y-b)*3-x+v)*.006,X=E*2+T,V=M*2+R,D=(p-g)*.3+E+T*.16666667,F=(y-x)*.3+M+R*.16666667,et=Math.sqrt(D*D+F*F),Y[0]=et,it=1;it<8;it++)D+=X,F+=V,X+=T,V+=R,et+=Math.sqrt(D*D+F*F),Y[it]=et;D+=X,F+=V,et+=Math.sqrt(D*D+F*F),Y[8]=et,D+=X+T,F+=V+R,et+=Math.sqrt(D*D+F*F),Y[9]=et,mt=0}for(rt*=et;;mt++){let it=Y[mt];if(!(rt>it)){if(mt==0)rt/=it;else{let dt=Y[mt-1];rt=mt+(rt-dt)/(it-dt)}break}}this.addCurvePosition(rt*.1,g,x,p,y,w,b,C,v,n,at,i||lt>0&&ut==0)}return n}addBeforePosition(t,e,i,s,a){let l=e[i],n=e[i+1],h=e[i+2]-l,r=e[i+3]-n,o=Math.atan2(r,h);s[a]=l+t*Math.cos(o),s[a+1]=n+t*Math.sin(o),s[a+2]=o}addAfterPosition(t,e,i,s,a){let l=e[i+2],n=e[i+3],h=l-e[i],r=n-e[i+1],o=Math.atan2(r,h);s[a]=l+t*Math.cos(o),s[a+1]=n+t*Math.sin(o),s[a+2]=o}addCurvePosition(t,e,i,s,a,l,n,h,r,o,d,u){if(t==0||isNaN(t)){o[d]=e,o[d+1]=i,o[d+2]=Math.atan2(a-i,s-e);return}let f=t*t,m=f*t,g=1-t,x=g*g,p=x*g,y=g*t,w=y*3,b=g*w,C=w*t,v=e*p+s*b+l*C+h*m,E=i*p+a*b+n*C+r*m;o[d]=v,o[d+1]=E,u&&(t<.001?o[d+2]=Math.atan2(a-i,s-e):o[d+2]=Math.atan2(E-(i*x+a*y*2+n*f),v-(e*x+s*y*2+l*f)))}};c(It,"NONE",-1),c(It,"BEFORE",-2),c(It,"AFTER",-3),c(It,"epsilon",1e-5);let He=It;class Cs{constructor(t,e){c(this,"data");c(this,"_bone",null);c(this,"inertia",0);c(this,"strength",0);c(this,"damping",0);c(this,"massInverse",0);c(this,"wind",0);c(this,"gravity",0);c(this,"mix",0);c(this,"_reset",!0);c(this,"ux",0);c(this,"uy",0);c(this,"cx",0);c(this,"cy",0);c(this,"tx",0);c(this,"ty",0);c(this,"xOffset",0);c(this,"xVelocity",0);c(this,"yOffset",0);c(this,"yVelocity",0);c(this,"rotateOffset",0);c(this,"rotateVelocity",0);c(this,"scaleOffset",0);c(this,"scaleVelocity",0);c(this,"active",!1);c(this,"skeleton");c(this,"remaining",0);c(this,"lastTime",0);this.data=t,this.skeleton=e,this.bone=e.bones[t.bone.index],this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const t=this.data;this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}isActive(){return this.active}update(t){const e=this.mix;if(e==0)return;const i=this.data.x>0,s=this.data.y>0,a=this.data.rotate>0||this.data.shearX>0,l=this.data.scaleX>0,n=this.bone,h=n.data.length;switch(t){case _t.none:return;case _t.reset:this.reset();case _t.update:const r=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=r,this.lastTime=this.skeleton.time;const o=n.worldX,d=n.worldY;if(this._reset)this._reset=!1,this.ux=o,this.uy=d;else{let u=this.remaining,f=this.inertia,m=this.data.limit*r,g=this.data.step,x=this.skeleton.data.referenceScale,p=-1;if(i||s){if(i){const y=(this.ux-o)*f;this.xOffset+=y>m?m:y<-m?-m:y,this.ux=o}if(s){const y=(this.uy-d)*f;this.yOffset+=y>m?m:y<-m?-m:y,this.uy=d}if(u>=g){p=Math.pow(this.damping,60*g);const y=this.massInverse*g,w=this.strength,b=this.wind*x,C=(zt.yDown?-this.gravity:this.gravity)*x;do i&&(this.xVelocity+=(b-this.xOffset*w)*y,this.xOffset+=this.xVelocity*g,this.xVelocity*=p),s&&(this.yVelocity-=(C+this.yOffset*w)*y,this.yOffset+=this.yVelocity*g,this.yVelocity*=p),u-=g;while(u>=g)}i&&(n.worldX+=this.xOffset*e*this.data.x),s&&(n.worldY+=this.yOffset*e*this.data.y)}if(a||l){let y=Math.atan2(n.c,n.a),w=0,b=0,C=0,v=this.cx-n.worldX,E=this.cy-n.worldY;if(v>m?v=m:v<-m&&(v=-m),E>m?E=m:E<-m&&(E=-m),a){C=(this.data.rotate+this.data.shearX)*e;let M=Math.atan2(E+this.ty,v+this.tx)-y-this.rotateOffset*C;this.rotateOffset+=(M-Math.ceil(M*P.invPI2-.5)*P.PI2)*f,M=this.rotateOffset*C+y,w=Math.cos(M),b=Math.sin(M),l&&(M=h*n.getWorldScaleX(),M>0&&(this.scaleOffset+=(v*w+E*b)*f/M))}else{w=Math.cos(y),b=Math.sin(y);const M=h*n.getWorldScaleX();M>0&&(this.scaleOffset+=(v*w+E*b)*f/M)}if(u=this.remaining,u>=g){p==-1&&(p=Math.pow(this.damping,60*g));const M=this.massInverse*g,T=this.strength,R=this.wind,X=zt.yDown?-this.gravity:this.gravity,V=h/x;for(;;)if(u-=g,l&&(this.scaleVelocity+=(R*w-X*b-this.scaleOffset*T)*M,this.scaleOffset+=this.scaleVelocity*g,this.scaleVelocity*=p),a){if(this.rotateVelocity-=((R*b+X*w)*V+this.rotateOffset*T)*M,this.rotateOffset+=this.rotateVelocity*g,this.rotateVelocity*=p,u<g)break;const D=this.rotateOffset*C+y;w=Math.cos(D),b=Math.sin(D)}else if(u<g)break}}this.remaining=u}this.cx=n.worldX,this.cy=n.worldY;break;case _t.pose:i&&(n.worldX+=this.xOffset*e*this.data.x),s&&(n.worldY+=this.yOffset*e*this.data.y)}if(a){let r=this.rotateOffset*e,o=0,d=0,u=0;if(this.data.shearX>0){let f=0;this.data.rotate>0&&(f=r*this.data.rotate,o=Math.sin(f),d=Math.cos(f),u=n.b,n.b=d*u-o*n.d,n.d=o*u+d*n.d),f+=r*this.data.shearX,o=Math.sin(f),d=Math.cos(f),u=n.a,n.a=d*u-o*n.c,n.c=o*u+d*n.c}else r*=this.data.rotate,o=Math.sin(r),d=Math.cos(r),u=n.a,n.a=d*u-o*n.c,n.c=o*u+d*n.c,u=n.b,n.b=d*u-o*n.d,n.d=o*u+d*n.d}if(l){const r=1+this.scaleOffset*e*this.data.scaleX;n.a*=r,n.c*=r}t!=_t.pose&&(this.tx=h*n.a,this.ty=h*n.c),n.updateAppliedTransform()}translate(t,e){this.ux-=t,this.uy-=e,this.cx-=t,this.cy-=e}rotate(t,e,i){const s=i*P.degRad,a=Math.cos(s),l=Math.sin(s),n=this.cx-t,h=this.cy-e;this.translate(n*a-h*l-n,n*l+h*a-h)}}class Es{constructor(t,e){c(this,"data");c(this,"bone");c(this,"color");c(this,"darkColor",null);c(this,"attachment",null);c(this,"attachmentState",0);c(this,"sequenceIndex",-1);c(this,"deform",new Array);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new st,this.darkColor=t.darkColor?new st:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof Ot)||!(this.attachment instanceof Ot)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Ss{constructor(t,e){c(this,"data");c(this,"bones");c(this,"target");c(this,"mixRotate",0);c(this,"mixX",0);c(this,"mixY",0);c(this,"mixScaleX",0);c(this,"mixScaleY",0);c(this,"mixShearY",0);c(this,"temp",new oe);c(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let a=e.findBone(t.bones[s].name);if(!a)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(a)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=i}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}update(t){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleY==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,a=this.mixScaleY,l=this.mixShearY,n=e!=0||i!=0,h=this.target,r=h.a,o=h.b,d=h.c,u=h.d,f=r*u-o*d>0?P.degRad:-P.degRad,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,x=this.bones;for(let p=0,y=x.length;p<y;p++){let w=x[p];if(t!=0){let b=w.a,C=w.b,v=w.c,E=w.d,M=Math.atan2(d,r)-Math.atan2(v,b)+m;M>P.PI?M-=P.PI2:M<-P.PI&&(M+=P.PI2),M*=t;let T=Math.cos(M),R=Math.sin(M);w.a=T*b-R*v,w.b=T*C-R*E,w.c=R*b+T*v,w.d=R*C+T*E}if(n){let b=this.temp;h.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),w.worldX+=(b.x-w.worldX)*e,w.worldY+=(b.y-w.worldY)*i}if(s!=0){let b=Math.sqrt(w.a*w.a+w.c*w.c);b!=0&&(b=(b+(Math.sqrt(r*r+d*d)-b+this.data.offsetScaleX)*s)/b),w.a*=b,w.c*=b}if(a!=0){let b=Math.sqrt(w.b*w.b+w.d*w.d);b!=0&&(b=(b+(Math.sqrt(o*o+u*u)-b+this.data.offsetScaleY)*a)/b),w.b*=b,w.d*=b}if(l>0){let b=w.b,C=w.d,v=Math.atan2(C,b),E=Math.atan2(u,o)-Math.atan2(d,r)-(v-Math.atan2(w.c,w.a));E>P.PI?E-=P.PI2:E<-P.PI&&(E+=P.PI2),E=v+(E+g)*l;let M=Math.sqrt(b*b+C*C);w.b=Math.cos(E)*M,w.d=Math.sin(E)*M}w.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,a=this.mixScaleY,l=this.mixShearY,n=e!=0||i!=0,h=this.target,r=h.a,o=h.b,d=h.c,u=h.d,f=r*u-o*d>0?P.degRad:-P.degRad,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,x=this.bones;for(let p=0,y=x.length;p<y;p++){let w=x[p];if(t!=0){let b=w.a,C=w.b,v=w.c,E=w.d,M=Math.atan2(d,r)+m;M>P.PI?M-=P.PI2:M<-P.PI&&(M+=P.PI2),M*=t;let T=Math.cos(M),R=Math.sin(M);w.a=T*b-R*v,w.b=T*C-R*E,w.c=R*b+T*v,w.d=R*C+T*E}if(n){let b=this.temp;h.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),w.worldX+=b.x*e,w.worldY+=b.y*i}if(s!=0){let b=(Math.sqrt(r*r+d*d)-1+this.data.offsetScaleX)*s+1;w.a*=b,w.c*=b}if(a!=0){let b=(Math.sqrt(o*o+u*u)-1+this.data.offsetScaleY)*a+1;w.b*=b,w.d*=b}if(l>0){let b=Math.atan2(u,o)-Math.atan2(d,r);b>P.PI?b-=P.PI2:b<-P.PI&&(b+=P.PI2);let C=w.b,v=w.d;b=Math.atan2(v,C)+(b-P.PI/2+g)*l;let E=Math.sqrt(C*C+v*v);w.b=Math.cos(b)*E,w.d=Math.sin(b)*E}w.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,a=this.mixScaleY,l=this.mixShearY,n=this.target,h=this.bones;for(let r=0,o=h.length;r<o;r++){let d=h[r],u=d.arotation;t!=0&&(u+=(n.arotation-u+this.data.offsetRotation)*t);let f=d.ax,m=d.ay;f+=(n.ax-f+this.data.offsetX)*e,m+=(n.ay-m+this.data.offsetY)*i;let g=d.ascaleX,x=d.ascaleY;s!=0&&g!=0&&(g=(g+(n.ascaleX-g+this.data.offsetScaleX)*s)/g),a!=0&&x!=0&&(x=(x+(n.ascaleY-x+this.data.offsetScaleY)*a)/x);let p=d.ashearY;l!=0&&(p+=(n.ashearY-p+this.data.offsetShearY)*l),d.updateWorldTransformWith(f,m,u,g,x,d.ashearX,p)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,a=this.mixScaleY,l=this.mixShearY,n=this.target,h=this.bones;for(let r=0,o=h.length;r<o;r++){let d=h[r],u=d.arotation+(n.arotation+this.data.offsetRotation)*t,f=d.ax+(n.ax+this.data.offsetX)*e,m=d.ay+(n.ay+this.data.offsetY)*i,g=d.ascaleX*((n.ascaleX-1+this.data.offsetScaleX)*s+1),x=d.ascaleY*((n.ascaleY-1+this.data.offsetScaleY)*a+1),p=d.ashearY+(n.ashearY+this.data.offsetShearY)*l;d.updateWorldTransformWith(f,m,u,g,x,d.ashearX,p)}}}const Xe=class Xe{constructor(t){c(this,"data");c(this,"bones");c(this,"slots");c(this,"drawOrder");c(this,"ikConstraints");c(this,"transformConstraints");c(this,"pathConstraints");c(this,"physicsConstraints");c(this,"_updateCache",new Array);c(this,"skin",null);c(this,"color");c(this,"scaleX",1);c(this,"_scaleY",1);c(this,"x",0);c(this,"y",0);c(this,"time",0);if(!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let i=t.bones[e],s;if(!i.parent)s=new ui(i,this,null);else{let a=this.bones[i.parent.index];s=new ui(i,this,a),a.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let i=t.slots[e],s=this.bones[i.boneData.index],a=new Es(i,s);this.slots.push(a),this.drawOrder.push(a)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let i=t.ikConstraints[e];this.ikConstraints.push(new vs(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let i=t.transformConstraints[e];this.transformConstraints.push(new Ss(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let i=t.pathConstraints[e];this.pathConstraints.push(new He(i,this))}this.physicsConstraints=new Array;for(let e=0;e<t.physicsConstraints.length;e++){let i=t.physicsConstraints[e];this.physicsConstraints.push(new Cs(i,this))}this.color=new st(1,1,1,1),this.updateCache()}get scaleY(){return Xe.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}updateCache(){let t=this._updateCache;t.length=0;let e=this.bones;for(let u=0,f=e.length;u<f;u++){let m=e[u];m.sorted=m.data.skinRequired,m.active=!m.sorted}if(this.skin){let u=this.skin.bones;for(let f=0,m=this.skin.bones.length;f<m;f++){let g=this.bones[u[f].index];do g.sorted=!1,g.active=!0,g=g.parent;while(g)}}let i=this.ikConstraints,s=this.transformConstraints,a=this.pathConstraints,l=this.physicsConstraints,n=i.length,h=s.length,r=a.length,o=this.physicsConstraints.length,d=n+h+r+o;t:for(let u=0;u<d;u++){for(let f=0;f<n;f++){let m=i[f];if(m.data.order==u){this.sortIkConstraint(m);continue t}}for(let f=0;f<h;f++){let m=s[f];if(m.data.order==u){this.sortTransformConstraint(m);continue t}}for(let f=0;f<r;f++){let m=a[f];if(m.data.order==u){this.sortPathConstraint(m);continue t}}for(let f=0;f<o;f++){const m=l[f];if(m.data.order==u){this.sortPhysicsConstraint(m);continue t}}}for(let u=0,f=e.length;u<f;u++)this.sortBone(e[u])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&O.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let i=t.bones,s=i[0];if(this.sortBone(s),i.length==1)this._updateCache.push(t),this.sortReset(s.children);else{let a=i[i.length-1];this.sortBone(a),this._updateCache.push(t),this.sortReset(s.children),a.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&O.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,i=e.data.index,s=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,i,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,s);for(let h=0,r=this.data.skins.length;h<r;h++)this.sortPathConstraintAttachment(this.data.skins[h],i,s);let a=e.getAttachment();a instanceof Jt&&this.sortPathConstraintAttachmentWith(a,s);let l=t.bones,n=l.length;for(let h=0;h<n;h++)this.sortBone(l[h]);this._updateCache.push(t);for(let h=0;h<n;h++)this.sortReset(l[h].children);for(let h=0;h<n;h++)l[h].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&O.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,i=e.length;if(t.data.local)for(let s=0;s<i;s++){let a=e[s];this.sortBone(a.parent),this.sortBone(a)}else for(let s=0;s<i;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<i;s++)this.sortReset(e[s].children);for(let s=0;s<i;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,i){let s=t.attachments[e];if(s)for(let a in s)this.sortPathConstraintAttachmentWith(s[a],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Jt))return;let i=t.bones;if(!i)this.sortBone(e);else{let s=this.bones;for(let a=0,l=i.length;a<l;){let n=i[a++];for(n+=a;a<n;)this.sortBone(s[i[a++]])}}}sortPhysicsConstraint(t){const e=t.bone;t.active=e.active&&(!t.data.skinRequired||this.skin!=null&&O.contains(this.skin.constraints,t.data,!0)),t.active&&(this.sortBone(e),this._updateCache.push(t),this.sortReset(e.children),e.sorted=!0)}sortBone(t){if(!t||t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){let s=t[e];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(t){if(!t)throw new Error("physics is undefined");let e=this.bones;for(let s=0,a=e.length;s<a;s++){let l=e[s];l.ax=l.x,l.ay=l.y,l.arotation=l.rotation,l.ascaleX=l.scaleX,l.ascaleY=l.scaleY,l.ashearX=l.shearX,l.ashearY=l.shearY}let i=this._updateCache;for(let s=0,a=i.length;s<a;s++)i[s].update(t)}updateWorldTransformWith(t,e){let i=this.getRootBone();if(!i)throw new Error("Root bone must not be null.");let s=e.a,a=e.b,l=e.c,n=e.d;i.worldX=s*this.x+a*this.y+e.worldX,i.worldY=l*this.x+n*this.y+e.worldY;const h=(i.rotation+i.shearX)*P.degRad,r=(i.rotation+90+i.shearY)*P.degRad,o=Math.cos(h)*i.scaleX,d=Math.cos(r)*i.scaleY,u=Math.sin(h)*i.scaleX,f=Math.sin(r)*i.scaleY;i.a=(s*o+a*u)*this.scaleX,i.b=(s*d+a*f)*this.scaleX,i.c=(l*o+n*u)*this.scaleY,i.d=(l*d+n*f)*this.scaleY;let m=this._updateCache;for(let g=0,x=m.length;g<x;g++){let p=m[g];p!=i&&p.update(t)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const t of this.bones)t.setToSetupPose();for(const t of this.ikConstraints)t.setToSetupPose();for(const t of this.transformConstraints)t.setToSetupPose();for(const t of this.pathConstraints)t.setToSetupPose();for(const t of this.physicsConstraints)t.setToSetupPose()}setSlotsToSetupPose(){let t=this.slots;O.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.data.name==t)return a}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.data.name==t)return a}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let i=0,s=e.length;i<s;i++){let a=e[i],l=a.data.attachmentName;if(l){let n=t.getAttachment(i,l);n&&a.setAttachment(n)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let i=this.data.findSlot(t);if(!i)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(i.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let i=this.slots;for(let s=0,a=i.length;s<a;s++){let l=i[s];if(l.data.name==t){let n=null;if(e&&(n=this.getAttachment(s,e),!n))throw new Error("Attachment not found: "+e+", for slot: "+t);l.setAttachment(n);return}}throw new Error("Slot not found: "+t)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.ikConstraints.find(e=>e.data.name==t)??null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.transformConstraints.find(e=>e.data.name==t)??null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.pathConstraints.find(e=>e.data.name==t)??null}findPhysicsConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find(e=>e.data.name==t)??null}getBoundsRect(){let t=new oe,e=new oe;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,i=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");let s=this.drawOrder,a=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(let r=0,o=s.length;r<o;r++){let d=s[r];if(!d.bone.active)continue;let u=0,f=null,m=d.getAttachment();if(m instanceof ce)u=8,f=O.setArraySize(i,u,0),m.computeWorldVertices(d,f,0,2);else if(m instanceof Ht){let g=m;u=g.worldVerticesLength,f=O.setArraySize(i,u,0),g.computeWorldVertices(d,0,u,f,0,2)}if(f)for(let g=0,x=f.length;g<x;g+=2){let p=f[g],y=f[g+1];a=Math.min(a,p),l=Math.min(l,y),n=Math.max(n,p),h=Math.max(h,y)}}t.set(a,l),e.set(n-a,h-l)}update(t){this.time+=t}physicsTranslate(t,e){const i=this.physicsConstraints;for(let s=0,a=i.length;s<a;s++)i[s].translate(t,e)}physicsRotate(t,e,i){const s=this.physicsConstraints;for(let a=0,l=s.length;a<l;a++)s[a].rotate(t,e,i)}};c(Xe,"yDown",!1);let zt=Xe;var _t;(function(A){A[A.none=0]="none",A[A.reset=1]="reset",A[A.update=2]="update",A[A.pose=3]="pose"})(_t||(_t={}));class Ms extends Ve{constructor(e){super(e,0,!1);c(this,"_bone",null);c(this,"x",0);c(this,"y",0);c(this,"rotate",0);c(this,"scaleX",0);c(this,"shearX",0);c(this,"limit",0);c(this,"step",0);c(this,"inertia",0);c(this,"strength",0);c(this,"damping",0);c(this,"massInverse",0);c(this,"wind",0);c(this,"gravity",0);c(this,"mix",0);c(this,"inertiaGlobal",!1);c(this,"strengthGlobal",!1);c(this,"dampingGlobal",!1);c(this,"massGlobal",!1);c(this,"windGlobal",!1);c(this,"gravityGlobal",!1);c(this,"mixGlobal",!1)}set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class ks{constructor(){c(this,"name",null);c(this,"bones",new Array);c(this,"slots",new Array);c(this,"skins",new Array);c(this,"defaultSkin",null);c(this,"events",new Array);c(this,"animations",new Array);c(this,"ikConstraints",new Array);c(this,"transformConstraints",new Array);c(this,"pathConstraints",new Array);c(this,"physicsConstraints",new Array);c(this,"x",0);c(this,"y",0);c(this,"width",0);c(this,"height",0);c(this,"referenceScale",100);c(this,"version",null);c(this,"hash",null);c(this,"fps",0);c(this,"imagesPath",null);c(this,"audioPath",null)}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.name==t)return a}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.name==t)return a}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.name==t)return a}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.name==t)return a}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,s=e.length;i<s;i++){let a=e[i];if(a.name==t)return a}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,s=e.length;i<s;i++){const a=e[i];if(a.name==t)return a}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,s=e.length;i<s;i++){const a=e[i];if(a.name==t)return a}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++){const a=e[i];if(a.name==t)return a}return null}findPhysicsConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.physicsConstraints;for(let i=0,s=e.length;i<s;i++){const a=e[i];if(a.name==t)return a}return null}}class fi{constructor(t=0,e,i){c(this,"slotIndex");c(this,"name");c(this,"attachment");this.slotIndex=t,this.name=e,this.attachment=i}}class Ts{constructor(t){c(this,"name");c(this,"attachments",new Array);c(this,"bones",Array());c(this,"constraints",new Array);c(this,"color",new st(.99607843,.61960787,.30980393,1));if(!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(!i)throw new Error("attachment cannot be null.");let s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=i}addSkin(t){for(let s=0;s<t.bones.length;s++){let a=t.bones[s],l=!1;for(let n=0;n<this.bones.length;n++)if(this.bones[n]==a){l=!0;break}l||this.bones.push(a)}for(let s=0;s<t.constraints.length;s++){let a=t.constraints[s],l=!1;for(let n=0;n<this.constraints.length;n++)if(this.constraints[n]==a){l=!0;break}l||this.constraints.push(a)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){let a=t.bones[s],l=!1;for(let n=0;n<this.bones.length;n++)if(this.bones[n]==a){l=!0;break}l||this.bones.push(a)}for(let s=0;s<t.constraints.length;s++){let a=t.constraints[s],l=!1;for(let n=0;n<this.constraints.length;n++)if(this.constraints[n]==a){l=!0;break}l||this.constraints.push(a)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];i.attachment&&(i.attachment instanceof Ht?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&delete i[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let s in i){let a=i[s];a&&t.push(new fi(e,s,a))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let s in i){let a=i[s];a&&e.push(new fi(t,s,a))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let s=0;s<t.slots.length;s++){let a=t.slots[s],l=a.getAttachment();if(l&&i<e.attachments.length){let n=e.attachments[i];for(let h in n){let r=n[h];if(l==r){let o=this.getAttachment(i,h);o&&a.setAttachment(o);break}}}i++}}}class Ys{constructor(t,e,i){c(this,"index",0);c(this,"name");c(this,"boneData");c(this,"color",new st(1,1,1,1));c(this,"darkColor",null);c(this,"attachmentName",null);c(this,"blendMode",Me.Normal);c(this,"visible",!0);c(this,"path",null);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}var Me;(function(A){A[A.Normal=0]="Normal",A[A.Additive=1]="Additive",A[A.Multiply=2]="Multiply",A[A.Screen=3]="Screen"})(Me||(Me={}));class Is extends Ve{constructor(e){super(e,0,!1);c(this,"bones",new Array);c(this,"_target",null);c(this,"mixRotate",0);c(this,"mixX",0);c(this,"mixY",0);c(this,"mixScaleX",0);c(this,"mixScaleY",0);c(this,"mixShearY",0);c(this,"offsetRotation",0);c(this,"offsetX",0);c(this,"offsetY",0);c(this,"offsetScaleX",0);c(this,"offsetScaleY",0);c(this,"offsetShearY",0);c(this,"relative",!1);c(this,"local",!1)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}var mi;(function(A){A[A.Region=0]="Region",A[A.BoundingBox=1]="BoundingBox",A[A.Mesh=2]="Mesh",A[A.LinkedMesh=3]="LinkedMesh",A[A.Path=4]="Path",A[A.Point=5]="Point",A[A.Clipping=6]="Clipping"})(mi||(mi={}));class Ls{constructor(){c(this,"minX",0);c(this,"minY",0);c(this,"maxX",0);c(this,"maxY",0);c(this,"boundingBoxes",new Array);c(this,"polygons",new Array);c(this,"polygonPool",new Ee(()=>O.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,s=this.polygons,a=this.polygonPool,l=t.slots,n=l.length;i.length=0,a.freeAll(s),s.length=0;for(let h=0;h<n;h++){let r=l[h];if(!r.bone.active)continue;let o=r.getAttachment();if(o instanceof Fe){let d=o;i.push(d);let u=a.obtain();u.length!=d.worldVerticesLength&&(u=O.newFloatArray(d.worldVerticesLength)),s.push(u),d.computeWorldVertices(r,0,d.worldVerticesLength,u,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=this.polygons;for(let l=0,n=a.length;l<n;l++){let h=a[l],r=h;for(let o=0,d=h.length;o<d;o+=2){let u=r[o],f=r[o+1];t=Math.min(t,u),e=Math.min(e,f),i=Math.max(i,u),s=Math.max(s,f)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,s){let a=this.minX,l=this.minY,n=this.maxX,h=this.maxY;if(t<=a&&i<=a||e<=l&&s<=l||t>=n&&i>=n||e>=h&&s>=h)return!1;let r=(s-e)/(i-t),o=r*(a-t)+e;if(o>l&&o<h||(o=r*(n-t)+e,o>l&&o<h))return!0;let d=(l-e)/r+t;return d>a&&d<n||(d=(h-e)/r+t,d>a&&d<n)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let i=this.polygons;for(let s=0,a=i.length;s<a;s++)if(this.containsPointPolygon(i[s],t,e))return this.boundingBoxes[s];return null}containsPointPolygon(t,e,i){let s=t,a=t.length,l=a-2,n=!1;for(let h=0;h<a;h+=2){let r=s[h+1],o=s[l+1];if(r<i&&o>=i||o<i&&r>=i){let d=s[h];d+(i-r)/(o-r)*(s[l]-d)<e&&(n=!n)}l=h}return n}intersectsSegment(t,e,i,s){let a=this.polygons;for(let l=0,n=a.length;l<n;l++)if(this.intersectsSegmentPolygon(a[l],t,e,i,s))return this.boundingBoxes[l];return null}intersectsSegmentPolygon(t,e,i,s,a){let l=t,n=t.length,h=e-s,r=i-a,o=e*a-i*s,d=l[n-2],u=l[n-1];for(let f=0;f<n;f+=2){let m=l[f],g=l[f+1],x=d*g-u*m,p=d-m,y=u-g,w=h*y-r*p,b=(o*p-h*x)/w;if((b>=d&&b<=m||b>=m&&b<=d)&&(b>=e&&b<=s||b>=s&&b<=e)){let C=(o*y-r*x)/w;if((C>=u&&C<=g||C>=g&&C<=u)&&(C>=i&&C<=a||C>=a&&C<=i))return!0}d=m,u=g}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class kt{constructor(){c(this,"convexPolygons",new Array);c(this,"convexPolygonsIndices",new Array);c(this,"indicesArray",new Array);c(this,"isConcaveArray",new Array);c(this,"triangles",new Array);c(this,"polygonPool",new Ee(()=>new Array));c(this,"polygonIndicesPool",new Ee(()=>new Array))}triangulate(t){let e=t,i=t.length>>1,s=this.indicesArray;s.length=0;for(let n=0;n<i;n++)s[n]=n;let a=this.isConcaveArray;a.length=0;for(let n=0,h=i;n<h;++n)a[n]=kt.isConcave(n,i,e,s);let l=this.triangles;for(l.length=0;i>3;){let n=i-1,h=0,r=1;for(;;){t:if(!a[h]){let u=s[n]<<1,f=s[h]<<1,m=s[r]<<1,g=e[u],x=e[u+1],p=e[f],y=e[f+1],w=e[m],b=e[m+1];for(let C=(r+1)%i;C!=n;C=(C+1)%i){if(!a[C])continue;let v=s[C]<<1,E=e[v],M=e[v+1];if(kt.positiveArea(w,b,g,x,E,M)&&kt.positiveArea(g,x,p,y,E,M)&&kt.positiveArea(p,y,w,b,E,M))break t}break}if(r==0){do{if(!a[h])break;h--}while(h>0);break}n=h,h=r,r=(r+1)%i}l.push(s[(i+h-1)%i]),l.push(s[h]),l.push(s[(h+1)%i]),s.splice(h,1),a.splice(h,1),i--;let o=(i+h-1)%i,d=h==i?0:h;a[o]=kt.isConcave(o,i,e,s),a[d]=kt.isConcave(d,i,e,s)}return i==3&&(l.push(s[2]),l.push(s[0]),l.push(s[1])),l}decompose(t,e){let i=t,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;let a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;let l=this.polygonIndicesPool.obtain();l.length=0;let n=this.polygonPool.obtain();n.length=0;let h=-1,r=0;for(let o=0,d=e.length;o<d;o+=3){let u=e[o]<<1,f=e[o+1]<<1,m=e[o+2]<<1,g=i[u],x=i[u+1],p=i[f],y=i[f+1],w=i[m],b=i[m+1],C=!1;if(h==u){let v=n.length-4,E=kt.winding(n[v],n[v+1],n[v+2],n[v+3],w,b),M=kt.winding(w,b,n[0],n[1],n[2],n[3]);E==r&&M==r&&(n.push(w),n.push(b),l.push(m),C=!0)}C||(n.length>0?(s.push(n),a.push(l)):(this.polygonPool.free(n),this.polygonIndicesPool.free(l)),n=this.polygonPool.obtain(),n.length=0,n.push(g),n.push(x),n.push(p),n.push(y),n.push(w),n.push(b),l=this.polygonIndicesPool.obtain(),l.length=0,l.push(u),l.push(f),l.push(m),r=kt.winding(g,x,p,y,w,b),h=u)}n.length>0&&(s.push(n),a.push(l));for(let o=0,d=s.length;o<d;o++){if(l=a[o],l.length==0)continue;let u=l[0],f=l[l.length-1];n=s[o];let m=n.length-4,g=n[m],x=n[m+1],p=n[m+2],y=n[m+3],w=n[0],b=n[1],C=n[2],v=n[3],E=kt.winding(g,x,p,y,w,b);for(let M=0;M<d;M++){if(M==o)continue;let T=a[M];if(T.length!=3)continue;let R=T[0],X=T[1],V=T[2],D=s[M],F=D[D.length-2],I=D[D.length-1];if(R!=u||X!=f)continue;let Y=kt.winding(g,x,p,y,F,I),et=kt.winding(F,I,w,b,C,v);Y==E&&et==E&&(D.length=0,T.length=0,n.push(F),n.push(I),l.push(V),g=p,x=y,p=F,y=I,M=0)}}for(let o=s.length-1;o>=0;o--)n=s[o],n.length==0&&(s.splice(o,1),this.polygonPool.free(n),l=a[o],a.splice(o,1),this.polygonIndicesPool.free(l));return s}static isConcave(t,e,i,s){let a=s[(e+t-1)%e]<<1,l=s[t]<<1,n=s[(t+1)%e]<<1;return!this.positiveArea(i[a],i[a+1],i[l],i[l+1],i[n],i[n+1])}static positiveArea(t,e,i,s,a,l){return t*(l-s)+i*(e-l)+a*(s-e)>=0}static winding(t,e,i,s,a,l){let n=i-t,h=s-e;return a*h-l*n+n*e-t*h>=0?1:-1}}class ke{constructor(){c(this,"triangulator",new kt);c(this,"clippingPolygon",new Array);c(this,"clipOutput",new Array);c(this,"clippedVertices",new Array);c(this,"clippedTriangles",new Array);c(this,"scratch",new Array);c(this,"clipAttachment",null);c(this,"clippingPolygons",null)}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let i=e.worldVerticesLength,s=O.setArraySize(this.clippingPolygon,i);e.computeWorldVertices(t,0,i,s,0,2);let a=this.clippingPolygon;ke.makeClockwise(a);let l=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a));for(let n=0,h=l.length;n<h;n++){let r=l[n];ke.makeClockwise(r),r.push(r[0]),r.push(r[1])}return l.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return this.clipAttachment!=null}clipTriangles(t,e,i,s,a,l,n,h){let r=this.clipOutput,o=this.clippedVertices,d=this.clippedTriangles,u=this.clippingPolygons,f=u.length,m=h?12:8,g=0;o.length=0,d.length=0;t:for(let x=0;x<s;x+=3){let p=i[x]<<1,y=t[p],w=t[p+1],b=a[p],C=a[p+1];p=i[x+1]<<1;let v=t[p],E=t[p+1],M=a[p],T=a[p+1];p=i[x+2]<<1;let R=t[p],X=t[p+1],V=a[p],D=a[p+1];for(let F=0;F<f;F++){let I=o.length;if(this.clip(y,w,v,E,R,X,u[F],r)){let Y=r.length;if(Y==0)continue;let et=E-X,lt=R-v,at=y-R,ft=X-w,mt=1/(et*at+lt*(w-X)),ut=Y>>1,rt=this.clipOutput,it=O.setArraySize(o,I+ut*m);for(let vt=0;vt<Y;vt+=2){let Pt=rt[vt],bt=rt[vt+1];it[I]=Pt,it[I+1]=bt,it[I+2]=l.r,it[I+3]=l.g,it[I+4]=l.b,it[I+5]=l.a;let Lt=Pt-R,Rt=bt-X,qt=(et*Lt+lt*Rt)*mt,Qt=(ft*Lt+at*Rt)*mt,ue=1-qt-Qt;it[I+6]=b*qt+M*Qt+V*ue,it[I+7]=C*qt+T*Qt+D*ue,h&&(it[I+8]=n.r,it[I+9]=n.g,it[I+10]=n.b,it[I+11]=n.a),I+=m}I=d.length;let dt=O.setArraySize(d,I+3*(ut-2));ut--;for(let vt=1;vt<ut;vt++)dt[I]=g,dt[I+1]=g+vt,dt[I+2]=g+vt+1,I+=3;g+=ut+1}else{let Y=O.setArraySize(o,I+3*m);Y[I]=y,Y[I+1]=w,Y[I+2]=l.r,Y[I+3]=l.g,Y[I+4]=l.b,Y[I+5]=l.a,h?(Y[I+6]=b,Y[I+7]=C,Y[I+8]=n.r,Y[I+9]=n.g,Y[I+10]=n.b,Y[I+11]=n.a,Y[I+12]=v,Y[I+13]=E,Y[I+14]=l.r,Y[I+15]=l.g,Y[I+16]=l.b,Y[I+17]=l.a,Y[I+18]=M,Y[I+19]=T,Y[I+20]=n.r,Y[I+21]=n.g,Y[I+22]=n.b,Y[I+23]=n.a,Y[I+24]=R,Y[I+25]=X,Y[I+26]=l.r,Y[I+27]=l.g,Y[I+28]=l.b,Y[I+29]=l.a,Y[I+30]=V,Y[I+31]=D,Y[I+32]=n.r,Y[I+33]=n.g,Y[I+34]=n.b,Y[I+35]=n.a):(Y[I+6]=b,Y[I+7]=C,Y[I+8]=v,Y[I+9]=E,Y[I+10]=l.r,Y[I+11]=l.g,Y[I+12]=l.b,Y[I+13]=l.a,Y[I+14]=M,Y[I+15]=T,Y[I+16]=R,Y[I+17]=X,Y[I+18]=l.r,Y[I+19]=l.g,Y[I+20]=l.b,Y[I+21]=l.a,Y[I+22]=V,Y[I+23]=D),I=d.length;let et=O.setArraySize(d,I+3);et[I]=g,et[I+1]=g+1,et[I+2]=g+2,g+=3;continue t}}}}clip(t,e,i,s,a,l,n,h){let r=h,o=!1,d;n.length%4>=2?(d=h,h=this.scratch):d=this.scratch,d.length=0,d.push(t),d.push(e),d.push(i),d.push(s),d.push(a),d.push(l),d.push(t),d.push(e),h.length=0;let u=n,f=n.length-4;for(let m=0;;m+=2){let g=u[m],x=u[m+1],p=u[m+2],y=u[m+3],w=g-p,b=x-y,C=d,v=d.length-2,E=h.length;for(let T=0;T<v;T+=2){let R=C[T],X=C[T+1],V=C[T+2],D=C[T+3],F=w*(D-y)-b*(V-p)>0;if(w*(X-y)-b*(R-p)>0){if(F){h.push(V),h.push(D);continue}let I=D-X,Y=V-R,et=I*(p-g)-Y*(y-x);if(Math.abs(et)>1e-6){let lt=(Y*(x-X)-I*(g-R))/et;h.push(g+(p-g)*lt),h.push(x+(y-x)*lt)}else h.push(g),h.push(x)}else if(F){let I=D-X,Y=V-R,et=I*(p-g)-Y*(y-x);if(Math.abs(et)>1e-6){let lt=(Y*(x-X)-I*(g-R))/et;h.push(g+(p-g)*lt),h.push(x+(y-x)*lt)}else h.push(g),h.push(x);h.push(V),h.push(D)}o=!0}if(E==h.length)return r.length=0,!0;if(h.push(h[0]),h.push(h[1]),m==f)break;let M=h;h=d,h.length=0,d=M}if(r!=h){r.length=0;for(let m=0,g=h.length-2;m<g;m++)r[m]=h[m]}else r.length=r.length-2;return o}static makeClockwise(t){let e=t,i=t.length,s=e[i-2]*e[1]-e[0]*e[i-1],a=0,l=0,n=0,h=0;for(let r=0,o=i-3;r<o;r+=2)a=e[r],l=e[r+1],n=e[r+2],h=e[r+3],s+=a*h-n*l;if(!(s<0))for(let r=0,o=i-2,d=i>>1;r<d;r+=2){let u=e[r],f=e[r+1],m=o-r;e[r]=e[m],e[r+1]=e[m+1],e[m]=u,e[m+1]=f}}}class Rs{constructor(t){c(this,"attachmentLoader");c(this,"scale",1);c(this,"linkedMeshes",new Array);this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new ks,s=typeof t=="string"?JSON.parse(t):t,a=s.skeleton;if(a&&(i.hash=a.hash,i.version=a.spine,i.x=a.x,i.y=a.y,i.width=a.width,i.height=a.height,i.referenceScale=k(a,"referenceScale",100)*e,i.fps=a.fps,i.imagesPath=a.images??null,i.audioPath=a.audio??null),s.bones)for(let l=0;l<s.bones.length;l++){let n=s.bones[l],h=null,r=k(n,"parent",null);r&&(h=i.findBone(r));let o=new ps(i.bones.length,n.name,h);o.length=k(n,"length",0)*e,o.x=k(n,"x",0)*e,o.y=k(n,"y",0)*e,o.rotation=k(n,"rotation",0),o.scaleX=k(n,"scaleX",1),o.scaleY=k(n,"scaleY",1),o.shearX=k(n,"shearX",0),o.shearY=k(n,"shearY",0),o.inherit=O.enumValue(pt,k(n,"inherit","Normal")),o.skinRequired=k(n,"skin",!1);let d=k(n,"color",null);d&&o.color.setFromString(d),i.bones.push(o)}if(s.slots)for(let l=0;l<s.slots.length;l++){let n=s.slots[l],h=null,r=n.name;const o=r.lastIndexOf("/");o!=-1&&(h=r.substring(0,o),r=r.substring(o+1));let d=i.findBone(n.bone);if(!d)throw new Error(`Couldn't find bone ${n.bone} for slot ${r}`);let u=new Ys(i.slots.length,r,d),f=k(n,"color",null);f&&u.color.setFromString(f);let m=k(n,"dark",null);m&&(u.darkColor=st.fromString(m)),u.attachmentName=k(n,"attachment",null),u.blendMode=O.enumValue(Me,k(n,"blend","normal")),u.visible=k(n,"visible",!0),u.path=h,i.slots.push(u)}if(s.ik)for(let l=0;l<s.ik.length;l++){let n=s.ik[l],h=new ys(n.name);h.order=k(n,"order",0),h.skinRequired=k(n,"skin",!1);for(let o=0;o<n.bones.length;o++){let d=i.findBone(n.bones[o]);if(!d)throw new Error(`Couldn't find bone ${n.bones[o]} for IK constraint ${n.name}.`);h.bones.push(d)}let r=i.findBone(n.target);if(!r)throw new Error(`Couldn't find target bone ${n.target} for IK constraint ${n.name}.`);h.target=r,h.mix=k(n,"mix",1),h.softness=k(n,"softness",0)*e,h.bendDirection=k(n,"bendPositive",!0)?1:-1,h.compress=k(n,"compress",!1),h.stretch=k(n,"stretch",!1),h.uniform=k(n,"uniform",!1),i.ikConstraints.push(h)}if(s.transform)for(let l=0;l<s.transform.length;l++){let n=s.transform[l],h=new Is(n.name);h.order=k(n,"order",0),h.skinRequired=k(n,"skin",!1);for(let d=0;d<n.bones.length;d++){let u=n.bones[d],f=i.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for transform constraint ${n.name}.`);h.bones.push(f)}let r=n.target,o=i.findBone(r);if(!o)throw new Error(`Couldn't find target bone ${r} for transform constraint ${n.name}.`);h.target=o,h.local=k(n,"local",!1),h.relative=k(n,"relative",!1),h.offsetRotation=k(n,"rotation",0),h.offsetX=k(n,"x",0)*e,h.offsetY=k(n,"y",0)*e,h.offsetScaleX=k(n,"scaleX",0),h.offsetScaleY=k(n,"scaleY",0),h.offsetShearY=k(n,"shearY",0),h.mixRotate=k(n,"mixRotate",1),h.mixX=k(n,"mixX",1),h.mixY=k(n,"mixY",h.mixX),h.mixScaleX=k(n,"mixScaleX",1),h.mixScaleY=k(n,"mixScaleY",h.mixScaleX),h.mixShearY=k(n,"mixShearY",1),i.transformConstraints.push(h)}if(s.path)for(let l=0;l<s.path.length;l++){let n=s.path[l],h=new As(n.name);h.order=k(n,"order",0),h.skinRequired=k(n,"skin",!1);for(let d=0;d<n.bones.length;d++){let u=n.bones[d],f=i.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for path constraint ${n.name}.`);h.bones.push(f)}let r=n.target,o=i.findSlot(r);if(!o)throw new Error(`Couldn't find target slot ${r} for path constraint ${n.name}.`);h.target=o,h.positionMode=O.enumValue(Gt,k(n,"positionMode","Percent")),h.spacingMode=O.enumValue(Et,k(n,"spacingMode","Length")),h.rotateMode=O.enumValue(jt,k(n,"rotateMode","Tangent")),h.offsetRotation=k(n,"rotation",0),h.position=k(n,"position",0),h.positionMode==Gt.Fixed&&(h.position*=e),h.spacing=k(n,"spacing",0),(h.spacingMode==Et.Length||h.spacingMode==Et.Fixed)&&(h.spacing*=e),h.mixRotate=k(n,"mixRotate",1),h.mixX=k(n,"mixX",1),h.mixY=k(n,"mixY",h.mixX),i.pathConstraints.push(h)}if(s.physics)for(let l=0;l<s.physics.length;l++){const n=s.physics[l],h=new Ms(n.name);h.order=k(n,"order",0),h.skinRequired=k(n,"skin",!1);const r=n.bone,o=i.findBone(r);if(o==null)throw new Error("Physics bone not found: "+r);h.bone=o,h.x=k(n,"x",0),h.y=k(n,"y",0),h.rotate=k(n,"rotate",0),h.scaleX=k(n,"scaleX",0),h.shearX=k(n,"shearX",0),h.limit=k(n,"limit",5e3)*e,h.step=1/k(n,"fps",60),h.inertia=k(n,"inertia",1),h.strength=k(n,"strength",100),h.damping=k(n,"damping",1),h.massInverse=1/k(n,"mass",1),h.wind=k(n,"wind",0),h.gravity=k(n,"gravity",0),h.mix=k(n,"mix",1),h.inertiaGlobal=k(n,"inertiaGlobal",!1),h.strengthGlobal=k(n,"strengthGlobal",!1),h.dampingGlobal=k(n,"dampingGlobal",!1),h.massGlobal=k(n,"massGlobal",!1),h.windGlobal=k(n,"windGlobal",!1),h.gravityGlobal=k(n,"gravityGlobal",!1),h.mixGlobal=k(n,"mixGlobal",!1),i.physicsConstraints.push(h)}if(s.skins)for(let l=0;l<s.skins.length;l++){let n=s.skins[l],h=new Ts(n.name);if(n.bones)for(let r=0;r<n.bones.length;r++){let o=n.bones[r],d=i.findBone(o);if(!d)throw new Error(`Couldn't find bone ${o} for skin ${n.name}.`);h.bones.push(d)}if(n.ik)for(let r=0;r<n.ik.length;r++){let o=n.ik[r],d=i.findIkConstraint(o);if(!d)throw new Error(`Couldn't find IK constraint ${o} for skin ${n.name}.`);h.constraints.push(d)}if(n.transform)for(let r=0;r<n.transform.length;r++){let o=n.transform[r],d=i.findTransformConstraint(o);if(!d)throw new Error(`Couldn't find transform constraint ${o} for skin ${n.name}.`);h.constraints.push(d)}if(n.path)for(let r=0;r<n.path.length;r++){let o=n.path[r],d=i.findPathConstraint(o);if(!d)throw new Error(`Couldn't find path constraint ${o} for skin ${n.name}.`);h.constraints.push(d)}if(n.physics)for(let r=0;r<n.physics.length;r++){let o=n.physics[r],d=i.findPhysicsConstraint(o);if(!d)throw new Error(`Couldn't find physics constraint ${o} for skin ${n.name}.`);h.constraints.push(d)}for(let r in n.attachments){let o=i.findSlot(r);if(!o)throw new Error(`Couldn't find slot ${r} for skin ${n.name}.`);let d=n.attachments[r];for(let u in d){let f=this.readAttachment(d[u],h,o.index,u,i);f&&h.setAttachment(o.index,u,f)}}i.skins.push(h),h.name=="default"&&(i.defaultSkin=h)}for(let l=0,n=this.linkedMeshes.length;l<n;l++){let h=this.linkedMeshes[l],r=h.skin?i.findSkin(h.skin):i.defaultSkin;if(!r)throw new Error(`Skin not found: ${h.skin}`);let o=r.getAttachment(h.slotIndex,h.parent);if(!o)throw new Error(`Parent mesh not found: ${h.parent}`);h.mesh.timelineAttachment=h.inheritTimeline?o:h.mesh,h.mesh.setParentMesh(o),h.mesh.region!=null&&h.mesh.updateRegion()}if(this.linkedMeshes.length=0,s.events)for(let l in s.events){let n=s.events[l],h=new ws(l);h.intValue=k(n,"int",0),h.floatValue=k(n,"float",0),h.stringValue=k(n,"string",""),h.audioPath=k(n,"audio",null),h.audioPath&&(h.volume=k(n,"volume",1),h.balance=k(n,"balance",0)),i.events.push(h)}if(s.animations)for(let l in s.animations){let n=s.animations[l];this.readAnimation(n,l,i)}return i}readAttachment(t,e,i,s,a){let l=this.scale;switch(s=k(t,"name",s),k(t,"type","region")){case"region":{let n=k(t,"path",s),h=this.readSequence(k(t,"sequence",null)),r=this.attachmentLoader.newRegionAttachment(e,s,n,h);if(!r)return null;r.path=n,r.x=k(t,"x",0)*l,r.y=k(t,"y",0)*l,r.scaleX=k(t,"scaleX",1),r.scaleY=k(t,"scaleY",1),r.rotation=k(t,"rotation",0),r.width=t.width*l,r.height=t.height*l,r.sequence=h;let o=k(t,"color",null);return o&&r.color.setFromString(o),r.region!=null&&r.updateRegion(),r}case"boundingbox":{let n=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(!n)return null;this.readVertices(t,n,t.vertexCount<<1);let h=k(t,"color",null);return h&&n.color.setFromString(h),n}case"mesh":case"linkedmesh":{let n=k(t,"path",s),h=this.readSequence(k(t,"sequence",null)),r=this.attachmentLoader.newMeshAttachment(e,s,n,h);if(!r)return null;r.path=n;let o=k(t,"color",null);o&&r.color.setFromString(o),r.width=k(t,"width",0)*l,r.height=k(t,"height",0)*l,r.sequence=h;let d=k(t,"parent",null);if(d)return this.linkedMeshes.push(new Xs(r,k(t,"skin",null),i,d,k(t,"timelines",!0))),r;let u=t.uvs;return this.readVertices(t,r,u.length),r.triangles=t.triangles,r.regionUVs=u,r.region!=null&&r.updateRegion(),r.edges=k(t,"edges",null),r.hullLength=k(t,"hull",0)*2,r}case"path":{let n=this.attachmentLoader.newPathAttachment(e,s);if(!n)return null;n.closed=k(t,"closed",!1),n.constantSpeed=k(t,"constantSpeed",!0);let h=t.vertexCount;this.readVertices(t,n,h<<1);let r=O.newArray(h/3,0);for(let d=0;d<t.lengths.length;d++)r[d]=t.lengths[d]*l;n.lengths=r;let o=k(t,"color",null);return o&&n.color.setFromString(o),n}case"point":{let n=this.attachmentLoader.newPointAttachment(e,s);if(!n)return null;n.x=k(t,"x",0)*l,n.y=k(t,"y",0)*l,n.rotation=k(t,"rotation",0);let h=k(t,"color",null);return h&&n.color.setFromString(h),n}case"clipping":{let n=this.attachmentLoader.newClippingAttachment(e,s);if(!n)return null;let h=k(t,"end",null);h&&(n.endSlot=a.findSlot(h));let r=t.vertexCount;this.readVertices(t,n,r<<1);let o=k(t,"color",null);return o&&n.color.setFromString(o),n}}return null}readSequence(t){if(t==null)return null;let e=new ze(k(t,"count",0));return e.start=k(t,"start",1),e.digits=k(t,"digits",0),e.setupIndex=k(t,"setup",0),e}readVertices(t,e,i){let s=this.scale;e.worldVerticesLength=i;let a=t.vertices;if(i==a.length){let h=O.toFloatArray(a);if(s!=1)for(let r=0,o=a.length;r<o;r++)h[r]*=s;e.vertices=h;return}let l=new Array,n=new Array;for(let h=0,r=a.length;h<r;){let o=a[h++];n.push(o);for(let d=h+o*4;h<d;h+=4)n.push(a[h]),l.push(a[h+1]*s),l.push(a[h+2]*s),l.push(a[h+3])}e.bones=n,e.vertices=O.toFloatArray(l)}readAnimation(t,e,i){let s=this.scale,a=new Array;if(t.slots)for(let n in t.slots){let h=t.slots[n],r=i.findSlot(n);if(!r)throw new Error("Slot not found: "+n);let o=r.index;for(let d in h){let u=h[d];if(!u)continue;let f=u.length;if(d=="attachment"){let m=new fe(f,o);for(let g=0;g<f;g++){let x=u[g];m.setFrame(g,k(x,"time",0),k(x,"name",null))}a.push(m)}else if(d=="rgba"){let m=new $i(f,f<<2,o),g=u[0],x=k(g,"time",0),p=st.fromString(g.color);for(let y=0,w=0;;y++){m.setFrame(y,x,p.r,p.g,p.b,p.a);let b=u[y+1];if(!b){m.shrink(w);break}let C=k(b,"time",0),v=st.fromString(b.color),E=g.curve;E&&(w=ct(E,m,w,y,0,x,C,p.r,v.r,1),w=ct(E,m,w,y,1,x,C,p.g,v.g,1),w=ct(E,m,w,y,2,x,C,p.b,v.b,1),w=ct(E,m,w,y,3,x,C,p.a,v.a,1)),x=C,p=v,g=b}a.push(m)}else if(d=="rgb"){let m=new Ni(f,f*3,o),g=u[0],x=k(g,"time",0),p=st.fromString(g.color);for(let y=0,w=0;;y++){m.setFrame(y,x,p.r,p.g,p.b);let b=u[y+1];if(!b){m.shrink(w);break}let C=k(b,"time",0),v=st.fromString(b.color),E=g.curve;E&&(w=ct(E,m,w,y,0,x,C,p.r,v.r,1),w=ct(E,m,w,y,1,x,C,p.g,v.g,1),w=ct(E,m,w,y,2,x,C,p.b,v.b,1)),x=C,p=v,g=b}a.push(m)}else if(d=="alpha")a.push(Ft(u,new Wi(f,f,o),0,1));else if(d=="rgba2"){let m=new zi(f,f*7,o),g=u[0],x=k(g,"time",0),p=st.fromString(g.light),y=st.fromString(g.dark);for(let w=0,b=0;;w++){m.setFrame(w,x,p.r,p.g,p.b,p.a,y.r,y.g,y.b);let C=u[w+1];if(!C){m.shrink(b);break}let v=k(C,"time",0),E=st.fromString(C.light),M=st.fromString(C.dark),T=g.curve;T&&(b=ct(T,m,b,w,0,x,v,p.r,E.r,1),b=ct(T,m,b,w,1,x,v,p.g,E.g,1),b=ct(T,m,b,w,2,x,v,p.b,E.b,1),b=ct(T,m,b,w,3,x,v,p.a,E.a,1),b=ct(T,m,b,w,4,x,v,y.r,M.r,1),b=ct(T,m,b,w,5,x,v,y.g,M.g,1),b=ct(T,m,b,w,6,x,v,y.b,M.b,1)),x=v,p=E,y=M,g=C}a.push(m)}else if(d=="rgb2"){let m=new qi(f,f*6,o),g=u[0],x=k(g,"time",0),p=st.fromString(g.light),y=st.fromString(g.dark);for(let w=0,b=0;;w++){m.setFrame(w,x,p.r,p.g,p.b,y.r,y.g,y.b);let C=u[w+1];if(!C){m.shrink(b);break}let v=k(C,"time",0),E=st.fromString(C.light),M=st.fromString(C.dark),T=g.curve;T&&(b=ct(T,m,b,w,0,x,v,p.r,E.r,1),b=ct(T,m,b,w,1,x,v,p.g,E.g,1),b=ct(T,m,b,w,2,x,v,p.b,E.b,1),b=ct(T,m,b,w,3,x,v,y.r,M.r,1),b=ct(T,m,b,w,4,x,v,y.g,M.g,1),b=ct(T,m,b,w,5,x,v,y.b,M.b,1)),x=v,p=E,y=M,g=C}a.push(m)}}}if(t.bones)for(let n in t.bones){let h=t.bones[n],r=i.findBone(n);if(!r)throw new Error("Bone not found: "+n);let o=r.index;for(let d in h){let u=h[d],f=u.length;if(f!=0){if(d==="rotate")a.push(Ft(u,new qe(f,f,o),0,1));else if(d==="translate"){let m=new Li(f,f<<1,o);a.push(Ne(u,m,"x","y",0,s))}else if(d==="translatex"){let m=new Ri(f,f,o);a.push(Ft(u,m,0,s))}else if(d==="translatey"){let m=new Xi(f,f,o);a.push(Ft(u,m,0,s))}else if(d==="scale"){let m=new Pi(f,f<<1,o);a.push(Ne(u,m,"x","y",1,1))}else if(d==="scalex"){let m=new Fi(f,f,o);a.push(Ft(u,m,1,1))}else if(d==="scaley"){let m=new Vi(f,f,o);a.push(Ft(u,m,1,1))}else if(d==="shear"){let m=new Di(f,f<<1,o);a.push(Ne(u,m,"x","y",0,1))}else if(d==="shearx"){let m=new Oi(f,f,o);a.push(Ft(u,m,0,1))}else if(d==="sheary"){let m=new Bi(f,f,o);a.push(Ft(u,m,0,1))}else if(d==="inherit"){let m=new _i(f,r.index);for(let g=0;g<u.length;g++){let x=u[g];m.setFrame(g,k(x,"time",0),O.enumValue(pt,k(x,"inherit","Normal")))}a.push(m)}}}}if(t.ik)for(let n in t.ik){let h=t.ik[n],r=h[0];if(!r)continue;let o=i.findIkConstraint(n);if(!o)throw new Error("IK Constraint not found: "+n);let d=i.ikConstraints.indexOf(o),u=new Gi(h.length,h.length<<1,d),f=k(r,"time",0),m=k(r,"mix",1),g=k(r,"softness",0)*s;for(let x=0,p=0;;x++){u.setFrame(x,f,m,g,k(r,"bendPositive",!0)?1:-1,k(r,"compress",!1),k(r,"stretch",!1));let y=h[x+1];if(!y){u.shrink(p);break}let w=k(y,"time",0),b=k(y,"mix",1),C=k(y,"softness",0)*s,v=r.curve;v&&(p=ct(v,u,p,x,0,f,w,m,b,1),p=ct(v,u,p,x,1,f,w,g,C,s)),f=w,m=b,g=C,r=y}a.push(u)}if(t.transform)for(let n in t.transform){let h=t.transform[n],r=h[0];if(!r)continue;let o=i.findTransformConstraint(n);if(!o)throw new Error("Transform constraint not found: "+n);let d=i.transformConstraints.indexOf(o),u=new Hi(h.length,h.length*6,d),f=k(r,"time",0),m=k(r,"mixRotate",1),g=k(r,"mixX",1),x=k(r,"mixY",g),p=k(r,"mixScaleX",1),y=k(r,"mixScaleY",p),w=k(r,"mixShearY",1);for(let b=0,C=0;;b++){u.setFrame(b,f,m,g,x,p,y,w);let v=h[b+1];if(!v){u.shrink(C);break}let E=k(v,"time",0),M=k(v,"mixRotate",1),T=k(v,"mixX",1),R=k(v,"mixY",T),X=k(v,"mixScaleX",1),V=k(v,"mixScaleY",X),D=k(v,"mixShearY",1),F=r.curve;F&&(C=ct(F,u,C,b,0,f,E,m,M,1),C=ct(F,u,C,b,1,f,E,g,T,1),C=ct(F,u,C,b,2,f,E,x,R,1),C=ct(F,u,C,b,3,f,E,p,X,1),C=ct(F,u,C,b,4,f,E,y,V,1),C=ct(F,u,C,b,5,f,E,w,D,1)),f=E,m=M,g=T,x=R,p=X,y=V,p=X,r=v}a.push(u)}if(t.path)for(let n in t.path){let h=t.path[n],r=i.findPathConstraint(n);if(!r)throw new Error("Path constraint not found: "+n);let o=i.pathConstraints.indexOf(r);for(let d in h){let u=h[d],f=u[0];if(!f)continue;let m=u.length;if(d==="position"){let g=new ji(m,m,o);a.push(Ft(u,g,0,r.positionMode==Gt.Fixed?s:1))}else if(d==="spacing"){let g=new Ji(m,m,o);a.push(Ft(u,g,0,r.spacingMode==Et.Length||r.spacingMode==Et.Fixed?s:1))}else if(d==="mix"){let g=new Ki(m,m*3,o),x=k(f,"time",0),p=k(f,"mixRotate",1),y=k(f,"mixX",1),w=k(f,"mixY",y);for(let b=0,C=0;;b++){g.setFrame(b,x,p,y,w);let v=u[b+1];if(!v){g.shrink(C);break}let E=k(v,"time",0),M=k(v,"mixRotate",1),T=k(v,"mixX",1),R=k(v,"mixY",T),X=f.curve;X&&(C=ct(X,g,C,b,0,x,E,p,M,1),C=ct(X,g,C,b,1,x,E,y,T,1),C=ct(X,g,C,b,2,x,E,w,R,1)),x=E,p=M,y=T,w=R,f=v}a.push(g)}}}if(t.physics)for(let n in t.physics){let h=t.physics[n],r=-1;if(n.length>0){let o=i.findPhysicsConstraint(n);if(!o)throw new Error("Physics constraint not found: "+n);r=i.physicsConstraints.indexOf(o)}for(let o in h){let d=h[o],u=d[0];if(!u)continue;let f=d.length;if(o=="reset"){const g=new Ue(d.size,r);for(let x=0;u!=null;u=d[x+1],x++)g.setFrame(x,k(u,"time",0));a.push(g);continue}let m;if(o=="inertia")m=new Qi(f,f,r);else if(o=="strength")m=new Zi(f,f,r);else if(o=="damping")m=new ts(f,f,r);else if(o=="mass")m=new es(f,f,r);else if(o=="wind")m=new is(f,f,r);else if(o=="gravity")m=new ss(f,f,r);else if(o=="mix")m=new ns(f,f,r);else continue;a.push(Ft(d,m,0,1))}}if(t.attachments)for(let n in t.attachments){let h=t.attachments[n],r=i.findSkin(n);if(!r)throw new Error("Skin not found: "+n);for(let o in h){let d=h[o],u=i.findSlot(o);if(!u)throw new Error("Slot not found: "+o);let f=u.index;for(let m in d){let g=d[m],x=r.getAttachment(f,m);for(let p in g){let y=g[p],w=y[0];if(w){if(p=="deform"){let b=x.bones,C=x.vertices,v=b?C.length/3*2:C.length,E=new Ui(y.length,y.length,f,x),M=k(w,"time",0);for(let T=0,R=0;;T++){let X,V=k(w,"vertices",null);if(!V)X=b?O.newFloatArray(v):C;else{X=O.newFloatArray(v);let Y=k(w,"offset",0);if(O.arrayCopy(V,0,X,Y,V.length),s!=1)for(let et=Y,lt=et+V.length;et<lt;et++)X[et]*=s;if(!b)for(let et=0;et<v;et++)X[et]+=C[et]}E.setFrame(T,M,X);let D=y[T+1];if(!D){E.shrink(R);break}let F=k(D,"time",0),I=w.curve;I&&(R=ct(I,E,R,T,0,M,F,0,1,1)),M=F,w=D}a.push(E)}else if(p=="sequence"){let b=new Ge(y.length,f,x),C=0;for(let v=0;v<y.length;v++){let E=k(w,"delay",C),M=k(w,"time",0),T=wt[k(w,"mode","hold")],R=k(w,"index",0);b.setFrame(v,M,T,R,E),C=E,w=y[v+1]}a.push(b)}}}}}}if(t.drawOrder){let n=new ae(t.drawOrder.length),h=i.slots.length,r=0;for(let o=0;o<t.drawOrder.length;o++,r++){let d=t.drawOrder[o],u=null,f=k(d,"offsets",null);if(f){u=O.newArray(h,-1);let m=O.newArray(h-f.length,0),g=0,x=0;for(let p=0;p<f.length;p++){let y=f[p],w=i.findSlot(y.slot);if(!w)throw new Error("Slot not found: "+w);let b=w.index;for(;g!=b;)m[x++]=g++;u[g+y.offset]=g++}for(;g<h;)m[x++]=g++;for(let p=h-1;p>=0;p--)u[p]==-1&&(u[p]=m[--x])}n.setFrame(r,k(d,"time",0),u)}a.push(n)}if(t.events){let n=new Se(t.events.length),h=0;for(let r=0;r<t.events.length;r++,h++){let o=t.events[r],d=i.findEvent(o.name);if(!d)throw new Error("Event not found: "+o.name);let u=new bs(O.toSinglePrecision(k(o,"time",0)),d);u.intValue=k(o,"int",d.intValue),u.floatValue=k(o,"float",d.floatValue),u.stringValue=k(o,"string",d.stringValue),u.data.audioPath&&(u.volume=k(o,"volume",1),u.balance=k(o,"balance",0)),n.setFrame(h,u)}a.push(n)}let l=0;for(let n=0,h=a.length;n<h;n++)l=Math.max(l,a[n].getDuration());i.animations.push(new Ci(e,a,l))}}class Xs{constructor(t,e,i,s,a){c(this,"parent");c(this,"skin");c(this,"slotIndex");c(this,"mesh");c(this,"inheritTimeline");this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=s,this.inheritTimeline=a}}function Ft(A,t,e,i){let s=A[0],a=k(s,"time",0),l=k(s,"value",e)*i,n=0;for(let h=0;;h++){t.setFrame(h,a,l);let r=A[h+1];if(!r)return t.shrink(n),t;let o=k(r,"time",0),d=k(r,"value",e)*i;s.curve&&(n=ct(s.curve,t,n,h,0,a,o,l,d,i)),a=o,l=d,s=r}}function Ne(A,t,e,i,s,a){let l=A[0],n=k(l,"time",0),h=k(l,e,s)*a,r=k(l,i,s)*a,o=0;for(let d=0;;d++){t.setFrame(d,n,h,r);let u=A[d+1];if(!u)return t.shrink(o),t;let f=k(u,"time",0),m=k(u,e,s)*a,g=k(u,i,s)*a,x=l.curve;x&&(o=ct(x,t,o,d,0,n,f,h,m,a),o=ct(x,t,o,d,1,n,f,r,g,a)),n=f,h=m,r=g,l=u}}function ct(A,t,e,i,s,a,l,n,h,r){if(A=="stepped")return t.setStepped(i),e;let o=s<<2,d=A[o],u=A[o+1]*r,f=A[o+2],m=A[o+3]*r;return t.setBezier(e,i,s,a,n,d,u,f,m,l,h),e+1}function k(A,t,e){return A[t]!==void 0?A[t]:e}typeof Math.fround>"u"&&(Math.fround=function(A){return function(t){return A[0]=t,A[0]}}(new Float32Array(1)));class St{constructor(t,e={alpha:"true"}){c(this,"canvas");c(this,"gl");c(this,"restorables",new Array);if(t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext)this.gl=t,this.canvas=this.gl.canvas;else{let i=t;this.gl=i.getContext("webgl2",e)||i.getContext("webgl",e),this.canvas=i,i.addEventListener("webglcontextlost",s=>{s&&s.preventDefault()}),i.addEventListener("webglcontextrestored",s=>{for(let a=0,l=this.restorables.length;a<l;a++)this.restorables[a].restore()})}}addRestorable(t){this.restorables.push(t)}removeRestorable(t){let e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}const ge=class ge extends cs{constructor(e,i,s=!1){super(i);c(this,"context");c(this,"texture",null);c(this,"boundUnit",0);c(this,"useMipMaps",!1);this.context=e instanceof St?e:new St(e),this.useMipMaps=s,this.restore(),this.context.addRestorable(this)}setFilters(e,i){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,ge.validateMagFilter(i)),this.useMipMaps=ge.usesMipMaps(e),this.useMipMaps&&s.generateMipmap(s.TEXTURE_2D)}static validateMagFilter(e){switch(e){case Ct.MipMapLinearLinear:case Ct.MipMapLinearNearest:case Ct.MipMapNearestLinear:case Ct.MipMapNearestNearest:return Ct.Linear;default:return e}}static usesMipMaps(e){switch(e){case Ct.MipMapLinearLinear:case Ct.MipMapLinearNearest:case Ct.MipMapNearestLinear:case Ct.MipMapNearestNearest:return!0;default:return!1}}setWraps(e,i){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,i)}update(e){let i=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e&&i.generateMipmap(i.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(e=0){let i=this.context.gl;this.boundUnit=e,i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,this.texture)}unbind(){let e=this.context.gl;e.activeTexture(e.TEXTURE0+this.boundUnit),e.bindTexture(e.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}};c(ge,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);let je=ge;class Ps extends xs{constructor(t,e="",i=new Si){super(s=>new je(t,s),e,i)}}class le{constructor(t=0,e=0,i=0){c(this,"x",0);c(this,"y",0);c(this,"z",0);this.x=t,this.y=e,this.z=i}setFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){let t=this.length();return t==0?this:(t=1/t,this.x*=t,this.y*=t,this.z*=t,this)}cross(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}multiply(t){let e=t.values;return this.set(this.x*e[B]+this.y*e[q]+this.z*e[U]+e[_],this.x*e[G]+this.y*e[$]+this.z*e[H]+e[N],this.x*e[j]+this.y*e[J]+this.z*e[W]+e[z])}project(t){let e=t.values,i=1/(this.x*e[Q]+this.y*e[Z]+this.z*e[tt]+e[K]);return this.set((this.x*e[B]+this.y*e[q]+this.z*e[U]+e[_])*i,(this.x*e[G]+this.y*e[$]+this.z*e[H]+e[N])*i,(this.x*e[j]+this.y*e[J]+this.z*e[W]+e[z])*i)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(t){let e=t.x-this.x,i=t.y-this.y,s=t.z-this.z;return Math.sqrt(e*e+i*i+s*s)}}const B=0,q=4,U=8,_=12,G=1,$=5,H=9,N=13,j=2,J=6,W=10,z=14,Q=3,Z=7,tt=11,K=15,yt=class yt{constructor(){c(this,"temp",new Float32Array(16));c(this,"values",new Float32Array(16));let t=this.values;t[B]=1,t[$]=1,t[W]=1,t[K]=1}set(t){return this.values.set(t),this}transpose(){let t=this.temp,e=this.values;return t[B]=e[B],t[q]=e[G],t[U]=e[j],t[_]=e[Q],t[G]=e[q],t[$]=e[$],t[H]=e[J],t[N]=e[Z],t[j]=e[U],t[J]=e[H],t[W]=e[W],t[z]=e[tt],t[Q]=e[_],t[Z]=e[N],t[tt]=e[z],t[K]=e[K],this.set(t)}identity(){let t=this.values;return t[B]=1,t[q]=0,t[U]=0,t[_]=0,t[G]=0,t[$]=1,t[H]=0,t[N]=0,t[j]=0,t[J]=0,t[W]=1,t[z]=0,t[Q]=0,t[Z]=0,t[tt]=0,t[K]=1,this}invert(){let t=this.values,e=this.temp,i=t[Q]*t[J]*t[H]*t[_]-t[j]*t[Z]*t[H]*t[_]-t[Q]*t[$]*t[W]*t[_]+t[G]*t[Z]*t[W]*t[_]+t[j]*t[$]*t[tt]*t[_]-t[G]*t[J]*t[tt]*t[_]-t[Q]*t[J]*t[U]*t[N]+t[j]*t[Z]*t[U]*t[N]+t[Q]*t[q]*t[W]*t[N]-t[B]*t[Z]*t[W]*t[N]-t[j]*t[q]*t[tt]*t[N]+t[B]*t[J]*t[tt]*t[N]+t[Q]*t[$]*t[U]*t[z]-t[G]*t[Z]*t[U]*t[z]-t[Q]*t[q]*t[H]*t[z]+t[B]*t[Z]*t[H]*t[z]+t[G]*t[q]*t[tt]*t[z]-t[B]*t[$]*t[tt]*t[z]-t[j]*t[$]*t[U]*t[K]+t[G]*t[J]*t[U]*t[K]+t[j]*t[q]*t[H]*t[K]-t[B]*t[J]*t[H]*t[K]-t[G]*t[q]*t[W]*t[K]+t[B]*t[$]*t[W]*t[K];if(i==0)throw new Error("non-invertible matrix");let s=1/i;return e[B]=t[H]*t[z]*t[Z]-t[N]*t[W]*t[Z]+t[N]*t[J]*t[tt]-t[$]*t[z]*t[tt]-t[H]*t[J]*t[K]+t[$]*t[W]*t[K],e[q]=t[_]*t[W]*t[Z]-t[U]*t[z]*t[Z]-t[_]*t[J]*t[tt]+t[q]*t[z]*t[tt]+t[U]*t[J]*t[K]-t[q]*t[W]*t[K],e[U]=t[U]*t[N]*t[Z]-t[_]*t[H]*t[Z]+t[_]*t[$]*t[tt]-t[q]*t[N]*t[tt]-t[U]*t[$]*t[K]+t[q]*t[H]*t[K],e[_]=t[_]*t[H]*t[J]-t[U]*t[N]*t[J]-t[_]*t[$]*t[W]+t[q]*t[N]*t[W]+t[U]*t[$]*t[z]-t[q]*t[H]*t[z],e[G]=t[N]*t[W]*t[Q]-t[H]*t[z]*t[Q]-t[N]*t[j]*t[tt]+t[G]*t[z]*t[tt]+t[H]*t[j]*t[K]-t[G]*t[W]*t[K],e[$]=t[U]*t[z]*t[Q]-t[_]*t[W]*t[Q]+t[_]*t[j]*t[tt]-t[B]*t[z]*t[tt]-t[U]*t[j]*t[K]+t[B]*t[W]*t[K],e[H]=t[_]*t[H]*t[Q]-t[U]*t[N]*t[Q]-t[_]*t[G]*t[tt]+t[B]*t[N]*t[tt]+t[U]*t[G]*t[K]-t[B]*t[H]*t[K],e[N]=t[U]*t[N]*t[j]-t[_]*t[H]*t[j]+t[_]*t[G]*t[W]-t[B]*t[N]*t[W]-t[U]*t[G]*t[z]+t[B]*t[H]*t[z],e[j]=t[$]*t[z]*t[Q]-t[N]*t[J]*t[Q]+t[N]*t[j]*t[Z]-t[G]*t[z]*t[Z]-t[$]*t[j]*t[K]+t[G]*t[J]*t[K],e[J]=t[_]*t[J]*t[Q]-t[q]*t[z]*t[Q]-t[_]*t[j]*t[Z]+t[B]*t[z]*t[Z]+t[q]*t[j]*t[K]-t[B]*t[J]*t[K],e[W]=t[q]*t[N]*t[Q]-t[_]*t[$]*t[Q]+t[_]*t[G]*t[Z]-t[B]*t[N]*t[Z]-t[q]*t[G]*t[K]+t[B]*t[$]*t[K],e[z]=t[_]*t[$]*t[j]-t[q]*t[N]*t[j]-t[_]*t[G]*t[J]+t[B]*t[N]*t[J]+t[q]*t[G]*t[z]-t[B]*t[$]*t[z],e[Q]=t[H]*t[J]*t[Q]-t[$]*t[W]*t[Q]-t[H]*t[j]*t[Z]+t[G]*t[W]*t[Z]+t[$]*t[j]*t[tt]-t[G]*t[J]*t[tt],e[Z]=t[q]*t[W]*t[Q]-t[U]*t[J]*t[Q]+t[U]*t[j]*t[Z]-t[B]*t[W]*t[Z]-t[q]*t[j]*t[tt]+t[B]*t[J]*t[tt],e[tt]=t[U]*t[$]*t[Q]-t[q]*t[H]*t[Q]-t[U]*t[G]*t[Z]+t[B]*t[H]*t[Z]+t[q]*t[G]*t[tt]-t[B]*t[$]*t[tt],e[K]=t[q]*t[H]*t[j]-t[U]*t[$]*t[j]+t[U]*t[G]*t[J]-t[B]*t[H]*t[J]-t[q]*t[G]*t[W]+t[B]*t[$]*t[W],t[B]=e[B]*s,t[q]=e[q]*s,t[U]=e[U]*s,t[_]=e[_]*s,t[G]=e[G]*s,t[$]=e[$]*s,t[H]=e[H]*s,t[N]=e[N]*s,t[j]=e[j]*s,t[J]=e[J]*s,t[W]=e[W]*s,t[z]=e[z]*s,t[Q]=e[Q]*s,t[Z]=e[Z]*s,t[tt]=e[tt]*s,t[K]=e[K]*s,this}determinant(){let t=this.values;return t[Q]*t[J]*t[H]*t[_]-t[j]*t[Z]*t[H]*t[_]-t[Q]*t[$]*t[W]*t[_]+t[G]*t[Z]*t[W]*t[_]+t[j]*t[$]*t[tt]*t[_]-t[G]*t[J]*t[tt]*t[_]-t[Q]*t[J]*t[U]*t[N]+t[j]*t[Z]*t[U]*t[N]+t[Q]*t[q]*t[W]*t[N]-t[B]*t[Z]*t[W]*t[N]-t[j]*t[q]*t[tt]*t[N]+t[B]*t[J]*t[tt]*t[N]+t[Q]*t[$]*t[U]*t[z]-t[G]*t[Z]*t[U]*t[z]-t[Q]*t[q]*t[H]*t[z]+t[B]*t[Z]*t[H]*t[z]+t[G]*t[q]*t[tt]*t[z]-t[B]*t[$]*t[tt]*t[z]-t[j]*t[$]*t[U]*t[K]+t[G]*t[J]*t[U]*t[K]+t[j]*t[q]*t[H]*t[K]-t[B]*t[J]*t[H]*t[K]-t[G]*t[q]*t[W]*t[K]+t[B]*t[$]*t[W]*t[K]}translate(t,e,i){let s=this.values;return s[_]+=t,s[N]+=e,s[z]+=i,this}copy(){return new yt().set(this.values)}projection(t,e,i,s){this.identity();let a=1/Math.tan(i*(Math.PI/180)/2),l=(e+t)/(t-e),n=2*e*t/(t-e),h=this.values;return h[B]=a/s,h[G]=0,h[j]=0,h[Q]=0,h[q]=0,h[$]=a,h[J]=0,h[Z]=0,h[U]=0,h[H]=0,h[W]=l,h[tt]=-1,h[_]=0,h[N]=0,h[z]=n,h[K]=0,this}ortho2d(t,e,i,s){return this.ortho(t,t+i,e,e+s,0,1)}ortho(t,e,i,s,a,l){this.identity();let n=2/(e-t),h=2/(s-i),r=-2/(l-a),o=-(e+t)/(e-t),d=-(s+i)/(s-i),u=-(l+a)/(l-a),f=this.values;return f[B]=n,f[G]=0,f[j]=0,f[Q]=0,f[q]=0,f[$]=h,f[J]=0,f[Z]=0,f[U]=0,f[H]=0,f[W]=r,f[tt]=0,f[_]=o,f[N]=d,f[z]=u,f[K]=1,this}multiply(t){let e=this.temp,i=this.values,s=t.values;return e[B]=i[B]*s[B]+i[q]*s[G]+i[U]*s[j]+i[_]*s[Q],e[q]=i[B]*s[q]+i[q]*s[$]+i[U]*s[J]+i[_]*s[Z],e[U]=i[B]*s[U]+i[q]*s[H]+i[U]*s[W]+i[_]*s[tt],e[_]=i[B]*s[_]+i[q]*s[N]+i[U]*s[z]+i[_]*s[K],e[G]=i[G]*s[B]+i[$]*s[G]+i[H]*s[j]+i[N]*s[Q],e[$]=i[G]*s[q]+i[$]*s[$]+i[H]*s[J]+i[N]*s[Z],e[H]=i[G]*s[U]+i[$]*s[H]+i[H]*s[W]+i[N]*s[tt],e[N]=i[G]*s[_]+i[$]*s[N]+i[H]*s[z]+i[N]*s[K],e[j]=i[j]*s[B]+i[J]*s[G]+i[W]*s[j]+i[z]*s[Q],e[J]=i[j]*s[q]+i[J]*s[$]+i[W]*s[J]+i[z]*s[Z],e[W]=i[j]*s[U]+i[J]*s[H]+i[W]*s[W]+i[z]*s[tt],e[z]=i[j]*s[_]+i[J]*s[N]+i[W]*s[z]+i[z]*s[K],e[Q]=i[Q]*s[B]+i[Z]*s[G]+i[tt]*s[j]+i[K]*s[Q],e[Z]=i[Q]*s[q]+i[Z]*s[$]+i[tt]*s[J]+i[K]*s[Z],e[tt]=i[Q]*s[U]+i[Z]*s[H]+i[tt]*s[W]+i[K]*s[tt],e[K]=i[Q]*s[_]+i[Z]*s[N]+i[tt]*s[z]+i[K]*s[K],this.set(this.temp)}multiplyLeft(t){let e=this.temp,i=this.values,s=t.values;return e[B]=s[B]*i[B]+s[q]*i[G]+s[U]*i[j]+s[_]*i[Q],e[q]=s[B]*i[q]+s[q]*i[$]+s[U]*i[J]+s[_]*i[Z],e[U]=s[B]*i[U]+s[q]*i[H]+s[U]*i[W]+s[_]*i[tt],e[_]=s[B]*i[_]+s[q]*i[N]+s[U]*i[z]+s[_]*i[K],e[G]=s[G]*i[B]+s[$]*i[G]+s[H]*i[j]+s[N]*i[Q],e[$]=s[G]*i[q]+s[$]*i[$]+s[H]*i[J]+s[N]*i[Z],e[H]=s[G]*i[U]+s[$]*i[H]+s[H]*i[W]+s[N]*i[tt],e[N]=s[G]*i[_]+s[$]*i[N]+s[H]*i[z]+s[N]*i[K],e[j]=s[j]*i[B]+s[J]*i[G]+s[W]*i[j]+s[z]*i[Q],e[J]=s[j]*i[q]+s[J]*i[$]+s[W]*i[J]+s[z]*i[Z],e[W]=s[j]*i[U]+s[J]*i[H]+s[W]*i[W]+s[z]*i[tt],e[z]=s[j]*i[_]+s[J]*i[N]+s[W]*i[z]+s[z]*i[K],e[Q]=s[Q]*i[B]+s[Z]*i[G]+s[tt]*i[j]+s[K]*i[Q],e[Z]=s[Q]*i[q]+s[Z]*i[$]+s[tt]*i[J]+s[K]*i[Z],e[tt]=s[Q]*i[U]+s[Z]*i[H]+s[tt]*i[W]+s[K]*i[tt],e[K]=s[Q]*i[_]+s[Z]*i[N]+s[tt]*i[z]+s[K]*i[K],this.set(this.temp)}lookAt(t,e,i){let s=yt.xAxis,a=yt.yAxis,l=yt.zAxis;l.setFrom(e).normalize(),s.setFrom(e).normalize(),s.cross(i).normalize(),a.setFrom(s).cross(l).normalize(),this.identity();let n=this.values;return n[B]=s.x,n[q]=s.y,n[U]=s.z,n[G]=a.x,n[$]=a.y,n[H]=a.z,n[j]=-l.x,n[J]=-l.y,n[W]=-l.z,yt.tmpMatrix.identity(),yt.tmpMatrix.values[_]=-t.x,yt.tmpMatrix.values[N]=-t.y,yt.tmpMatrix.values[z]=-t.z,this.multiply(yt.tmpMatrix),this}};c(yt,"xAxis",new le),c(yt,"yAxis",new le),c(yt,"zAxis",new le),c(yt,"tmpMatrix",new yt);let ie=yt;class Fs{constructor(t,e){c(this,"position",new le(0,0,0));c(this,"direction",new le(0,0,-1));c(this,"up",new le(0,1,0));c(this,"near",0);c(this,"far",100);c(this,"zoom",1);c(this,"viewportWidth",0);c(this,"viewportHeight",0);c(this,"projectionView",new ie);c(this,"inverseProjectionView",new ie);c(this,"projection",new ie);c(this,"view",new ie);this.viewportWidth=t,this.viewportHeight=e,this.update()}update(){let t=this.projection,e=this.view,i=this.projectionView,s=this.inverseProjectionView,a=this.zoom,l=this.viewportWidth,n=this.viewportHeight;t.ortho(a*(-l/2),a*(l/2),a*(-n/2),a*(n/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),s.set(i.values).invert()}screenToWorld(t,e,i){let s=t.x,a=i-t.y-1;return t.x=2*s/e-1,t.y=2*a/i-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}worldToScreen(t,e,i){return t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=i*(t.y+1)/2,t.z=(t.z+1)/2,t}setViewport(t,e){this.viewportWidth=t,this.viewportHeight=e}}class Vs{constructor(t){c(this,"element");c(this,"mouseX",0);c(this,"mouseY",0);c(this,"buttonDown",!1);c(this,"touch0",null);c(this,"touch1",null);c(this,"initialPinchDistance",0);c(this,"listeners",new Array);c(this,"eventListeners",[]);this.element=t,this.setupCallbacks(t)}setupCallbacks(t){let e=n=>{if(n instanceof MouseEvent){let h=t.getBoundingClientRect();this.mouseX=n.clientX-h.left,this.mouseY=n.clientY-h.top,this.buttonDown=!0,this.listeners.map(r=>{r.down&&r.down(this.mouseX,this.mouseY)}),document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)}},i=n=>{if(n instanceof MouseEvent){let h=t.getBoundingClientRect();this.mouseX=n.clientX-h.left,this.mouseY=n.clientY-h.top,this.listeners.map(r=>{this.buttonDown?r.dragged&&r.dragged(this.mouseX,this.mouseY):r.moved&&r.moved(this.mouseX,this.mouseY)})}},s=n=>{if(n instanceof MouseEvent){let h=t.getBoundingClientRect();this.mouseX=n.clientX-h.left,this.mouseY=n.clientY-h.top,this.buttonDown=!1,this.listeners.map(r=>{r.up&&r.up(this.mouseX,this.mouseY)}),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)}},a=n=>{n.preventDefault(),n.deltaY,n.deltaMode==WheelEvent.DOM_DELTA_LINE,n.deltaMode==WheelEvent.DOM_DELTA_PAGE,this.listeners.map(h=>{h.wheel&&h.wheel(n.deltaY)})};t.addEventListener("mousedown",e,!0),t.addEventListener("mousemove",i,!0),t.addEventListener("mouseup",s,!0),t.addEventListener("wheel",a,!0),t.addEventListener("touchstart",n=>{if(!this.touch0||!this.touch1){var h=n.changedTouches;let r=h.item(0);if(!r)return;let o=t.getBoundingClientRect(),d=r.clientX-o.left,u=r.clientY-o.top,f=new Ds(r.identifier,d,u);if(this.mouseX=d,this.mouseY=u,this.buttonDown=!0,!this.touch0)this.touch0=f,this.listeners.map(m=>{m.down&&m.down(f.x,f.y)});else if(!this.touch1){this.touch1=f;let m=this.touch1.x-this.touch0.x,g=this.touch1.x-this.touch0.x;this.initialPinchDistance=Math.sqrt(m*m+g*g),this.listeners.map(x=>{x.zoom&&x.zoom(this.initialPinchDistance,this.initialPinchDistance)})}}n.preventDefault()},!1),t.addEventListener("touchmove",n=>{if(this.touch0){var h=n.changedTouches;let d=t.getBoundingClientRect();for(var r=0;r<h.length;r++){var o=h[r];let u=o.clientX-d.left,f=o.clientY-d.top;this.touch0.identifier===o.identifier&&(this.touch0.x=this.mouseX=u,this.touch0.y=this.mouseY=f,this.listeners.map(m=>{m.dragged&&m.dragged(u,f)})),this.touch1&&this.touch1.identifier===o.identifier&&(this.touch1.x=this.mouseX=u,this.touch1.y=this.mouseY=f)}if(this.touch0&&this.touch1){let u=this.touch1.x-this.touch0.x,f=this.touch1.x-this.touch0.x,m=Math.sqrt(u*u+f*f);this.listeners.map(g=>{g.zoom&&g.zoom(this.initialPinchDistance,m)})}}n.preventDefault()},!1);let l=n=>{if(this.touch0){var h=n.changedTouches;let d=t.getBoundingClientRect();for(var r=0;r<h.length;r++){var o=h[r];let u=o.clientX-d.left,f=o.clientY-d.top;if(this.touch0.identifier===o.identifier)if(this.touch0=null,this.mouseX=u,this.mouseY=f,this.listeners.map(m=>{m.up&&m.up(u,f)}),this.touch1)this.touch0=this.touch1,this.touch1=null,this.mouseX=this.touch0.x,this.mouseX=this.touch0.x,this.buttonDown=!0,this.listeners.map(m=>{m.down&&m.down(this.touch0.x,this.touch0.y)});else{this.buttonDown=!1;break}this.touch1&&this.touch1.identifier&&(this.touch1=null)}}n.preventDefault()};t.addEventListener("touchend",l,!1),t.addEventListener("touchcancel",l)}addListener(t){this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>-1&&this.listeners.splice(e,1)}}class Ds{constructor(t,e,i){c(this,"identifier");c(this,"x");c(this,"y");this.identifier=t,this.x=e,this.y=i}}const ht=class ht{constructor(t,e,i){c(this,"vertexShader");c(this,"fragmentShader");c(this,"context");c(this,"vs",null);c(this,"vsSource");c(this,"fs",null);c(this,"fsSource");c(this,"program",null);c(this,"tmp2x2",new Float32Array(2*2));c(this,"tmp3x3",new Float32Array(3*3));c(this,"tmp4x4",new Float32Array(4*4));this.vertexShader=e,this.fragmentShader=i,this.vsSource=e,this.fsSource=i,this.context=t instanceof St?t:new St(t),this.context.addRestorable(this),this.compile()}getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}compile(){let t=this.context.gl;try{if(this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}compileShader(t,e){let i=this.context.gl,s=i.createShader(t);if(!s)throw new Error("Couldn't create shader.");if(i.shaderSource(s,e),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){let a="Couldn't compile shader: "+i.getShaderInfoLog(s);if(i.deleteShader(s),!i.isContextLost())throw new Error(a)}return s}compileProgram(t,e){let i=this.context.gl,s=i.createProgram();if(!s)throw new Error("Couldn't compile program.");if(i.attachShader(s,t),i.attachShader(s,e),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS)){let a="Couldn't compile shader program: "+i.getProgramInfoLog(s);if(i.deleteProgram(s),!i.isContextLost())throw new Error(a)}return s}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}setUniformf(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}setUniform2f(t,e,i){this.context.gl.uniform2f(this.getUniformLocation(t),e,i)}setUniform3f(t,e,i,s){this.context.gl.uniform3f(this.getUniformLocation(t),e,i,s)}setUniform4f(t,e,i,s,a){this.context.gl.uniform4f(this.getUniformLocation(t),e,i,s,a)}setUniform2x2f(t,e){let i=this.context.gl;this.tmp2x2.set(e),i.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}setUniform3x3f(t,e){let i=this.context.gl;this.tmp3x3.set(e),i.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}setUniform4x4f(t,e){let i=this.context.gl;this.tmp4x4.set(e),i.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}getUniformLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=e.getUniformLocation(this.program,t);if(!i&&!e.isContextLost())throw new Error(`Couldn't find location for uniform ${t}`);return i}getAttributeLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=e.getAttribLocation(this.program,t);if(i==-1&&!e.isContextLost())throw new Error(`Couldn't find location for attribute ${t}`);return i}dispose(){this.context.removeRestorable(this);let t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}static newColoredTextured(t){let e=`
attribute vec4 ${ht.POSITION};
attribute vec4 ${ht.COLOR};
attribute vec2 ${ht.TEXCOORDS};
uniform mat4 ${ht.MVP_MATRIX};
varying vec4 v_color;
varying vec2 v_texCoords;

void main () {
	v_color = ${ht.COLOR};
	v_texCoords = ${ht.TEXCOORDS};
	gl_Position = ${ht.MVP_MATRIX} * ${ht.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	gl_FragColor = v_color * texture2D(u_texture, v_texCoords);
}
`;return new ht(t,e,i)}static newTwoColoredTextured(t){let e=`
attribute vec4 ${ht.POSITION};
attribute vec4 ${ht.COLOR};
attribute vec4 ${ht.COLOR2};
attribute vec2 ${ht.TEXCOORDS};
uniform mat4 ${ht.MVP_MATRIX};
varying vec4 v_light;
varying vec4 v_dark;
varying vec2 v_texCoords;

void main () {
	v_light = ${ht.COLOR};
	v_dark = ${ht.COLOR2};
	v_texCoords = ${ht.TEXCOORDS};
	gl_Position = ${ht.MVP_MATRIX} * ${ht.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_light;
varying LOWP vec4 v_dark;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	vec4 texColor = texture2D(u_texture, v_texCoords);
	gl_FragColor.a = texColor.a * v_light.a;
	gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;
}
`;return new ht(t,e,i)}static newColored(t){let e=`
attribute vec4 ${ht.POSITION};
attribute vec4 ${ht.COLOR};
uniform mat4 ${ht.MVP_MATRIX};
varying vec4 v_color;

void main () {
	v_color = ${ht.COLOR};
	gl_Position = ${ht.MVP_MATRIX} * ${ht.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;

void main () {
	gl_FragColor = v_color;
}
`;return new ht(t,e,i)}};c(ht,"MVP_MATRIX","u_projTrans"),c(ht,"POSITION","a_position"),c(ht,"COLOR","a_color"),c(ht,"COLOR2","a_color2"),c(ht,"TEXCOORDS","a_texCoords"),c(ht,"SAMPLER","u_texture");let Dt=ht;class Mi{constructor(t,e,i,s){c(this,"attributes");c(this,"context");c(this,"vertices");c(this,"verticesBuffer",null);c(this,"verticesLength",0);c(this,"dirtyVertices",!1);c(this,"indices");c(this,"indicesBuffer",null);c(this,"indicesLength",0);c(this,"dirtyIndices",!1);c(this,"elementsPerVertex",0);this.attributes=e,this.context=t instanceof St?t:new St(t),this.elementsPerVertex=0;for(let a=0;a<e.length;a++)this.elementsPerVertex+=e[a].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(s),this.context.addRestorable(this)}getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(t){this.dirtyVertices=!0,this.verticesLength=t}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(t){this.dirtyIndices=!0,this.indicesLength=t}getIndices(){return this.indices}getVertexSizeInFloats(){let t=0;for(var e=0;e<this.attributes.length;e++){let i=this.attributes[e];t+=i.numElements}return t}setVertices(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}setIndices(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}draw(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(t,e,i,s){let a=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?a.drawElements(e,s,a.UNSIGNED_SHORT,i*2):a.drawArrays(e,i,s),this.unbind(t)}bind(t){let e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);let i=0;for(let s=0;s<this.attributes.length;s++){let a=this.attributes[s],l=t.getAttributeLocation(a.name);e.enableVertexAttribArray(l),e.vertexAttribPointer(l,a.numElements,e.FLOAT,!1,this.elementsPerVertex*4,i*4),i+=a.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(t){let e=this.context.gl;for(let i=0;i<this.attributes.length;i++){let s=this.attributes[i],a=t.getAttributeLocation(s.name);e.disableVertexAttribArray(a)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}update(){let t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}class De{constructor(t,e,i){c(this,"name");c(this,"type");c(this,"numElements");this.name=t,this.type=e,this.numElements=i}}class Je extends De{constructor(){super(Dt.POSITION,de.Float,2)}}class gi extends De{constructor(t=0){super(Dt.TEXCOORDS+(t==0?"":t),de.Float,2)}}class Ke extends De{constructor(){super(Dt.COLOR,de.Float,4)}}class Os extends De{constructor(){super(Dt.COLOR2,de.Float,4)}}var de;(function(A){A[A.Float=0]="Float"})(de||(de={}));const Wt=1,Bs=769,pi=770,xi=771,bi=774,Vt=class Vt{constructor(t,e=!0,i=10920){c(this,"context");c(this,"drawCalls",0);c(this,"isDrawing",!1);c(this,"mesh");c(this,"shader",null);c(this,"lastTexture",null);c(this,"verticesLength",0);c(this,"indicesLength",0);c(this,"srcColorBlend");c(this,"srcAlphaBlend");c(this,"dstBlend");c(this,"cullWasEnabled",!1);if(i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=t instanceof St?t:new St(t);let s=e?[new Je,new Ke,new gi,new Os]:[new Je,new Ke,new gi];this.mesh=new Mi(t,s,i,i*3);let a=this.context.gl;this.srcColorBlend=a.SRC_ALPHA,this.srcAlphaBlend=a.ONE,this.dstBlend=a.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend),Vt.disableCulling&&(this.cullWasEnabled=e.isEnabled(e.CULL_FACE),this.cullWasEnabled&&e.disable(e.CULL_FACE))}setBlendMode(t,e){const i=Vt.blendModesGL[t],s=e?i.srcRgbPma:i.srcRgb,a=i.srcAlpha,l=i.dstRgb;if(this.srcColorBlend==s&&this.srcAlphaBlend==a&&this.dstBlend==l)return;this.srcColorBlend=s,this.srcAlphaBlend=a,this.dstBlend=l,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(s,l,a,l)}draw(t,e,i){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+i.length>this.mesh.getIndices().length)&&this.flush();let s=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);let a=this.mesh.getIndices();for(let l=this.indicesLength,n=0;n<i.length;l++,n++)a[l]=i[n]+s;this.indicesLength+=i.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(this.verticesLength!=0){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,Vt.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let t=this.context.gl;t.disable(t.BLEND),Vt.disableCulling&&this.cullWasEnabled&&t.enable(t.CULL_FACE)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let t=Vt.globalDrawCalls;return Vt.globalDrawCalls=0,t}dispose(){this.mesh.dispose()}};c(Vt,"disableCulling",!1),c(Vt,"globalDrawCalls",0),c(Vt,"blendModesGL",[{srcRgb:pi,srcRgbPma:Wt,dstRgb:xi,srcAlpha:Wt},{srcRgb:pi,srcRgbPma:Wt,dstRgb:Wt,srcAlpha:Wt},{srcRgb:bi,srcRgbPma:bi,dstRgb:xi,srcAlpha:Wt},{srcRgb:Wt,srcRgbPma:Wt,dstRgb:Bs,srcAlpha:Wt}]);let Te=Vt;class wi{constructor(t,e=10920){c(this,"context");c(this,"isDrawing",!1);c(this,"mesh");c(this,"shapeType",At.Filled);c(this,"color",new st(1,1,1,1));c(this,"shader",null);c(this,"vertexIndex",0);c(this,"tmp",new oe);c(this,"srcColorBlend");c(this,"srcAlphaBlend");c(this,"dstBlend");if(e>10920)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof St?t:new St(t),this.mesh=new Mi(t,[new Je,new Ke],e,0);let i=this.context.gl;this.srcColorBlend=i.SRC_ALPHA,this.srcAlphaBlend=i.ONE,this.dstBlend=i.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(t,e,i){this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(t,i,e,i))}setColor(t){this.color.setFromColor(t)}setColorWith(t,e,i,s){this.color.set(t,e,i,s)}point(t,e,i){this.check(At.Point,1),i||(i=this.color),this.vertex(t,e,i)}line(t,e,i,s,a){this.check(At.Line,2),this.mesh.getVertices(),this.vertexIndex,a||(a=this.color),this.vertex(t,e,a),this.vertex(i,s,a)}triangle(t,e,i,s,a,l,n,h,r,o){this.check(t?At.Filled:At.Line,3),this.mesh.getVertices(),this.vertexIndex,h||(h=this.color),r||(r=this.color),o||(o=this.color),t?(this.vertex(e,i,h),this.vertex(s,a,r),this.vertex(l,n,o)):(this.vertex(e,i,h),this.vertex(s,a,r),this.vertex(s,a,h),this.vertex(l,n,r),this.vertex(l,n,h),this.vertex(e,i,r))}quad(t,e,i,s,a,l,n,h,r,o,d,u,f){this.check(t?At.Filled:At.Line,3),this.mesh.getVertices(),this.vertexIndex,o||(o=this.color),d||(d=this.color),u||(u=this.color),f||(f=this.color),t?(this.vertex(e,i,o),this.vertex(s,a,d),this.vertex(l,n,u),this.vertex(l,n,u),this.vertex(h,r,f),this.vertex(e,i,o)):(this.vertex(e,i,o),this.vertex(s,a,d),this.vertex(s,a,d),this.vertex(l,n,u),this.vertex(l,n,u),this.vertex(h,r,f),this.vertex(h,r,f),this.vertex(e,i,o))}rect(t,e,i,s,a,l){this.quad(t,e,i,e+s,i,e+s,i+a,e,i+a,l,l,l,l)}rectLine(t,e,i,s,a,l,n){this.check(t?At.Filled:At.Line,8),n||(n=this.color);let h=this.tmp.set(a-i,e-s);h.normalize(),l*=.5;let r=h.x*l,o=h.y*l;t?(this.vertex(e+r,i+o,n),this.vertex(e-r,i-o,n),this.vertex(s+r,a+o,n),this.vertex(s-r,a-o,n),this.vertex(s+r,a+o,n),this.vertex(e-r,i-o,n)):(this.vertex(e+r,i+o,n),this.vertex(e-r,i-o,n),this.vertex(s+r,a+o,n),this.vertex(s-r,a-o,n),this.vertex(s+r,a+o,n),this.vertex(e+r,i+o,n),this.vertex(s-r,a-o,n),this.vertex(e-r,i-o,n))}x(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}polygon(t,e,i,s){if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(At.Line,i*2),s||(s=this.color),this.mesh.getVertices(),this.vertexIndex,e<<=1,i<<=1;let a=t[e],l=t[e+1],n=e+i;for(let h=e,r=e+i-2;h<r;h+=2){let o=t[h],d=t[h+1],u=0,f=0;h+2>=n?(u=a,f=l):(u=t[h+2],f=t[h+3]),this.vertex(o,d,s),this.vertex(u,f,s)}}circle(t,e,i,s,a,l=0){if(l==0&&(l=Math.max(1,6*P.cbrt(s)|0)),l<=0)throw new Error("segments must be > 0.");a||(a=this.color);let n=2*P.PI/l,h=Math.cos(n),r=Math.sin(n),o=s,d=0;if(t){this.check(At.Filled,l*3+3),l--;for(let u=0;u<l;u++){this.vertex(e,i,a),this.vertex(e+o,i+d,a);let f=o;o=h*o-r*d,d=r*f+h*d,this.vertex(e+o,i+d,a)}this.vertex(e,i,a),this.vertex(e+o,i+d,a)}else{this.check(At.Line,l*2+2);for(let u=0;u<l;u++){this.vertex(e+o,i+d,a);let f=o;o=h*o-r*d,d=r*f+h*d,this.vertex(e+o,i+d,a)}this.vertex(e+o,i+d,a)}o=s,d=0,this.vertex(e+o,i+d,a)}curve(t,e,i,s,a,l,n,h,r,o){this.check(At.Line,r*2+2),o||(o=this.color);let d=1/r,u=d*d,f=d*d*d,m=3*d,g=3*u,x=6*u,p=6*f,y=t-i*2+a,w=e-s*2+l,b=(i-a)*3-t+n,C=(s-l)*3-e+h,v=t,E=e,M=(i-t)*m+y*g+b*f,T=(s-e)*m+w*g+C*f,R=y*x+b*p,X=w*x+C*p,V=b*p,D=C*p;for(;r-- >0;)this.vertex(v,E,o),v+=M,E+=T,M+=R,T+=X,R+=V,X+=D,this.vertex(v,E,o);this.vertex(v,E,o),this.vertex(n,h,o)}vertex(t,e,i){let s=this.vertexIndex,a=this.mesh.getVertices();a[s++]=t,a[s++]=e,a[s++]=i.r,a[s++]=i.g,a[s++]=i.b,a[s++]=i.a,this.vertexIndex=s}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let t=this.context.gl;t.disable(t.BLEND),this.isDrawing=!1}flush(){if(this.vertexIndex!=0){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t)if(this.mesh.maxVertices()-this.mesh.numVertices()<e)this.flush();else return;else this.flush(),this.shapeType=t}dispose(){this.mesh.dispose()}}var At;(function(A){A[A.Point=0]="Point",A[A.Line=1]="Line",A[A.Filled=4]="Filled"})(At||(At={}));const re=class re{constructor(t){c(this,"boneLineColor",new st(1,0,0,1));c(this,"boneOriginColor",new st(0,1,0,1));c(this,"attachmentLineColor",new st(0,0,1,.5));c(this,"triangleLineColor",new st(1,.64,0,.5));c(this,"pathColor",new st().setFromString("FF7F00"));c(this,"clipColor",new st(.8,0,0,2));c(this,"aabbColor",new st(0,1,0,.5));c(this,"drawBones",!0);c(this,"drawRegionAttachments",!0);c(this,"drawBoundingBoxes",!0);c(this,"drawMeshHull",!0);c(this,"drawMeshTriangles",!0);c(this,"drawPaths",!0);c(this,"drawSkeletonXY",!1);c(this,"drawClipping",!0);c(this,"premultipliedAlpha",!1);c(this,"scale",1);c(this,"boneWidth",2);c(this,"context");c(this,"bounds",new Ls);c(this,"temp",new Array);c(this,"vertices",O.newFloatArray(2*1024));this.context=t instanceof St?t:new St(t)}draw(t,e,i){let s=e.x,a=e.y,l=this.context.gl,n=this.premultipliedAlpha?l.ONE:l.SRC_ALPHA;t.setBlendMode(n,l.ONE,l.ONE_MINUS_SRC_ALPHA);let h=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(let r=0,o=h.length;r<o;r++){let d=h[r];if(i&&i.indexOf(d.data.name)>-1||!d.parent)continue;let u=d.data.length*d.a+d.worldX,f=d.data.length*d.c+d.worldY;t.rectLine(!0,d.worldX,d.worldY,u,f,this.boneWidth*this.scale)}this.drawSkeletonXY&&t.x(s,a,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);let r=e.slots;for(let o=0,d=r.length;o<d;o++){let u=r[o],f=u.getAttachment();if(f instanceof ce){let m=f,g=this.vertices;m.computeWorldVertices(u,g,0,2),t.line(g[0],g[1],g[2],g[3]),t.line(g[2],g[3],g[4],g[5]),t.line(g[4],g[5],g[6],g[7]),t.line(g[6],g[7],g[0],g[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let r=e.slots;for(let o=0,d=r.length;o<d;o++){let u=r[o];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof Ht))continue;let m=f,g=this.vertices;m.computeWorldVertices(u,0,m.worldVerticesLength,g,0,2);let x=m.triangles,p=m.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(let y=0,w=x.length;y<w;y+=3){let b=x[y]*2,C=x[y+1]*2,v=x[y+2]*2;t.triangle(!1,g[b],g[b+1],g[C],g[C+1],g[v],g[v+1])}}if(this.drawMeshHull&&p>0){t.setColor(this.attachmentLineColor),p=(p>>1)*2;let y=g[p-2],w=g[p-1];for(let b=0,C=p;b<C;b+=2){let v=g[b],E=g[b+1];t.line(v,E,y,w),y=v,w=E}}}}if(this.drawBoundingBoxes){let r=this.bounds;r.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,r.minX,r.minY,r.getWidth(),r.getHeight());let o=r.polygons,d=r.boundingBoxes;for(let u=0,f=o.length;u<f;u++){let m=o[u];t.setColor(d[u].color),t.polygon(m,0,m.length)}}if(this.drawPaths){let r=e.slots;for(let o=0,d=r.length;o<d;o++){let u=r[o];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof Jt))continue;let m=f,g=m.worldVerticesLength,x=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,x,0,2);let p=this.pathColor,y=x[2],w=x[3],b=0,C=0;if(m.closed){t.setColor(p);let v=x[0],E=x[1],M=x[g-2],T=x[g-1];b=x[g-4],C=x[g-3],t.curve(y,w,v,E,M,T,b,C,32),t.setColor(re.LIGHT_GRAY),t.line(y,w,v,E),t.line(b,C,M,T)}g-=4;for(let v=4;v<g;v+=6){let E=x[v],M=x[v+1],T=x[v+2],R=x[v+3];b=x[v+4],C=x[v+5],t.setColor(p),t.curve(y,w,E,M,T,R,b,C,32),t.setColor(re.LIGHT_GRAY),t.line(y,w,E,M),t.line(b,C,T,R),y=b,w=C}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(let r=0,o=h.length;r<o;r++){let d=h[r];i&&i.indexOf(d.data.name)>-1||t.circle(!0,d.worldX,d.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let r=e.slots;t.setColor(this.clipColor);for(let o=0,d=r.length;o<d;o++){let u=r[o];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof be))continue;let m=f,g=m.worldVerticesLength,x=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,x,0,2);for(let p=0,y=x.length;p<y;p+=2){let w=x[p],b=x[p+1],C=x[(p+2)%x.length],v=x[(p+3)%x.length];t.line(w,b,C,v)}}}}dispose(){}};c(re,"LIGHT_GRAY",new st(192/255,192/255,192/255,1)),c(re,"GREEN",new st(0,1,0,1));let Qe=re;class _s{constructor(t,e,i){c(this,"vertices");c(this,"numVertices");c(this,"numFloats");this.vertices=t,this.numVertices=e,this.numFloats=i}}const Pe=class Pe{constructor(t,e=!0){c(this,"premultipliedAlpha",!1);c(this,"tempColor",new st);c(this,"tempColor2",new st);c(this,"vertices");c(this,"vertexSize",8);c(this,"twoColorTint",!1);c(this,"renderable",new _s([],0,0));c(this,"clipper",new ke);c(this,"temp",new oe);c(this,"temp2",new oe);c(this,"temp3",new st);c(this,"temp4",new st);this.twoColorTint=e,e&&(this.vertexSize+=4),this.vertices=O.newFloatArray(this.vertexSize*1024)}draw(t,e,i=-1,s=-1,a=null){let l=this.clipper,n=this.premultipliedAlpha,h=this.twoColorTint,r=null,o=this.renderable,d,u,f=e.drawOrder,m,g=e.color,x=h?12:8,p=!1;i==-1&&(p=!0);for(let y=0,w=f.length;y<w;y++){let b=l.isClipping()?2:x,C=f[y];if(!C.bone.active){l.clipEndWithSlot(C);continue}if(i>=0&&i==C.data.index&&(p=!0),!p){l.clipEndWithSlot(C);continue}s>=0&&s==C.data.index&&(p=!1);let v=C.getAttachment(),E;if(v instanceof ce){let M=v;o.vertices=this.vertices,o.numVertices=4,o.numFloats=b<<2,M.computeWorldVertices(C,o.vertices,0,b),u=Pe.QUAD_TRIANGLES,d=M.uvs,E=M.region.texture,m=M.color}else if(v instanceof Ht){let M=v;o.vertices=this.vertices,o.numVertices=M.worldVerticesLength>>1,o.numFloats=o.numVertices*b,o.numFloats>o.vertices.length&&(o.vertices=this.vertices=O.newFloatArray(o.numFloats)),M.computeWorldVertices(C,0,M.worldVerticesLength,o.vertices,0,b),u=M.triangles,E=M.region.texture,d=M.uvs,m=M.color}else if(v instanceof be){let M=v;l.clipStart(C,M);continue}else{l.clipEndWithSlot(C);continue}if(E){let M=C.color,T=this.tempColor;T.r=g.r*M.r*m.r,T.g=g.g*M.g*m.g,T.b=g.b*M.b*m.b,T.a=g.a*M.a*m.a,n&&(T.r*=T.a,T.g*=T.a,T.b*=T.a);let R=this.tempColor2;C.darkColor?(n?(R.r=C.darkColor.r*T.a,R.g=C.darkColor.g*T.a,R.b=C.darkColor.b*T.a):R.setFromColor(C.darkColor),R.a=n?1:0):R.set(0,0,0,1);let X=C.data.blendMode;if(X!=r&&(r=X,t.setBlendMode(r,n)),l.isClipping()){l.clipTriangles(o.vertices,o.numFloats,u,u.length,d,T,R,h);let V=new Float32Array(l.clippedVertices),D=l.clippedTriangles;a&&a(V,V.length,x),t.draw(E,V,D)}else{let V=o.vertices;if(h)for(let F=2,I=0,Y=o.numFloats;F<Y;F+=x,I+=2)V[F]=T.r,V[F+1]=T.g,V[F+2]=T.b,V[F+3]=T.a,V[F+4]=d[I],V[F+5]=d[I+1],V[F+6]=R.r,V[F+7]=R.g,V[F+8]=R.b,V[F+9]=R.a;else for(let F=2,I=0,Y=o.numFloats;F<Y;F+=x,I+=2)V[F]=T.r,V[F+1]=T.g,V[F+2]=T.b,V[F+3]=T.a,V[F+4]=d[I],V[F+5]=d[I+1];let D=o.vertices.subarray(0,o.numFloats);a&&a(o.vertices,o.numFloats,x),t.draw(E,D,u)}}l.clipEndWithSlot(C)}l.clipEnd()}};c(Pe,"QUAD_TRIANGLES",[0,1,2,2,3,0]);let Ze=Pe;const S=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],Ae=[0,1,2,2,3,0],Ce=new st(1,1,1,1);class $s{constructor(t,e,i=!0){c(this,"context");c(this,"canvas");c(this,"camera");c(this,"batcher");c(this,"twoColorTint",!1);c(this,"batcherShader");c(this,"shapes");c(this,"shapesShader");c(this,"activeRenderer",null);c(this,"skeletonRenderer");c(this,"skeletonDebugRenderer");this.canvas=t,this.context=e instanceof St?e:new St(e),this.twoColorTint=i,this.camera=new Fs(t.width,t.height),this.batcherShader=i?Dt.newTwoColoredTextured(this.context):Dt.newColoredTextured(this.context),this.batcher=new Te(this.context,i),this.shapesShader=Dt.newColored(this.context),this.shapes=new wi(this.context),this.skeletonRenderer=new Ze(this.context,i),this.skeletonDebugRenderer=new Qe(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(t,e=!1,i=-1,s=-1,a=null){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,i,s,a)}drawSkeletonDebug(t,e=!1,i){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,i)}drawTexture(t,e,i,s,a,l){this.enableRenderer(this.batcher),l||(l=Ce);var n=0;S[n++]=e,S[n++]=i,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=0,S[n++]=1,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e+s,S[n++]=i,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=1,S[n++]=1,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e+s,S[n++]=i+a,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=1,S[n++]=0,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e,S[n++]=i+a,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=0,S[n++]=0,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n]=0),this.batcher.draw(t,S,Ae)}drawTextureUV(t,e,i,s,a,l,n,h,r,o){this.enableRenderer(this.batcher),o||(o=Ce);var d=0;S[d++]=e,S[d++]=i,S[d++]=o.r,S[d++]=o.g,S[d++]=o.b,S[d++]=o.a,S[d++]=l,S[d++]=n,this.twoColorTint&&(S[d++]=0,S[d++]=0,S[d++]=0,S[d++]=0),S[d++]=e+s,S[d++]=i,S[d++]=o.r,S[d++]=o.g,S[d++]=o.b,S[d++]=o.a,S[d++]=h,S[d++]=n,this.twoColorTint&&(S[d++]=0,S[d++]=0,S[d++]=0,S[d++]=0),S[d++]=e+s,S[d++]=i+a,S[d++]=o.r,S[d++]=o.g,S[d++]=o.b,S[d++]=o.a,S[d++]=h,S[d++]=r,this.twoColorTint&&(S[d++]=0,S[d++]=0,S[d++]=0,S[d++]=0),S[d++]=e,S[d++]=i+a,S[d++]=o.r,S[d++]=o.g,S[d++]=o.b,S[d++]=o.a,S[d++]=l,S[d++]=r,this.twoColorTint&&(S[d++]=0,S[d++]=0,S[d++]=0,S[d]=0),this.batcher.draw(t,S,Ae)}drawTextureRotated(t,e,i,s,a,l,n,h,r){this.enableRenderer(this.batcher),r||(r=Ce);let o=e+l,d=i+n,u=-l,f=-n,m=s-l,g=a-n,x=u,p=f,y=u,w=g,b=m,C=g,v=m,E=f,M=0,T=0,R=0,X=0,V=0,D=0,F=0,I=0;if(h!=0){let et=P.cosDeg(h),lt=P.sinDeg(h);M=et*x-lt*p,T=lt*x+et*p,F=et*y-lt*w,I=lt*y+et*w,V=et*b-lt*C,D=lt*b+et*C,R=V+(M-F),X=D+(T-I)}else M=x,T=p,F=y,I=w,V=b,D=C,R=v,X=E;M+=o,T+=d,R+=o,X+=d,V+=o,D+=d,F+=o,I+=d;var Y=0;S[Y++]=M,S[Y++]=T,S[Y++]=r.r,S[Y++]=r.g,S[Y++]=r.b,S[Y++]=r.a,S[Y++]=0,S[Y++]=1,this.twoColorTint&&(S[Y++]=0,S[Y++]=0,S[Y++]=0,S[Y++]=0),S[Y++]=R,S[Y++]=X,S[Y++]=r.r,S[Y++]=r.g,S[Y++]=r.b,S[Y++]=r.a,S[Y++]=1,S[Y++]=1,this.twoColorTint&&(S[Y++]=0,S[Y++]=0,S[Y++]=0,S[Y++]=0),S[Y++]=V,S[Y++]=D,S[Y++]=r.r,S[Y++]=r.g,S[Y++]=r.b,S[Y++]=r.a,S[Y++]=1,S[Y++]=0,this.twoColorTint&&(S[Y++]=0,S[Y++]=0,S[Y++]=0,S[Y++]=0),S[Y++]=F,S[Y++]=I,S[Y++]=r.r,S[Y++]=r.g,S[Y++]=r.b,S[Y++]=r.a,S[Y++]=0,S[Y++]=0,this.twoColorTint&&(S[Y++]=0,S[Y++]=0,S[Y++]=0,S[Y]=0),this.batcher.draw(t,S,Ae)}drawRegion(t,e,i,s,a,l){this.enableRenderer(this.batcher),l||(l=Ce);var n=0;S[n++]=e,S[n++]=i,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=t.u,S[n++]=t.v2,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e+s,S[n++]=i,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=t.u2,S[n++]=t.v2,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e+s,S[n++]=i+a,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=t.u2,S[n++]=t.v,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n++]=0),S[n++]=e,S[n++]=i+a,S[n++]=l.r,S[n++]=l.g,S[n++]=l.b,S[n++]=l.a,S[n++]=t.u,S[n++]=t.v,this.twoColorTint&&(S[n++]=0,S[n++]=0,S[n++]=0,S[n]=0),this.batcher.draw(t.page.texture,S,Ae)}line(t,e,i,s,a,l){this.enableRenderer(this.shapes),this.shapes.line(t,e,i,s,a)}triangle(t,e,i,s,a,l,n,h,r,o){this.enableRenderer(this.shapes),this.shapes.triangle(t,e,i,s,a,l,n,h,r,o)}quad(t,e,i,s,a,l,n,h,r,o,d,u,f){this.enableRenderer(this.shapes),this.shapes.quad(t,e,i,s,a,l,n,h,r,o,d,u,f)}rect(t,e,i,s,a,l){this.enableRenderer(this.shapes),this.shapes.rect(t,e,i,s,a,l)}rectLine(t,e,i,s,a,l,n){this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,i,s,a,l,n)}polygon(t,e,i,s){this.enableRenderer(this.shapes),this.shapes.polygon(t,e,i,s)}circle(t,e,i,s,a,l=0){this.enableRenderer(this.shapes),this.shapes.circle(t,e,i,s,a,l)}curve(t,e,i,s,a,l,n,h,r,o){this.enableRenderer(this.shapes),this.shapes.curve(t,e,i,s,a,l,n,h,r,o)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(t){let e=this.canvas;var i=window.devicePixelRatio||1,s=Math.round(e.clientWidth*i),a=Math.round(e.clientHeight*i);if((e.width!=s||e.height!=a)&&(e.width=s,e.height=a),this.context.gl.viewport(0,0,e.width,e.height),t===pe.Expand)this.camera.setViewport(s,a);else if(t===pe.Fit){let l=e.width,n=e.height,h=this.camera.viewportWidth,r=this.camera.viewportHeight,o=r/h,d=n/l,u=o<d?h/l:r/n;this.camera.setViewport(l*u,n*u)}this.camera.update()}enableRenderer(t){this.activeRenderer!==t&&(this.end(),t instanceof Te?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Dt.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof wi?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Dt.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var pe;(function(A){A[A.Stretch=0]="Stretch",A[A.Expand=1]="Expand",A[A.Fit=2]="Fit"})(pe||(pe={}));class Ns{constructor(t,e){c(this,"config");c(this,"context");c(this,"time",new Yi);c(this,"htmlCanvas");c(this,"gl");c(this,"renderer");c(this,"assetManager");c(this,"input");c(this,"disposed",!1);this.config=e,e.pathPrefix||(e.pathPrefix=""),e.app||(e.app={loadAssets:()=>{},initialize:()=>{},update:()=>{},render:()=>{},error:()=>{},dispose:()=>{}}),e.webglConfig||(e.webglConfig={alpha:!0}),this.htmlCanvas=t,this.context=new St(t,e.webglConfig),this.renderer=new $s(t,this.context),this.gl=this.context.gl,this.assetManager=new Ps(this.context,e.pathPrefix),this.input=new Vs(t),e.app.loadAssets&&e.app.loadAssets(this);let i=()=>{this.disposed||(requestAnimationFrame(i),this.time.update(),e.app.update&&e.app.update(this,this.time.delta),e.app.render&&e.app.render(this))},s=()=>{if(!this.disposed){if(this.assetManager.isLoadingComplete()){this.assetManager.hasErrors()?e.app.error&&e.app.error(this,this.assetManager.getErrors()):(e.app.initialize&&e.app.initialize(this),i());return}requestAnimationFrame(s)}};requestAnimationFrame(s)}clear(t,e,i,s){this.gl.clearColor(t,e,i,s),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}dispose(){this.config.app.dispose&&this.config.app.dispose(this),this.disposed=!0}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.19.2
 * @author George Michael Brower
 * @license MIT
 */class $t{constructor(t,e,i,s,a="div"){this.parent=t,this.object=e,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(a),this.domElement.classList.add("controller"),this.domElement.classList.add(s),this.$name=document.createElement("div"),this.$name.classList.add("name"),$t.nextNameID=$t.nextNameID||0,this.$name.id=`lil-gui-name-${++$t.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(t){return this._name=t,this.$name.textContent=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled?this:(this._disabled=t,this.domElement.classList.toggle("disabled",t),this.$disable.toggleAttribute("disabled",t),this)}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(t){const e=this.parent.add(this.object,this.property,t);return e.name(this._name),this.destroy(),e}min(t){return this}max(t){return this}step(t){return this}decimals(t){return this}listen(t=!0){return this._listening=t,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const t=this.save();t!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=t}getValue(){return this.object[this.property]}setValue(t){return this.getValue()!==t&&(this.object[this.property]=t,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(t){return this.setValue(t),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Ws extends $t{constructor(t,e,i){super(t,e,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function ti(A){let t,e;return(t=A.match(/(#|0x)?([a-f0-9]{6})/i))?e=t[2]:(t=A.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?e=parseInt(t[1]).toString(16).padStart(2,0)+parseInt(t[2]).toString(16).padStart(2,0)+parseInt(t[3]).toString(16).padStart(2,0):(t=A.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(e=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),e?"#"+e:!1}const zs={isPrimitive:!0,match:A=>typeof A=="string",fromHexString:ti,toHexString:ti},xe={isPrimitive:!0,match:A=>typeof A=="number",fromHexString:A=>parseInt(A.substring(1),16),toHexString:A=>"#"+A.toString(16).padStart(6,0)},qs={isPrimitive:!1,match:A=>Array.isArray(A),fromHexString(A,t,e=1){const i=xe.fromHexString(A);t[0]=(i>>16&255)/255*e,t[1]=(i>>8&255)/255*e,t[2]=(i&255)/255*e},toHexString([A,t,e],i=1){i=255/i;const s=A*i<<16^t*i<<8^e*i<<0;return xe.toHexString(s)}},Us={isPrimitive:!1,match:A=>Object(A)===A,fromHexString(A,t,e=1){const i=xe.fromHexString(A);t.r=(i>>16&255)/255*e,t.g=(i>>8&255)/255*e,t.b=(i&255)/255*e},toHexString({r:A,g:t,b:e},i=1){i=255/i;const s=A*i<<16^t*i<<8^e*i<<0;return xe.toHexString(s)}},Gs=[zs,xe,qs,Us];function Hs(A){return Gs.find(t=>t.match(A))}class js extends $t{constructor(t,e,i,s){super(t,e,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Hs(this.initialValue),this._rgbScale=s,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const a=ti(this.$text.value);a&&this._setValueFromHexString(a)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const e=this._format.fromHexString(t);this.setValue(e)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){return this._setValueFromHexString(t),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class We extends $t{constructor(t,e,i){super(t,e,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",s=>{s.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class Js extends $t{constructor(t,e,i,s,a,l){super(t,e,i,"number"),this._initInput(),this.min(s),this.max(a);const n=l!==void 0;this.step(n?l:this._getImplicitStep(),n),this.updateDisplay()}decimals(t){return this._decimals=t,this.updateDisplay(),this}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,e=!0){return this._step=t,this._stepExplicit=e,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){let e=(t-this._min)/(this._max-this._min);e=Math.max(0,Math.min(e,1)),this.$fill.style.width=e*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?t:t.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=()=>{let y=parseFloat(this.$input.value);isNaN(y)||(this._stepExplicit&&(y=this._snap(y)),this.setValue(this._clamp(y)))},i=y=>{const w=parseFloat(this.$input.value);isNaN(w)||(this._snapClampSetValue(w+y),this.$input.value=this.getValue())},s=y=>{y.key==="Enter"&&this.$input.blur(),y.code==="ArrowUp"&&(y.preventDefault(),i(this._step*this._arrowKeyMultiplier(y))),y.code==="ArrowDown"&&(y.preventDefault(),i(this._step*this._arrowKeyMultiplier(y)*-1))},a=y=>{this._inputFocused&&(y.preventDefault(),i(this._step*this._normalizeMouseWheel(y)))};let l=!1,n,h,r,o,d;const u=5,f=y=>{n=y.clientX,h=r=y.clientY,l=!0,o=this.getValue(),d=0,window.addEventListener("mousemove",m),window.addEventListener("mouseup",g)},m=y=>{if(l){const w=y.clientX-n,b=y.clientY-h;Math.abs(b)>u?(y.preventDefault(),this.$input.blur(),l=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(w)>u&&g()}if(!l){const w=y.clientY-r;d-=w*this._step*this._arrowKeyMultiplier(y),o+d>this._max?d=this._max-o:o+d<this._min&&(d=this._min-o),this._snapClampSetValue(o+d)}r=y.clientY},g=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",g)},x=()=>{this._inputFocused=!0},p=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",e),this.$input.addEventListener("keydown",s),this.$input.addEventListener("wheel",a,{passive:!1}),this.$input.addEventListener("mousedown",f),this.$input.addEventListener("focus",x),this.$input.addEventListener("blur",p)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=(p,y,w,b,C)=>(p-y)/(w-y)*(C-b)+b,e=p=>{const y=this.$slider.getBoundingClientRect();let w=t(p,y.left,y.right,this._min,this._max);this._snapClampSetValue(w)},i=p=>{this._setDraggingStyle(!0),e(p.clientX),window.addEventListener("mousemove",s),window.addEventListener("mouseup",a)},s=p=>{e(p.clientX)},a=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",a)};let l=!1,n,h;const r=p=>{p.preventDefault(),this._setDraggingStyle(!0),e(p.touches[0].clientX),l=!1},o=p=>{p.touches.length>1||(this._hasScrollBar?(n=p.touches[0].clientX,h=p.touches[0].clientY,l=!0):r(p),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("touchend",u))},d=p=>{if(l){const y=p.touches[0].clientX-n,w=p.touches[0].clientY-h;Math.abs(y)>Math.abs(w)?r(p):(window.removeEventListener("touchmove",d),window.removeEventListener("touchend",u))}else p.preventDefault(),e(p.touches[0].clientX)},u=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",d),window.removeEventListener("touchend",u)},f=this._callOnFinishChange.bind(this),m=400;let g;const x=p=>{if(Math.abs(p.deltaX)<Math.abs(p.deltaY)&&this._hasScrollBar)return;p.preventDefault();const w=this._normalizeMouseWheel(p)*this._step;this._snapClampSetValue(this.getValue()+w),this.$input.value=this.getValue(),clearTimeout(g),g=setTimeout(f,m)};this.$slider.addEventListener("mousedown",i),this.$slider.addEventListener("touchstart",o,{passive:!1}),this.$slider.addEventListener("wheel",x,{passive:!1})}_setDraggingStyle(t,e="horizontal"){this.$slider&&this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-dragging",t),document.body.classList.toggle(`lil-gui-${e}`,t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:e,deltaY:i}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(e=0,i=-t.wheelDelta/120,i*=this._stepExplicit?1:10),e+-i}_arrowKeyMultiplier(t){let e=this._stepExplicit?1:10;return t.shiftKey?e*=10:t.altKey&&(e/=10),e}_snap(t){const e=Math.round(t/this._step)*this._step;return parseFloat(e.toPrecision(15))}_clamp(t){return t<this._min&&(t=this._min),t>this._max&&(t=this._max),t}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class Ks extends $t{constructor(t,e,i,s){super(t,e,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(s)}options(t){return this._values=Array.isArray(t)?t:Object.values(t),this._names=Array.isArray(t)?t:Object.keys(t),this.$select.replaceChildren(),this._names.forEach(e=>{const i=document.createElement("option");i.textContent=e,this.$select.appendChild(i)}),this.updateDisplay(),this}updateDisplay(){const t=this.getValue(),e=this._values.indexOf(t);return this.$select.selectedIndex=e,this.$display.textContent=e===-1?t:this._names[e],this}}class Qs extends $t{constructor(t,e,i){super(t,e,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",s=>{s.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const Zs=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: none;
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
  }
  .lil-gui button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function tn(A){const t=document.createElement("style");t.innerHTML=A;const e=document.querySelector("head link[rel=stylesheet], head style");e?document.head.insertBefore(t,e):document.head.appendChild(t)}let vi=!1;class si{constructor({parent:t,autoPlace:e=t===void 0,container:i,width:s,title:a="Controls",closeFolders:l=!1,injectStyles:n=!0,touchStyles:h=!0}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",r=>{(r.code==="Enter"||r.code==="Space")&&(r.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(a),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),h&&this.domElement.classList.add("allow-touch-styles"),!vi&&n&&(tn(Zs),vi=!0),i?i.appendChild(this.domElement):e&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),s&&this.domElement.style.setProperty("--width",s+"px"),this._closeFolders=l}add(t,e,i,s,a){if(Object(i)===i)return new Ks(this,t,e,i);const l=t[e];switch(typeof l){case"number":return new Js(this,t,e,i,s,a);case"boolean":return new Ws(this,t,e);case"string":return new Qs(this,t,e);case"function":return new We(this,t,e)}console.error(`gui.add failed
	property:`,e,`
	object:`,t,`
	value:`,l)}addColor(t,e,i=1){return new js(this,t,e,i)}addFolder(t){const e=new si({parent:this,title:t});return this.root._closeFolders&&e.close(),e}load(t,e=!0){return t.controllers&&this.controllers.forEach(i=>{i instanceof We||i._name in t.controllers&&i.load(t.controllers[i._name])}),e&&t.folders&&this.folders.forEach(i=>{i._title in t.folders&&i.load(t.folders[i._title])}),this}save(t=!0){const e={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof We)){if(i._name in e.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);e.controllers[i._name]=i.save()}}),t&&this.folders.forEach(i=>{if(i._title in e.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);e.folders[i._title]=i.save()}),e}open(t=!0){return this._setClosed(!t),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(t){this._closed!==t&&(this._closed=t,this._callOnOpenClose(this))}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(t=!0){return this._setClosed(!t),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const e=this.$children.clientHeight;this.$children.style.height=e+"px",this.domElement.classList.add("transition");const i=a=>{a.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const s=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame(()=>{this.$children.style.height=s+"px"})}),this}title(t){return this._title=t,this.$title.textContent=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),this._onChange!==void 0&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(t){this.parent&&this.parent._callOnFinishChange(t),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onOpenClose(t){return this._onOpenClose=t,this}_callOnOpenClose(t){this.parent&&this.parent._callOnOpenClose(t),this._onOpenClose!==void 0&&this._onOpenClose.call(this,t)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(t=>t.destroy())}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach(e=>{t=t.concat(e.controllersRecursive())}),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach(e=>{t=t.concat(e.foldersRecursive())}),t}}class en{constructor(){c(this,"skeleton");c(this,"state")}loadAssets(t){t.assetManager.loadTextureAtlas("model.atlas"),t.assetManager.loadJson("model.json")}initialize(t){const e=t.assetManager,i=t.assetManager.require("model.atlas"),s=new gs(i),l=new Rs(s).readSkeletonData(e.require("model.json"));if(this.skeleton=new zt(l),this.skeleton instanceof zt){this.skeleton.scaleX=.5*ee,this.skeleton.scaleY=.5*ee,this.skeleton.x=0,this.skeleton.y=-1*Math.floor(this.skeleton.data.height*.5*ee)/2,this.skeleton.setToSetupPose(),this.skeleton.update(0),this.skeleton.updateWorldTransform(_t.update);const h=nn.addFolder("spine");h.add(this.skeleton,"x",-200*ee**2,200*ee**2,1/ee),h.add({wind:0},"wind",-20,20,1).onChange(o=>{this.skeleton instanceof zt&&(this.skeleton.data.physicsConstraints.map(d=>{d.wind=o}),this.skeleton.setToSetupPose(),this.skeleton.update(0),this.skeleton.updateWorldTransform(_t.update))})}const n=new hs(l);this.state=new me(n),this.state instanceof me&&this.state.setAnimation(0,"animation",!0)}update(t,e){this.skeleton instanceof zt&&this.state instanceof me&&(this.state.update(e),this.state.apply(this.skeleton),this.skeleton.update(e),this.skeleton.updateWorldTransform(_t.update))}render(t){if(!(this.skeleton instanceof zt))return;const e=t.renderer;e.resize(pe.Expand),t.clear(.8,.8,.8,1),e.begin(),e.drawSkeleton(this.skeleton,!0),e.end()}error(t,e){console.error("Error!"),console.error(e)}}const ee=window.devicePixelRatio||1,sn=document.querySelector("#app"),we=document.createElement("canvas");we.style.position="absolute";we.style.width="100%";we.style.height="100%";sn.appendChild(we);const nn=new si;new Ns(we,{pathPrefix:"assets/spine-data/",app:new en});
